"use strict";var __extends=this&&this.__extends||function(){var r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)};return function(e,t){function i(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}}();Object.defineProperty(exports,"__esModule",{value:!0});var Subject_1=require("../Subject"),innerSubscribe_1=require("../innerSubscribe");function repeatWhen(t){return function(e){return e.lift(new RepeatWhenOperator(t))}}exports.repeatWhen=repeatWhen;var RepeatWhenOperator=function(){function e(e){this.notifier=e}return e.prototype.call=function(e,t){return t.subscribe(new RepeatWhenSubscriber(e,this.notifier,t))},e}(),RepeatWhenSubscriber=function(r){function e(e,t,i){e=r.call(this,e)||this;return e.notifier=t,e.source=i,e.sourceIsBeingSubscribedTo=!0,e}return __extends(e,r),e.prototype.notifyNext=function(){this.sourceIsBeingSubscribedTo=!0,this.source.subscribe(this)},e.prototype.notifyComplete=function(){if(!1===this.sourceIsBeingSubscribedTo)return r.prototype.complete.call(this)},e.prototype.complete=function(){if(this.sourceIsBeingSubscribedTo=!1,!this.isStopped){if(this.retries||this.subscribeToRetries(),!this.retriesSubscription||this.retriesSubscription.closed)return r.prototype.complete.call(this);this._unsubscribeAndRecycle(),this.notifications.next(void 0)}},e.prototype._unsubscribe=function(){var e=this.notifications,t=this.retriesSubscription;e&&(e.unsubscribe(),this.notifications=void 0),t&&(t.unsubscribe(),this.retriesSubscription=void 0),this.retries=void 0},e.prototype._unsubscribeAndRecycle=function(){var e=this._unsubscribe;return this._unsubscribe=null,r.prototype._unsubscribeAndRecycle.call(this),this._unsubscribe=e,this},e.prototype.subscribeToRetries=function(){this.notifications=new Subject_1.Subject;try{var e=(0,this.notifier)(this.notifications)}catch(e){return r.prototype.complete.call(this)}this.retries=e,this.retriesSubscription=innerSubscribe_1.innerSubscribe(e,new innerSubscribe_1.SimpleInnerSubscriber(this))},e}(innerSubscribe_1.SimpleOuterSubscriber);