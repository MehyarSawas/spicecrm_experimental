"use strict";var __extends=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var o in n)n.hasOwnProperty(o)&&(t[o]=n[o])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(exports,"__esModule",{value:!0});var Subscriber_1=require("../Subscriber"),Subject_1=require("../Subject");function windowCount(n,o){return void 0===o&&(o=0),function(t){return t.lift(new WindowCountOperator(n,o))}}exports.windowCount=windowCount;var WindowCountOperator=function(){function t(t,n){this.windowSize=t,this.startWindowEvery=n}return t.prototype.call=function(t,n){return n.subscribe(new WindowCountSubscriber(t,this.windowSize,this.startWindowEvery))},t}(),WindowCountSubscriber=function(i){function t(t,n,o){var e=i.call(this,t)||this;return e.destination=t,e.windowSize=n,e.startWindowEvery=o,e.windows=[new Subject_1.Subject],e.count=0,t.next(e.windows[0]),e}return __extends(t,i),t.prototype._next=function(t){for(var n=0<this.startWindowEvery?this.startWindowEvery:this.windowSize,o=this.destination,e=this.windowSize,i=this.windows,r=i.length,s=0;s<r&&!this.closed;s++)i[s].next(t);e=this.count-e+1;0<=e&&e%n==0&&!this.closed&&i.shift().complete(),++this.count%n!=0||this.closed||(n=new Subject_1.Subject,i.push(n),o.next(n))},t.prototype._error=function(t){var n=this.windows;if(n)for(;0<n.length&&!this.closed;)n.shift().error(t);this.destination.error(t)},t.prototype._complete=function(){var t=this.windows;if(t)for(;0<t.length&&!this.closed;)t.shift().complete();this.destination.complete()},t.prototype._unsubscribe=function(){this.count=0,this.windows=null},t}(Subscriber_1.Subscriber);