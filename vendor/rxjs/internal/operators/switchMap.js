"use strict";var __extends=this&&this.__extends||function(){var i=function(t,n){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var r in n)n.hasOwnProperty(r)&&(t[r]=n[r])})(t,n)};return function(t,n){function r(){this.constructor=t}i(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(exports,"__esModule",{value:!0});var map_1=require("./map"),from_1=require("../observable/from"),innerSubscribe_1=require("../innerSubscribe");function switchMap(n,e){return"function"==typeof e?function(t){return t.pipe(switchMap(function(r,i){return from_1.from(n(r,i)).pipe(map_1.map(function(t,n){return e(r,t,i,n)}))}))}:function(t){return t.lift(new SwitchMapOperator(n))}}exports.switchMap=switchMap;var SwitchMapOperator=function(){function t(t){this.project=t}return t.prototype.call=function(t,n){return n.subscribe(new SwitchMapSubscriber(t,this.project))},t}(),SwitchMapSubscriber=function(r){function t(t,n){t=r.call(this,t)||this;return t.project=n,t.index=0,t}return __extends(t,r),t.prototype._next=function(t){var n,r=this.index++;try{n=this.project(t,r)}catch(t){return void this.destination.error(t)}this._innerSub(n)},t.prototype._innerSub=function(t){var n=this.innerSubscription;n&&n.unsubscribe();var r=new innerSubscribe_1.SimpleInnerSubscriber(this),n=this.destination;n.add(r),this.innerSubscription=innerSubscribe_1.innerSubscribe(t,r),this.innerSubscription!==r&&n.add(this.innerSubscription)},t.prototype._complete=function(){var t=this.innerSubscription;t&&!t.closed||r.prototype._complete.call(this),this.unsubscribe()},t.prototype._unsubscribe=function(){this.innerSubscription=void 0},t.prototype.notifyComplete=function(){this.innerSubscription=void 0,this.isStopped&&r.prototype._complete.call(this)},t.prototype.notifyNext=function(t){this.destination.next(t)},t}(innerSubscribe_1.SimpleOuterSubscriber);