"use strict";var __extends=this&&this.__extends||function(){var o=function(n,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var e in t)t.hasOwnProperty(e)&&(n[e]=t[e])})(n,t)};return function(n,t){function e(){this.constructor=n}o(n,t),n.prototype=null===t?Object.create(t):(e.prototype=t.prototype,new e)}}();Object.defineProperty(exports,"__esModule",{value:!0});var Subscriber_1=require("../Subscriber");function refCount(){return function(n){return n.lift(new RefCountOperator(n))}}exports.refCount=refCount;var RefCountOperator=function(){function n(n){this.connectable=n}return n.prototype.call=function(n,t){var e=this.connectable;e._refCount++;n=new RefCountSubscriber(n,e),t=t.subscribe(n);return n.closed||(n.connection=e.connect()),t},n}(),RefCountSubscriber=function(e){function n(n,t){n=e.call(this,n)||this;return n.connectable=t,n}return __extends(n,e),n.prototype._unsubscribe=function(){var n,t=this.connectable;t?(this.connectable=null,(n=t._refCount)<=0?this.connection=null:(t._refCount=n-1,1<n?this.connection=null:(n=this.connection,t=t._connection,this.connection=null,!t||n&&t!==n||t.unsubscribe()))):this.connection=null},n}(Subscriber_1.Subscriber);