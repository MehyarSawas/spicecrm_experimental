"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var Observable_1=require("../Observable"),identity_1=require("../util/identity"),isScheduler_1=require("../util/isScheduler");function generate(e,i,c,r,o){var n,d;return 1==arguments.length?(d=e.initialState,i=e.condition,c=e.iterate,n=e.resultSelector||identity_1.identity,o=e.scheduler):void 0===r||isScheduler_1.isScheduler(r)?(d=e,n=identity_1.identity,o=r):(d=e,n=r),new Observable_1.Observable(function(r){var e=d;if(o)return o.schedule(dispatch,0,{subscriber:r,iterate:c,condition:i,resultSelector:n,state:e});for(;;){if(i){var t=void 0;try{t=i(e)}catch(e){return void r.error(e)}if(!t){r.complete();break}}t=void 0;try{t=n(e)}catch(e){return void r.error(e)}if(r.next(t),r.closed)break;try{e=c(e)}catch(e){return void r.error(e)}}})}function dispatch(e){var r,t=e.subscriber,i=e.condition;if(!t.closed){if(e.needIterate)try{e.state=e.iterate(e.state)}catch(e){return void t.error(e)}else e.needIterate=!0;if(i){var c=void 0;try{c=i(e.state)}catch(e){return void t.error(e)}if(!c)return void t.complete();if(t.closed)return}try{r=e.resultSelector(e.state)}catch(e){return void t.error(e)}if(!t.closed&&(t.next(r),!t.closed))return this.schedule(e)}}exports.generate=generate;