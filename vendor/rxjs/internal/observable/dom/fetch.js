"use strict";var __assign=this&&this.__assign||function(){return(__assign=Object.assign||function(r){for(var e,t=1,n=arguments.length;t<n;t++)for(var o in e=arguments[t])Object.prototype.hasOwnProperty.call(e,o)&&(r[o]=e[o]);return r}).apply(this,arguments)},__rest=this&&this.__rest||function(r,e){var t={};for(o in r)Object.prototype.hasOwnProperty.call(r,o)&&e.indexOf(o)<0&&(t[o]=r[o]);if(null!=r&&"function"==typeof Object.getOwnPropertySymbols)for(var n=0,o=Object.getOwnPropertySymbols(r);n<o.length;n++)e.indexOf(o[n])<0&&(t[o[n]]=r[o[n]]);return t};Object.defineProperty(exports,"__esModule",{value:!0});var Observable_1=require("../../Observable"),Subscription_1=require("../../Subscription"),from_1=require("../../observable/from");function fromFetch(u,r){var b=(r=void 0===r?{}:r).selector,f=__rest(r,["selector"]);return new Observable_1.Observable(function(e){var r,t,n,o=new AbortController,i=o.signal,s=!0,a=!1,c=new Subscription_1.Subscription;return c.add(function(){a=!0,s&&o.abort()}),r=f?(f.signal&&(f.signal.aborted?o.abort():((t=f.signal).addEventListener("abort",n=function(){i.aborted||o.abort()}),c.add(function(){return t.removeEventListener("abort",n)}))),__assign({},f,{signal:i})):{signal:i},fetch(u,r).then(function(r){b?c.add(from_1.from(b(r)).subscribe(function(r){return e.next(r)},function(r){s=!1,a||e.error(r)},function(){s=!1,e.complete()})):(s=!1,e.next(r),e.complete())}).catch(function(r){s=!1,a||e.error(r)}),c})}exports.fromFetch=fromFetch;