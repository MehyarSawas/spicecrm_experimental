<global-login-loading class="slds-size--1-of-1" *ngIf="!configuration.initialized"></global-login-loading>
<div *ngIf="configuration.initialized"  class="slds-grid slds-wrap slds-is-absolute slds-size--1-of-1 slds-theme--default" style="height:100vh; top: 0px;">
    <div class="slds-align--absolute-center slds-size--1-of-1 slds-large-size--1-of-2">
        <div class="slds-size--1-of-1 slds-medium-size--2-of-3 slds-p-around--medium">
            <!--div class="spiceLoginLogo"-->
            <div class="slds-align--absolute-center slds-p-vertical--medium">
                <global-login-image></global-login-image>
            </div>
            <div class="slds-box--border slds-theme--shade" *ngIf="!loginService.session.authData.sessionId && promptUser" [system-overlay-loading-spinner]="loggingIn">
                <div class="slds-p-around--medium" [system-overlay-loading-spinner]="configuration.reloading">
                    <form *ngIf="!showForgotPass" (submit)="login()">
                        <div class="slds-form-element slds-m-vertical--small">
                            <div class="slds-form-element__control slds-input-has-icon slds-input-has-icon--left">
                                <system-utility-icon [icon]="'user'" [addclasses]="'slds-input__icon slds-icon-text-default'"></system-utility-icon>
                                <input [disabled]="loggingIn" type="text" name="username" autocomplete  [(ngModel)]="username" class="slds-input slds-p-horizontal--large slds-p-vertical--small" tabindex="1" placeholder="Username" />
                            </div>
                        </div>
                        <div class="slds-form-element slds-m-vertical--small">
                            <div class="slds-form-element__control slds-input-has-icon slds-input-has-icon--left">
                                <system-utility-icon [icon]="'lock'" [addclasses]="'slds-input__icon slds-icon-text-default'"></system-utility-icon>
                                <input [disabled]="loggingIn" type="password" name="password" autocomplete  [(ngModel)]="password" class="slds-input slds-p-horizontal--large slds-p-vertical--small" tabindex="2" placeholder="Password" />
                            </div>
                        </div>
                        <div *ngIf="sites.length > 1" class="slds-form-element slds-m-vertical--small">
                            <div class="slds-form-element__control">
                                <div class="slds-select_container slds-m-vertical--xx-small">
                                    <select [disabled]="loggingIn" name="currentsite" class="slds-select slds-p-horizontal--large" [ngModel]="currentSiteId" (change)="setSite($event)">
                                        <option *ngFor="let site of sites" [value]="site.id">
                                            {{site.display}}
                                        </option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        <div *ngIf="getLanguages().length > 1" class="slds-form-element slds-m-vertical--small">
                            <div class="slds-form-element__control">
                                <div class="slds-select_container slds-m-vertical--xx-small">
                                    <select [disabled]="loggingIn" class="slds-select slds-p-horizontal--large" name="selectLang" [(ngModel)]="selectedlanguage">
                                        <option *ngFor="let lang of getLanguages()" [ngValue]="lang.language">
                                            {{lang.text}}
                                        </option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        <button [disabled]="loggingIn" type="submit" value="Submit" class="slds-button slds-button--brand slds-button_stretch" tabindex="0">Login</button>
                        <div class="slds-p-top--small">
                            <global-login-google class="slds-size--1-of-1" (token)="login($event)"></global-login-google>
                            <global-login-oauth2 class="slds-size--1-of-1" (token)="login($event)"></global-login-oauth2>
                        </div>
                    </form>
                    <div class="slds-p-vertical--x-small slds-grid slds-grid--align-spread slds-grid_vertical-align-center"
                         *ngIf="configuration.data.allowForgotPass">
                        <div class="slds-truncate slds-text-body_small" title="Forgot password">Forgot password</div>
                        <button [disabled]="loggingIn" class="slds-button" (click)="showForgotPassword()">
                            <system-button-icon *ngIf="!showForgotPass" [icon]="'chevrondown'" [size]="'xx-small'"></system-button-icon>
                            <system-button-icon *ngIf="showForgotPass" [icon]="'chevronup'" [size]="'xx-small'"></system-button-icon>
                        </button>
                    </div>
                    <global-login-forgot-password class="slds-col" *ngIf="showForgotPass" (close)="showForgotPass = !$event"></global-login-forgot-password>
                </div>
            </div>
            <!-- the renew dialog ... needs to be added here in this way as we do not have the modal service and repository yet -->
            <global-login-change-password class="slds-is-absolute" *ngIf="renewpassword" (closeRenewDialog)="handleRenewDialogClose($event)" [username]="username" [password]="password"></global-login-change-password>
            <ng-container *ngIf="loginService.session.authData.sessionId">
                <system-loader-progress></system-loader-progress>
            </ng-container>
        </div>
        <div class="slds-is-absolute" style="bottom: 10px;">
            <global-copyright></global-copyright>
        </div>
    </div>
    <div *ngIf="promptUser && showSidebar" class="slds-size--1-of-1 slds-large-size--1-of-2 slds-height_full" [class.slds-scrollable--y]="!showExternalSidebar">
        <iframe *ngIf="showExternalSidebar" [src]="externalSidebarUrl" style="border:none;width:100%;height:100%"></iframe>
        <ng-container *ngIf="showNewsfeed">
            <global-newsfeed></global-newsfeed>
        </ng-container>
    </div>
</div>
