/*!
 * 
 *                     aacService
 *
 *                     release: 2022.01.001
 *
 *                     date: 2022-08-25 13:14:25
 *
 *                     build: 2022.01.001.1661426065713
 *
 */
"use strict";(self.webpackChunkcore=self.webpackChunkcore||[]).push([["src_modules_acl_moduleacl_ts"],{5612:(e,t,s)=>{s.r(t),s.d(t,{ModuleACL:()=>Yt});var l=s(9808),i=s(2382),o=s(1549),n=s(1706),c=s(4518),d=s(9769),a=s(6472),r=s(4893),u=s(4505),p=s(6163),f=s(5329),g=s(4561),b=s(3333),m=s(3463);let h=(()=>{class ACLManagerHeader{constructor(e){this.language=e,this.displaylabel=""}}return ACLManagerHeader.ɵfac=function(e){return new(e||ACLManagerHeader)(r.Y36(f.d))},ACLManagerHeader.ɵcmp=r.Xpm({type:ACLManagerHeader,selectors:[["acl-manager-header"]],inputs:{displaylabel:"displaylabel"},decls:12,vars:1,consts:[[1,"slds-p-around--medium","slds-theme--default","slds-border--bottom"],[1,"slds-grid"],[1,"slds-col","slds-has-flexi-truncate"],[1,"slds-media","slds-no-space","slds-grow"],[1,"slds-media__figure"],["module","SpiceACLObjects"],[1,"slds-media__body"],[1,"slds-text-title_caps","slds-line-height_reset"],[1,"slds-page-header__title","slds-p-right_x-small"],[1,"slds-truncate"],[3,"label"]],template:function(e,t){1&e&&(r.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4),r._UZ(5,"system-icon",5),r.qZA(),r.TgZ(6,"div",6)(7,"p",7),r._UZ(8,"system-label-modulename",5),r.qZA(),r.TgZ(9,"h1",8)(10,"div",9),r._UZ(11,"system-label",10),r.qZA()()()()()()()),2&e&&(r.xp6(11),r.Q6J("label",t.displaylabel))},directives:[g.f,b.M,m._],encapsulation:2}),ACLManagerHeader})();var y=s(3194),A=s(4044),Z=s(3398),_=s(1058),v=s(4664),T=s(2145),x=s(8859);function C(e,t){1&e&&(r.TgZ(0,"div",8),r._UZ(1,"system-spinner"),r.qZA())}function L(e,t){1&e&&r._UZ(0,"system-utility-icon",21)}function M(e,t){1&e&&r._UZ(0,"system-utility-icon",22)}const O=function(e){return{"slds-theme--shade":e}};function j(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"tr",16),r.NdJ("click",(function(){const t=r.CHM(e).$implicit;return r.oxw(2).selectType(t)})),r.TgZ(1,"td")(2,"div",17)(3,"system-link"),r._uU(4),r.qZA()()(),r.TgZ(5,"td",18),r.YNc(6,L,1,0,"system-utility-icon",19),r.YNc(7,M,1,0,"system-utility-icon",20),r.qZA()()}if(2&e){const e=t.$implicit,s=r.oxw(2);r.Q6J("ngClass",r.VKq(4,O,e.id==s.activeTypeId)),r.xp6(4),r.Oqu(e.module),r.xp6(2),r.Q6J("ngIf",e.usagecount>0),r.xp6(1),r.Q6J("ngIf",0==e.usagecount)}}function q(e,t){if(1&e&&(r.TgZ(0,"table",9)(1,"thead")(2,"tr",10)(3,"th",11)(4,"div",12),r._UZ(5,"system-label",13),r.qZA()(),r._UZ(6,"th",14),r.qZA()(),r.TgZ(7,"tbody"),r.YNc(8,j,8,6,"tr",15),r.qZA()()),2&e){const e=r.oxw();r.xp6(8),r.Q6J("ngForOf",e.acltypeslist)}}let J=(()=>{class ACLTypesManagerTypes{constructor(e,t,s,l){this.backend=e,this.modal=t,this.language=s,this.modelutilities=l,this.loading=!0,this.acltypes=[],this.activeTypeId="",this.typeselected=new r.vpe,this.backend.getRequest("module/SpiceACLObjects/modules").subscribe((e=>{this.acltypes=e,this.acltypes.sort(((e,t)=>e.module>t.module?1:-1)),this.loading=!1}))}get acltypeslist(){return this.filter?this.acltypes.filter((e=>e.id==this.activeTypeId||e.module.toLowerCase().indexOf(this.filter.toLowerCase())>=0)):this.acltypes}selectType(e){this.activeTypeId=e.id,this.typeselected.emit(e)}}return ACLTypesManagerTypes.ɵfac=function(e){return new(e||ACLTypesManagerTypes)(r.Y36(u.y),r.Y36(A.o),r.Y36(f.d),r.Y36(p.A))},ACLTypesManagerTypes.ɵcmp=r.Xpm({type:ACLTypesManagerTypes,selectors:[["acltypes-manager-types"]],outputs:{typeselected:"typeselected"},decls:9,vars:3,consts:[[2,"height","100%"],[1,"slds-grid","slds-grid--vertical-align-center","slds-p-around--x-small","slds-border--bottom"],[1,"slds-text-heading--small"],["label","LBL_MODULES"],["system-placeholder","LBL_FILTER",1,"slds-col--bump-left","slds-size--1-of-2","slds-input",3,"ngModel","ngModelChange"],["system-to-bottom","",1,"slds-scrollable"],["class","slds-p-around--medium slds-align--absolute-center",4,"ngIf","ngIfElse"],["typesdisplay",""],[1,"slds-p-around--medium","slds-align--absolute-center"],[1,"slds-table","slds-table--header-fixed","slds-table_bordered","slds-table_cell-buffer"],[1,"slds-text-title_caps"],["scope","col"],[1,"slds-truncate","slds-th__action"],["label","LBL_MODULE"],["scope","col",2,"width","3rem"],[3,"ngClass","click",4,"ngFor","ngForOf"],[3,"ngClass","click"],[1,"slds-truncate"],[2,"width","3rem"],["icon","lock","size","x-small","addclasses","slds-icon slds-icon-text-default",4,"ngIf"],["icon","unlock","size","x-small","addclasses","slds-icon slds-icon-text-light",4,"ngIf"],["icon","lock","size","x-small","addclasses","slds-icon slds-icon-text-default"],["icon","unlock","size","x-small","addclasses","slds-icon slds-icon-text-light"]],template:function(e,t){if(1&e&&(r.TgZ(0,"div",0)(1,"div",1)(2,"h2",2),r._UZ(3,"system-label",3),r.qZA(),r.TgZ(4,"input",4),r.NdJ("ngModelChange",(function(e){return t.filter=e})),r.qZA()(),r.TgZ(5,"div",5),r.YNc(6,C,2,0,"div",6),r.YNc(7,q,9,1,"ng-template",null,7,r.W1O),r.qZA()()),2&e){const e=r.MAs(8);r.xp6(4),r.Q6J("ngModel",t.filter),r.xp6(2),r.Q6J("ngIf",t.loading)("ngIfElse",e)}},directives:[m._,i.Fj,Z.A,i.JJ,i.On,_.H,l.O5,v.W,l.sg,l.mk,T.A,x.r],encapsulation:2}),ACLTypesManagerTypes})();function k(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"tr")(1,"td")(2,"div",8),r._uU(3),r.qZA()(),r.TgZ(4,"td",12)(5,"system-utility-icon",13),r.NdJ("click",(function(){const t=r.CHM(e).$implicit;return r.oxw().deleteField(t.id)})),r.qZA()()()}if(2&e){const e=t.$implicit;r.xp6(3),r.Oqu(e.name)}}let F=(()=>{class ACLTypesManagerTypesFields{constructor(e,t,s,l){this.backend=e,this.modal=t,this.language=s,this.modelutilities=l,this.authtypefields=[],this.authtypemodule="",this.addfields=new r.vpe,this.deletefield=new r.vpe}addField(){for(let e of this.authtypefields)e.hide=!0;this.modal.openModal("ACLTypesManagerTypesAddFields").subscribe((e=>{e.instance.module=this.authtypemodule,e.instance.currentfields=this.authtypefields,e.instance.addfields.subscribe((e=>{if(e){let t=[];for(let s of e){let e=!1;for(let t in this.authtypefields)this.authtypefields[t].name==s&&(e=!0);e||t.push(s)}this.addfields.emit(t)}}))}))}deleteField(e){this.modal.confirm(this.language.getLabel("MSG_DELETE_ACL_FIELD","","long"),this.language.getLabel("MSG_DELETE_ACL_FIELD","","default")).subscribe((t=>{t&&this.deletefield.emit(e)}))}}return ACLTypesManagerTypesFields.ɵfac=function(e){return new(e||ACLTypesManagerTypesFields)(r.Y36(u.y),r.Y36(A.o),r.Y36(f.d),r.Y36(p.A))},ACLTypesManagerTypesFields.ɵcmp=r.Xpm({type:ACLTypesManagerTypesFields,selectors:[["acltypes-manager-types-fields"]],inputs:{authtypefields:"authtypefields",authtypemodule:"authtypemodule"},outputs:{addfields:"addfields",deletefield:"deletefield"},decls:14,vars:1,consts:[[1,"slds-grid","slds-grid--vertical-align-center","slds-p-around--x-small"],[1,"slds-text-heading--small"],["label","LBL_FIELDS"],[1,"slds-col--bump-left","slds-button","slds-button--brand",3,"click"],["label","LBL_ADD"],[1,"slds-table","slds-table_bordered","slds-table_cell-buffer"],[1,"slds-text-title_caps"],["scope","col"],[1,"slds-truncate"],["label","LBL_FIELD"],["scope","col",2,"width","3rem"],[4,"ngFor","ngForOf"],[2,"width","3rem"],["icon","delete","size","x-small","addclasses","slds-icon slds-icon-text-default",3,"click"]],template:function(e,t){1&e&&(r.TgZ(0,"div",0)(1,"h2",1),r._UZ(2,"system-label",2),r.qZA(),r.TgZ(3,"button",3),r.NdJ("click",(function(){return t.addField()})),r._UZ(4,"system-label",4),r.qZA()(),r.TgZ(5,"table",5)(6,"thead")(7,"tr",6)(8,"th",7)(9,"div",8),r._UZ(10,"system-label",9),r.qZA()(),r._UZ(11,"th",10),r.qZA()(),r.TgZ(12,"tbody"),r.YNc(13,k,6,1,"tr",11),r.qZA()()),2&e&&(r.xp6(13),r.Q6J("ngForOf",t.authtypefields))},directives:[m._,l.sg,x.r],encapsulation:2}),ACLTypesManagerTypesFields})();function U(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"tr")(1,"td")(2,"div",14),r._uU(3),r.qZA()(),r.TgZ(4,"td")(5,"div",14),r._uU(6),r.qZA()(),r.TgZ(7,"td",15)(8,"system-utility-icon",16),r.NdJ("click",(function(){const t=r.CHM(e).$implicit;return r.oxw().deleteAction(t.id)})),r.qZA()()()}if(2&e){const e=t.$implicit;r.xp6(3),r.Oqu(e.action),r.xp6(3),r.Oqu(e.description)}}let w=(()=>{class ACLTypesManagerTypesActions{constructor(e,t,s,l){this.backend=e,this.modal=t,this.language=s,this.modelutilities=l,this.authtypeactions=[],this.addaction=new r.vpe,this.deleteaction=new r.vpe}addAction(){this.modal.openModal("ACLTypesManagerTypesAddAction",!0).subscribe((e=>{e.instance.currentactions=this.authtypeactions,e.instance.addaction.subscribe((e=>{this.addaction.emit(e)}))}))}deleteAction(e){this.modal.confirm("MSG_DELETE_ACL_ACTION","MSG_DELETE_ACL_ACTION").subscribe((t=>{t&&this.deleteaction.emit(e)}))}}return ACLTypesManagerTypesActions.ɵfac=function(e){return new(e||ACLTypesManagerTypesActions)(r.Y36(u.y),r.Y36(A.o),r.Y36(f.d),r.Y36(p.A))},ACLTypesManagerTypesActions.ɵcmp=r.Xpm({type:ACLTypesManagerTypesActions,selectors:[["acltypes-manager-types-actions"]],inputs:{authtypeactions:"authtypeactions"},outputs:{addaction:"addaction",deleteaction:"deleteaction"},decls:18,vars:1,consts:[[1,"slds-grid","slds-grid--vertical-align-center","slds-p-around--x-small","slds-border--top","slds-border--bottom"],[1,"slds-text-heading--small"],["label","LBL_ACTIONS"],[1,"slds-col--bump-left","slds-button","slds-button--brand",3,"click"],["label","LBL_ADD"],["system-to-bottom",""],[1,"slds-table","slds-table--header-fixed","slds-table_bordered","slds-table_cell-buffer"],[1,"slds-text-title_caps"],["scope","col"],[1,"slds-truncate","slds-th__action"],["label","LBL_ACTION"],["label","DESCRIPTION"],["scope","col",2,"width","3rem"],[4,"ngFor","ngForOf"],[1,"slds-truncate"],[2,"width","3rem"],["icon","delete","size","x-small","addclasses","slds-icon slds-icon-text-default",3,"click"]],template:function(e,t){1&e&&(r.TgZ(0,"div",0)(1,"h2",1),r._UZ(2,"system-label",2),r.qZA(),r.TgZ(3,"button",3),r.NdJ("click",(function(){return t.addAction()})),r._UZ(4,"system-label",4),r.qZA()(),r.TgZ(5,"div",5)(6,"table",6)(7,"thead")(8,"tr",7)(9,"th",8)(10,"div",9),r._UZ(11,"system-label",10),r.qZA()(),r.TgZ(12,"th",8)(13,"div",9),r._UZ(14,"system-label",11),r.qZA()(),r._UZ(15,"th",12),r.qZA()(),r.TgZ(16,"tbody"),r.YNc(17,U,9,2,"tr",13),r.qZA()()()),2&e&&(r.xp6(17),r.Q6J("ngForOf",t.authtypeactions))},directives:[m._,_.H,l.sg,x.r],encapsulation:2}),ACLTypesManagerTypesActions})();const I=["managercontent"];let N=(()=>{class ACLTypesManager{constructor(e,t,s){this.backend=e,this.modelutilities=t,this.elementRef=s,this.activeType={authtypeid:"",authtypemodule:"",authtypefields:{},authtypeactions:[]},this.activeModule=""}setType(e){this.activeType.authtypeid=e.id,this.activeType.authtypemodule=e.module,this.backend.getRequest("module/SpiceACLObjects/modules/"+e.id).subscribe((e=>{this.activeType.authtypefields=e.authtypefields?e.authtypefields:[],this.activeType.authtypeactions=e.authtypeactions,this.activeType.authtypeactions.sort(((e,t)=>e.action.localeCompare(t.action))),this.sortType()}))}addFields(e){for(let t of e)this.backend.postRequest("module/SpiceACLObjects/modules/"+this.activeType.authtypeid+"/fields/"+t).subscribe((e=>{this.activeType.authtypefields.push(e),this.sortType()}))}deleteField(e){this.backend.deleteRequest("module/SpiceACLObjects/modules/"+this.activeType.authtypeid+"/fields/"+e).subscribe((t=>{this.activeType.authtypefields.some(((t,s)=>{if(t.id==e)return this.activeType.authtypefields.splice(s,1),!0}))}))}addAction(e){this.backend.postRequest("module/SpiceACLObjects/modules/"+this.activeType.authtypeid+"/actions/"+e.action,{},{description:e.description}).subscribe((e=>{this.activeType.authtypeactions.push(e),this.sortType()}))}deleteAction(e){this.backend.deleteRequest("module/SpiceACLObjects/modules/"+this.activeType.authtypeid+"/actions/"+e).subscribe((t=>{this.activeType.authtypeactions.some(((t,s)=>{if(t.id==e)return this.activeType.authtypeactions.splice(s,1),!0}))}))}sortType(){this.activeType.authtypefields.sort(((e,t)=>e.name>t.name)),this.activeType.authtypeactions.sort(((e,t)=>e.action>t.action?1:-1))}}return ACLTypesManager.ɵfac=function(e){return new(e||ACLTypesManager)(r.Y36(u.y),r.Y36(p.A),r.Y36(r.SBq))},ACLTypesManager.ɵcmp=r.Xpm({type:ACLTypesManager,selectors:[["acl-types-manager"]],viewQuery:function(e,t){if(1&e&&r.Gf(I,7,r.s_b),2&e){let e;r.iGM(e=r.CRH())&&(t.elementmanagercontent=e.first)}},decls:11,vars:3,consts:[[2,"height","100%"],["displaylabel","LBL_SPICEACLTYPES"],["system-to-bottom-noscroll","",1,"slds-grid"],["managercontent",""],[1,"slds-size--1-of-2","slds-border--right",3,"typeselected"],["system-to-bottom-noscroll","",1,"slds-size--1-of-2"],[1,"slds-scrollable--y",2,"height","50%"],[3,"authtypemodule","authtypefields","addfields","deletefield"],[2,"height","50%"],[3,"authtypeactions","addaction","deleteaction"]],template:function(e,t){1&e&&(r.TgZ(0,"div",0)(1,"div"),r._UZ(2,"acl-manager-header",1),r.qZA(),r.TgZ(3,"div",2,3)(5,"acltypes-manager-types",4),r.NdJ("typeselected",(function(e){return t.setType(e)})),r.qZA(),r.TgZ(6,"div",5)(7,"div",6)(8,"acltypes-manager-types-fields",7),r.NdJ("addfields",(function(e){return t.addFields(e)}))("deletefield",(function(e){return t.deleteField(e)})),r.qZA()(),r.TgZ(9,"div",8)(10,"acltypes-manager-types-actions",9),r.NdJ("addaction",(function(e){return t.addAction(e)}))("deleteaction",(function(e){return t.deleteAction(e)})),r.qZA()()()()()),2&e&&(r.xp6(8),r.Q6J("authtypemodule",t.activeType.authtypemodule)("authtypefields",t.activeType.authtypefields),r.xp6(2),r.Q6J("authtypeactions",t.activeType.authtypeactions))},directives:[h,y.t,J,F,w],encapsulation:2}),ACLTypesManager})();var E=s(4154),Y=s(9621),P=s(1916),Q=s(3499),S=s(5767);function B(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"div",4),r.NdJ("click",(function(t){r.CHM(e);const s=r.oxw().$implicit;return r.oxw().setFieldValue(s,t)})),r._UZ(1,"input",5),r.TgZ(2,"label",6),r._UZ(3,"span",7),r.TgZ(4,"span",8),r._uU(5),r.qZA()()()}if(2&e){const e=r.oxw().$implicit,t=r.oxw();r.xp6(1),r.Q6J("id","id"+e)("checked",t.getFieldValue(e)),r.xp6(1),r.uIk("for","id"+e),r.xp6(3),r.AsE("",t.getFieldDisplayName(e)," / ",e,"")}}function D(e,t){if(1&e&&(r.TgZ(0,"div",3),r.YNc(1,B,6,5,"div",15),r.qZA()),2&e){const e=t.$implicit,s=r.oxw();r.xp6(1),r.Q6J("ngIf",!s.getFieldDisplay(e))}}let R=(()=>{class ACLTypesManagerTypesAddFields{constructor(e,t,s,l){this.backend=e,this.metadata=t,this.language=s,this.modelutilities=l,this.module="",this.self={},this.currentfields=[],this.selectedfields=[],this.fields=[],this.addfields=new r.vpe,this.showAll=!1,this.selectAllChecked=!1}ngOnInit(){let e=this.metadata.getModuleFields(this.module);this.selectedfields=[];for(let t in e)(this.showAll||this.allowField(e[t]))&&this.fields.push(t);for(let e of this.currentfields)this.selectedfields.push(e.name);this.fields.sort()}allowField(e){return"non-db"!=e.source&&"link"!=e.type&&"relate"!=e.type}getFieldDisplayName(e){return this.language.getFieldDisplayName(this.module,e)}close(){this.self.destroy()}add(){this.addfields.emit(this.selectedfields),this.close()}getFieldDisplay(e){for(let t of this.currentfields)if(t.name==e&&t.hide)return!0;return!1}getFieldValue(e){for(let t of this.selectedfields)if(t==e)return!0;return!1}setFieldValue(e,t){t.preventDefault();let s=!1;for(let t in this.selectedfields)this.selectedfields[t]==e&&(this.selectedfields.splice(+t,1),s=!0);s||this.selectedfields.push(e)}toggleSelectAll(e){if(e.preventDefault(),this.selectAllChecked)this.selectAllChecked=!1,this.selectedfields=[];else{for(let e of this.fields)this.selectedfields.push(e);this.selectAllChecked=!0}}}return ACLTypesManagerTypesAddFields.ɵfac=function(e){return new(e||ACLTypesManagerTypesAddFields)(r.Y36(u.y),r.Y36(E.Pu),r.Y36(f.d),r.Y36(p.A))},ACLTypesManagerTypesAddFields.ɵcmp=r.Xpm({type:ACLTypesManagerTypesAddFields,selectors:[["acltypes-manager-types-add-fields"]],inputs:{module:"module"},decls:19,vars:5,consts:[[3,"close"],["label","LBL_ADD_FIELD"],[1,"slds-form-element"],[1,"slds-form-element__control"],[1,"slds-checkbox",3,"click"],["type","checkbox",3,"id","checked"],[1,"slds-checkbox__label"],[1,"slds-checkbox_faux"],[1,"slds-form-element__label"],["label","LBL_SELECT_ALL"],["class","slds-form-element__control",4,"ngFor","ngForOf"],[1,"slds-button","slds-button--neutral",3,"click"],["label","LBL_CANCEL"],[1,"slds-button","slds-button--brand",3,"disabled","click"],["label","LBL_ADD"],["class","slds-checkbox",3,"click",4,"ngIf"]],template:function(e,t){1&e&&(r.TgZ(0,"system-modal")(1,"system-modal-header",0),r.NdJ("close",(function(){return t.close()})),r._UZ(2,"system-label",1),r.qZA(),r.TgZ(3,"system-modal-content")(4,"fieldset",2)(5,"div",3)(6,"div",4),r.NdJ("click",(function(e){return t.toggleSelectAll(e)})),r._UZ(7,"input",5),r.TgZ(8,"label",6),r._UZ(9,"span",7),r.TgZ(10,"span",8),r._UZ(11,"system-label",9),r.qZA()()()()(),r.TgZ(12,"fieldset",2),r.YNc(13,D,2,1,"div",10),r.qZA()(),r.TgZ(14,"system-modal-footer")(15,"button",11),r.NdJ("click",(function(){return t.close()})),r._UZ(16,"system-label",12),r.qZA(),r.TgZ(17,"button",13),r.NdJ("click",(function(){return t.add()})),r._UZ(18,"system-label",14),r.qZA()()()),2&e&&(r.xp6(7),r.Q6J("id","select_all")("checked",t.selectAllChecked),r.xp6(1),r.uIk("for","select_all"),r.xp6(5),r.Q6J("ngForOf",t.fields),r.xp6(4),r.Q6J("disabled",t.selectedfields.length<1))},directives:[Y.j,P.y,m._,Q.x,l.sg,l.O5,S.p],encapsulation:2}),ACLTypesManagerTypesAddFields})(),H=(()=>{class ACLTypesManagerTypesAddAction{constructor(e,t,s,l){this.backend=e,this.metadata=t,this.language=s,this.modelutilities=l,this.self={},this.currentactions=[],this._currentActions=[],this.action="",this.description="",this.addaction=new r.vpe}ngOnInit(){for(let e of this.currentactions)this._currentActions.push(e.action)}close(){this.self.destroy()}get adddisabled(){return""==this.action||this._currentActions.indexOf(this.action)>=0}add(){this.addaction.emit({action:this.action,description:this.description}),this.close()}}return ACLTypesManagerTypesAddAction.ɵfac=function(e){return new(e||ACLTypesManagerTypesAddAction)(r.Y36(u.y),r.Y36(E.Pu),r.Y36(f.d),r.Y36(p.A))},ACLTypesManagerTypesAddAction.ɵcmp=r.Xpm({type:ACLTypesManagerTypesAddAction,selectors:[["acltypes-manager-types-add-action"]],decls:19,vars:3,consts:[[3,"close"],["label","LBL_ADD_ACTION"],[1,"slds-form-element"],[1,"slds-form-element__label"],["label","LBL_ACTION"],[1,"slds-form-element__control"],["type","text","maxlength","50",1,"slds-input",3,"ngModel","ngModelChange"],["label","LBL_DESCRIPTION"],["type","text","maxlength","255",1,"slds-input",3,"ngModel","ngModelChange"],[1,"slds-button","slds-button--neutral",3,"click"],["label","LBL_CANCEL"],[1,"slds-button","slds-button--brand",3,"disabled","click"],["label","LBL_ADD"]],template:function(e,t){1&e&&(r.TgZ(0,"system-modal")(1,"system-modal-header",0),r.NdJ("close",(function(){return t.close()})),r._UZ(2,"system-label",1),r.qZA(),r.TgZ(3,"system-modal-content")(4,"div",2)(5,"label",3),r._UZ(6,"system-label",4),r.qZA(),r.TgZ(7,"div",5)(8,"input",6),r.NdJ("ngModelChange",(function(e){return t.action=e})),r.qZA()()(),r.TgZ(9,"div",2)(10,"label",3),r._UZ(11,"system-label",7),r.qZA(),r.TgZ(12,"div",5)(13,"input",8),r.NdJ("ngModelChange",(function(e){return t.description=e})),r.qZA()()()(),r.TgZ(14,"system-modal-footer")(15,"button",9),r.NdJ("click",(function(){return t.close()})),r._UZ(16,"system-label",10),r.qZA(),r.TgZ(17,"button",11),r.NdJ("click",(function(){return t.add()})),r._UZ(18,"system-label",12),r.qZA()()()),2&e&&(r.xp6(8),r.Q6J("ngModel",t.action),r.xp6(5),r.Q6J("ngModel",t.description),r.xp6(4),r.Q6J("disabled",t.adddisabled))},directives:[Y.j,P.y,m._,Q.x,i.Fj,i.nD,i.JJ,i.On,S.p],encapsulation:2}),ACLTypesManagerTypesAddAction})();var V=s(2656),$=s(34);const z=["header"];function W(e,t){if(1&e&&(r.ynx(0),r.TgZ(1,"option",15),r._uU(2),r.qZA(),r.BQk()),2&e){const e=t.$implicit;r.xp6(1),r.Q6J("value",e.id),r.xp6(1),r.Oqu(e.module)}}function X(e,t){1&e&&(r.TgZ(0,"div",16),r._UZ(1,"system-spinner"),r.qZA())}function G(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"system-custom-icon",33),r.NdJ("click",(function(){r.CHM(e);const t=r.oxw().$implicit;return r.oxw(2).deactivateObject(t.id)})),r.qZA()}}function K(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"system-custom-icon",34),r.NdJ("click",(function(){r.CHM(e);const t=r.oxw().$implicit;return r.oxw(2).activateObject(t.id)})),r.qZA()}}function ee(e,t){1&e&&r._UZ(0,"system-custom-icon",35)}const te=function(e){return{"slds-theme--shade":e}},se=function(e){return{"slds-hidden":e}};function le(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"tr",26),r.NdJ("click",(function(){const t=r.CHM(e).$implicit;return r.oxw(2).selectObject(t)})),r.TgZ(1,"td")(2,"div",20),r._uU(3),r.qZA()(),r.TgZ(4,"td")(5,"div",20),r._uU(6),r.qZA()(),r.TgZ(7,"td")(8,"div",20),r._uU(9),r.qZA()(),r.TgZ(10,"td",27)(11,"div",28),r.YNc(12,G,1,0,"system-custom-icon",29),r.YNc(13,K,1,0,"system-custom-icon",30),r._UZ(14,"system-custom-icon",31),r.YNc(15,ee,1,0,"system-custom-icon",32),r.qZA()()()}if(2&e){const e=t.$implicit,s=r.oxw(2);r.Q6J("ngClass",r.VKq(8,te,e.id==s.activeObjectId)),r.xp6(3),r.Oqu(e.name),r.xp6(3),r.Oqu(s.getType(e.spiceaclobjecttype)),r.xp6(3),r.Oqu(e.activity),r.xp6(3),r.Q6J("ngIf","r"==e.status),r.xp6(1),r.Q6J("ngIf","r"!=e.status),r.xp6(1),r.Q6J("ngClass",r.VKq(10,se,!e.description)),r.xp6(1),r.Q6J("ngIf",e.customSQL)}}function ie(e,t){if(1&e&&(r.TgZ(0,"table",17)(1,"thead")(2,"tr",18)(3,"th",19)(4,"div",20),r._UZ(5,"system-label",21),r.qZA()(),r.TgZ(6,"th",19)(7,"div",20),r._UZ(8,"system-label",22),r.qZA()(),r.TgZ(9,"th",19)(10,"div",20),r._UZ(11,"system-label",23),r.qZA()(),r._UZ(12,"th",24),r.qZA()(),r.TgZ(13,"tbody"),r.YNc(14,le,16,12,"tr",25),r.qZA()()),2&e){const e=r.oxw();r.xp6(14),r.Q6J("ngForOf",e.aclobjects)}}let oe=(()=>{class ACLObjectsManagerObjects{constructor(e,t,s){this.backend=e,this.modal=t,this.language=s,this.loading=!1,this.acltypes=[],this.activeTypeId="",this.aclobjects=[],this.activeObjectId="",this.searchterm="",this.objectselected=new r.vpe,this.typeselected=new r.vpe,this.backend.getRequest("module/SpiceACLObjects/modules").subscribe((e=>{this.acltypes=e,this.acltypes.sort(((e,t)=>e.module>t.module?1:-1))}))}keyUp(e){if("Enter"===e.key)this.getObjects()}getObjects(){this.loading=!0,this.aclobjects=[];let e={moduleid:this.activeTypeId,searchterm:this.searchterm};this.backend.getRequest("module/SpiceACLObjects",e).subscribe((e=>{this.aclobjects=e,this.aclobjects.sort(((e,t)=>e.name.localeCompare(t.name))),this.loading=!1}))}get contentStyle(){return{height:"calc(100% - "+this.header.element.nativeElement.getBoundingClientRect().height+"px)"}}getType(e){return this.language.getFieldDisplayOptionValue("SpiceACLObjects","spiceaclobjecttype",e)}selectType(e){this.getObjects(),this.activeObjectId="",this.objectselected.emit(this.activeObjectId),this.typeselected.emit(this.activeTypeId)}addObject(){this.modal.openModal("ACLObjectsManagerAddObjectModal").subscribe((e=>{e.instance.sysmodule_id=this.activeTypeId,e.instance.newObjectData.subscribe((e=>{e&&(this.aclobjects.push(e),this.selectObject(e))}))}))}addDefaultObjects(){if(0==this.aclobjects.length&&this.activeTypeId){this.loading=!0;let e={moduleid:this.activeTypeId,modulename:this.acltypes.find((e=>e.id==this.activeTypeId)).module};this.backend.postRequest("module/SpiceACLObjects/defaultobjects",{},e).subscribe((e=>{this.getObjects(),this.loading=!1}))}}selectObject(e){this.activeObjectId=e.id,this.objectselected.emit(this.activeObjectId)}activateObject(e){this.backend.postRequest("module/SpiceACLObjects/"+e+"/activation").subscribe((t=>{this.aclobjects.some((t=>{if(t.id==e)return t.status="r",!0}))}))}deactivateObject(e){this.backend.deleteRequest("module/SpiceACLObjects/"+e+"/activation").subscribe((t=>{this.aclobjects.some((t=>{if(t.id==e)return t.status="d",!0}))}))}}return ACLObjectsManagerObjects.ɵfac=function(e){return new(e||ACLObjectsManagerObjects)(r.Y36(u.y),r.Y36(A.o),r.Y36(f.d))},ACLObjectsManagerObjects.ɵcmp=r.Xpm({type:ACLObjectsManagerObjects,selectors:[["aclobjects-manager-objects"]],viewQuery:function(e,t){if(1&e&&r.Gf(z,7,r.s_b),2&e){let e;r.iGM(e=r.CRH())&&(t.header=e.first)}},outputs:{objectselected:"objectselected",typeselected:"typeselected"},decls:18,vars:10,consts:[[2,"height","100%"],[1,"slds-grid","slds-grid--vertical-align-center","slds-p-around--x-small"],["header",""],[1,"slds-form-element__control","slds-size--1-of-3","slds-p-right--xx-small"],[1,"slds-select_container"],[1,"slds-select",3,"ngModel","disabled","ngModelChange","change"],[4,"ngFor","ngForOf"],["type","text",1,"slds-input",3,"disabled","ngModel","ngModelChange","keyup"],[1,"slds-p-left--xx-small"],[1,"slds-button","slds-button--icon-border",3,"disabled","click"],["icon","new"],["icon","insert_template"],[1,"slds-scrollable",3,"ngStyle"],["class","slds-p-around--medium slds-align--absolute-center",4,"ngIf","ngIfElse"],["typesdisplay",""],[3,"value"],[1,"slds-p-around--medium","slds-align--absolute-center"],[1,"slds-table","slds-table_bordered","slds-table_cell-buffer"],[1,"slds-text-title_caps"],["scope","col"],[1,"slds-truncate"],["label","LBL_NAME"],["label","LBL_TYPE"],["label","LBL_ACTIVITIES"],["scope","col",2,"width","3rem"],[3,"ngClass","click",4,"ngFor","ngForOf"],[3,"ngClass","click"],[2,"width","3rem"],[1,"slds-grid"],["icon","light-bulb-on","size","x-small","addclasses","slds-icon slds-icon-text-default",3,"click",4,"ngIf"],["icon","light-bulb-off","size","x-small","addclasses","slds-icon slds-icon-text-light",3,"click",4,"ngIf"],["icon","info","size","x-small","addclasses","slds-icon slds-icon-text-default",3,"ngClass"],["icon","sql","size","x-small","addclasses","slds-p-left--xx-small slds-icon slds-icon-text-default",4,"ngIf"],["icon","light-bulb-on","size","x-small","addclasses","slds-icon slds-icon-text-default",3,"click"],["icon","light-bulb-off","size","x-small","addclasses","slds-icon slds-icon-text-light",3,"click"],["icon","sql","size","x-small","addclasses","slds-p-left--xx-small slds-icon slds-icon-text-default"]],template:function(e,t){if(1&e&&(r.TgZ(0,"div",0)(1,"div",1,2)(3,"div",3)(4,"div",4)(5,"select",5),r.NdJ("ngModelChange",(function(e){return t.activeTypeId=e}))("change",(function(e){return t.selectType(e)})),r.YNc(6,W,3,2,"ng-container",6),r.qZA()()(),r.TgZ(7,"input",7),r.NdJ("ngModelChange",(function(e){return t.searchterm=e}))("keyup",(function(e){return t.keyUp(e)})),r.qZA(),r.TgZ(8,"div",8)(9,"button",9),r.NdJ("click",(function(){return t.addObject()})),r._UZ(10,"system-button-icon",10),r.qZA()(),r.TgZ(11,"div",8)(12,"button",9),r.NdJ("click",(function(){return t.addDefaultObjects()})),r._UZ(13,"system-button-icon",11),r.qZA()()(),r.TgZ(14,"div",12),r.YNc(15,X,2,0,"div",13),r.YNc(16,ie,15,1,"ng-template",null,14,r.W1O),r.qZA()()),2&e){const e=r.MAs(17);r.xp6(5),r.Q6J("ngModel",t.activeTypeId)("disabled",0==t.acltypes.length),r.xp6(1),r.Q6J("ngForOf",t.acltypes),r.xp6(1),r.Q6J("disabled",!t.activeTypeId)("ngModel",t.searchterm),r.xp6(2),r.Q6J("disabled",!t.activeTypeId),r.xp6(3),r.Q6J("disabled",!t.activeTypeId||t.aclobjects.length>0),r.xp6(2),r.Q6J("ngStyle",t.contentStyle),r.xp6(1),r.Q6J("ngIf",t.loading)("ngIfElse",e)}},directives:[i.EJ,i.JJ,i.On,l.sg,i.YN,i.Kr,i.Fj,V.J,l.PC,l.O5,v.W,m._,l.mk,$.$],encapsulation:2}),ACLObjectsManagerObjects})();var ne=s(5710),ce=s(2995);const de=["header"],ae=function(e){return{"slds-is-active":e}};function re(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"li",8),r.NdJ("click",(function(){const t=r.CHM(e).$implicit;return r.oxw(2).switchTab(t.tab)})),r.TgZ(1,"a",9),r._UZ(2,"system-label",10),r.qZA()()}if(2&e){const e=t.$implicit,s=r.oxw(2);r.Q6J("ngClass",r.VKq(2,ae,e.tab==s.activeTab)),r.xp6(2),r.Q6J("label",e.label)}}function ue(e,t){if(1&e&&r._UZ(0,"system-dynamic-component",13),2&e){const e=r.oxw().$implicit;r.Q6J("component",e.component)}}const pe=function(e,t){return{"slds-show":e,"slds-hide":t}};function fe(e,t){if(1&e&&(r.TgZ(0,"div",11),r.YNc(1,ue,1,1,"system-dynamic-component",12),r.qZA()),2&e){const e=t.$implicit,s=r.oxw(2);r.Q6J("ngClass",r.WLB(2,pe,e.tab==s.activeTab,e.tab!=s.activeTab)),r.xp6(1),r.Q6J("ngIf",e.component)}}function ge(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"div",1)(1,"ul",2),r.YNc(2,re,3,4,"li",3),r.qZA(),r.YNc(3,fe,2,5,"div",4),r.TgZ(4,"div",5)(5,"button",6),r.NdJ("click",(function(){r.CHM(e);return r.oxw().save()})),r._UZ(6,"system-label",7),r.qZA()()()}if(2&e){const e=r.oxw();r.xp6(2),r.Q6J("ngForOf",e.tabs),r.xp6(1),r.Q6J("ngForOf",e.tabs)}}let be=(()=>{class ACLObjectsManagerObject{constructor(e,t,s,l){this.metadata=e,this.backend=t,this.model=s,this.language=l,this.objectid="",this.typeid="",this.loaded=!1,this.tabs=[],this.activeTab="",this.model.module="SpiceACLObjects";let i=this.metadata.getComponentConfig("ACLObjectsManagerObject",this.model.module);if(i.componentset){let e=this.metadata.getComponentSetObjects(i.componentset);for(let t of e)this.tabs.push({tab:t.id,label:t.componentconfig.name,component:t.component}),this.activeTab||(this.activeTab=t.id)}}switchTab(e){this.activeTab=e}ngOnChanges(){this.loaded=!1,this.objectid&&(this.model.id=this.objectid,this.model.getData(!0).subscribe((e=>{this.loaded=!0})))}save(){this.model.save(!0)}}return ACLObjectsManagerObject.ɵfac=function(e){return new(e||ACLObjectsManagerObject)(r.Y36(E.Pu),r.Y36(u.y),r.Y36(ne.o),r.Y36(f.d))},ACLObjectsManagerObject.ɵcmp=r.Xpm({type:ACLObjectsManagerObject,selectors:[["aclobjects-manager-object"]],viewQuery:function(e,t){if(1&e&&r.Gf(de,7,r.s_b),2&e){let e;r.iGM(e=r.CRH())&&(t.header=e.first)}},inputs:{objectid:"objectid",typeid:"typeid"},features:[r._Bn([ne.o]),r.TTD],decls:1,vars:1,consts:[["class","slds-tabs_scoped","style","height: 100%;",4,"ngIf"],[1,"slds-tabs_scoped",2,"height","100%"],["role","tablist",1,"slds-tabs_scoped__nav"],["class","slds-tabs_scoped__item",3,"ngClass","click",4,"ngFor","ngForOf"],["class","slds-tabs_scoped__content","role","tabpanel",3,"ngClass",4,"ngFor","ngForOf"],[1,"slds-grid","slds-grid--align-center","slds-p-around--xx-small"],[1,"slds-button","slds-button--brand",3,"click"],["label","LBL_SAVE"],[1,"slds-tabs_scoped__item",3,"ngClass","click"],["href","javascript:void(0);","role","tab",1,"slds-tabs_scoped__link"],[3,"label"],["role","tabpanel",1,"slds-tabs_scoped__content",3,"ngClass"],[3,"component",4,"ngIf"],[3,"component"]],template:function(e,t){1&e&&r.YNc(0,ge,7,2,"div",0),2&e&&r.Q6J("ngIf",t.loaded)},directives:[l.O5,l.sg,l.mk,m._,ce.T],encapsulation:2}),ACLObjectsManagerObject})();const me=["managercontent"];let he=(()=>{class ACLObjectsManager{constructor(e,t){this.modelutilities=e,this.elementRef=t,this.activeobjectid="",this.activetypeid=""}get contentStyle(){return{height:"calc(100% - "+this.elementmanagercontent.element.nativeElement.getBoundingClientRect().top+"px"}}setObject(e){this.activeobjectid=e}setType(e){this.activetypeid=e}}return ACLObjectsManager.ɵfac=function(e){return new(e||ACLObjectsManager)(r.Y36(p.A),r.Y36(r.SBq))},ACLObjectsManager.ɵcmp=r.Xpm({type:ACLObjectsManager,selectors:[["ng-component"]],viewQuery:function(e,t){if(1&e&&r.Gf(me,7,r.s_b),2&e){let e;r.iGM(e=r.CRH())&&(t.elementmanagercontent=e.first)}},decls:7,vars:2,consts:[[2,"height","100%"],["displaylabel","LBL_SPICEACLOBJECTS"],[1,"slds-grid",3,"ngStyle"],["managercontent",""],[1,"slds-size--1-of-2","slds-border--right",3,"typeselected","objectselected"],[1,"slds-size--1-of-2",2,"height","100%",3,"objectid"]],template:function(e,t){1&e&&(r.TgZ(0,"div",0)(1,"div"),r._UZ(2,"acl-manager-header",1),r.qZA(),r.TgZ(3,"div",2,3)(5,"aclobjects-manager-objects",4),r.NdJ("typeselected",(function(e){return t.setType(e)}))("objectselected",(function(e){return t.setObject(e)})),r.qZA(),r._UZ(6,"aclobjects-manager-object",5),r.qZA()()),2&e&&(r.xp6(3),r.Q6J("ngStyle",t.contentStyle),r.xp6(3),r.Q6J("objectid",t.activeobjectid))},directives:[h,l.PC,oe,be],encapsulation:2}),ACLObjectsManager})();var ye=s(2294),Ae=s(9062);let Ze=(()=>{class ACLObjectsManagerAddObjectModal{constructor(e,t,s,l){this.metadata=e,this.model=t,this.view=s,this.language=l,this.self={},this.fieldset="",this.sysmodule_id="",this.newObjectData=new r.vpe,this.model.module="SpiceACLObjects",this.model.initialize(),this.model.setField("status","d"),this.view.isEditable=!0,this.view.setEditMode();let i=this.metadata.getComponentConfig("ACLObjectsManagerAddObjectModal");this.fieldset=i.fieldset}ngOnInit(){this.model.setField("sysmodule_id",this.sysmodule_id)}close(){this.self.destroy()}save(){this.model.save().subscribe((e=>{this.newObjectData.emit(this.model.data),this.close()}))}}return ACLObjectsManagerAddObjectModal.ɵfac=function(e){return new(e||ACLObjectsManagerAddObjectModal)(r.Y36(E.Pu),r.Y36(ne.o),r.Y36(ye.e),r.Y36(f.d))},ACLObjectsManagerAddObjectModal.ɵcmp=r.Xpm({type:ACLObjectsManagerAddObjectModal,selectors:[["aclobjects-manager-add-object-modal"]],inputs:{sysmodule_id:"sysmodule_id"},outputs:{newObjectData:"newObjectData"},features:[r._Bn([ne.o,ye.e])],decls:10,vars:1,consts:[[3,"close"],["label","LBL_ADD_OBJECT"],["margin","none"],["direction","vertical",3,"fieldset"],[1,"slds-button","slds-button--neutral",3,"click"],["label","LBL_CANCEL"],[1,"slds-button","slds-button--brand",3,"click"],["label","LBL_SAVE"]],template:function(e,t){1&e&&(r.TgZ(0,"system-modal")(1,"system-modal-header",0),r.NdJ("close",(function(){return t.close()})),r._UZ(2,"system-label",1),r.qZA(),r.TgZ(3,"system-modal-content",2),r._UZ(4,"object-record-fieldset",3),r.qZA(),r.TgZ(5,"system-modal-footer")(6,"button",4),r.NdJ("click",(function(){return t.close()})),r._UZ(7,"system-label",5),r.qZA(),r.TgZ(8,"button",6),r.NdJ("click",(function(){return t.save()})),r._UZ(9,"system-label",7),r.qZA()()()),2&e&&(r.xp6(4),r.Q6J("fieldset",t.fieldset))},directives:[Y.j,P.y,m._,Q.x,Ae.d,S.p],encapsulation:2}),ACLObjectsManagerAddObjectModal})();var _e=s(7514);function ve(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"system-checkbox",11),r.NdJ("ngModelChange",(function(t){const s=r.CHM(e).$implicit;return r.oxw(2).setActionValue(s.id,t)})),r._UZ(1,"system-label",12),r.qZA()}if(2&e){const e=t.$implicit,s=r.oxw(2);r.Q6J("ngModel",s.getActionValue(e.id)),r.xp6(1),r.Q6J("label",e.action)}}function Te(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"system-checkbox",13),r.NdJ("ngModelChange",(function(t){const s=r.CHM(e).$implicit;return r.oxw(2).setActionValue(s.id,t)})),r._UZ(1,"system-label",12),r.qZA()}if(2&e){const e=t.$implicit,s=r.oxw(2);r.Q6J("title",e.description?e.description:e.action)("ngModel",s.getActionValue(e.id)),r.xp6(1),r.Q6J("label",e.action)}}function xe(e,t){if(1&e&&(r.TgZ(0,"div",5)(1,"h2",1),r._UZ(2,"system-label",6),r.qZA(),r.TgZ(3,"div",7)(4,"div",8),r.YNc(5,ve,2,2,"system-checkbox",9),r.qZA(),r.TgZ(6,"div",8),r.YNc(7,Te,2,3,"system-checkbox",10),r.qZA()()()),2&e){const e=r.oxw();r.xp6(5),r.Q6J("ngForOf",e.standardactions),r.xp6(2),r.Q6J("ngForOf",e.objectactions)}}let Ce=(()=>{class ACLObjectsManagerObjectDetails{constructor(e,t,s,l,i){this.view=e,this.metadata=t,this.model=s,this.language=l,this.backend=i,this.fieldset="",this.standardactions=[{id:"list",action:"LBL_LIST"},{id:"listrelated",action:"LBL_LISTRELATED"},{id:"view",action:"LBL_VIEW"},{id:"editrelated",action:"LBL_EDITRELATION"},{id:"edit",action:"LBL_EDIT"},{id:"create",action:"LBL_CREATE"},{id:"deleterelated",action:"LBL_REMOVERELATION"},{id:"delete",action:"LBL_DELETE"},{id:"export",action:"LBL_EXPORT"},{id:"import",action:"LBL_IMPORT"},{id:"massupdate",action:"LBL_MASSUPDATE"}],this.objectactions=[],this.view.isEditable=!0,this.view.setEditMode();let o=this.metadata.getComponentConfig("ACLObjectsManagerObjectDetails","SpiceACLObjects");this.fieldset=o.fieldset}ngOnInit(){this.backend.getRequest("module/SpiceACLObjects/modules/"+this.model.getFieldValue("sysmodule_id")+"/actions").subscribe((e=>{this.objectactions=e,this.objectactions.sort(((e,t)=>e.action.localeCompare(t.action)))}))}get showActions(){return"0"==this.model.getFieldValue("spiceaclobjecttype")||"3"==this.model.getFieldValue("spiceaclobjecttype")}getActionValue(e){let t=this.model.getFieldValue("objectactions");for(let s of t)if(s.spiceaclaction_id==e)return!0;return!1}setActionValue(e,t){let s=this.model.getFieldValue("objectactions");if(t)s.push({spiceaclobject_id:this.model.id,spiceaclaction_id:e});else{let t=s.findIndex((t=>t.spiceaclaction_id==e));s.splice(t,1)}}}return ACLObjectsManagerObjectDetails.ɵfac=function(e){return new(e||ACLObjectsManagerObjectDetails)(r.Y36(ye.e),r.Y36(E.Pu),r.Y36(ne.o),r.Y36(f.d),r.Y36(u.y))},ACLObjectsManagerObjectDetails.ɵcmp=r.Xpm({type:ACLObjectsManagerObjectDetails,selectors:[["aclobjects-manager-object-details"]],features:[r._Bn([ye.e])],decls:5,vars:2,consts:[[1,"slds-box--border"],[1,"slds-text-heading--small","slds-p-around--x-small"],["label","LBL_DETAILS"],["direction","vertical",3,"fieldset"],["class","slds-box--border slds-m-vertical--x-small",4,"ngIf"],[1,"slds-box--border","slds-m-vertical--x-small"],["label","LBL_OBJECT_ACTIONS"],[1,"slds-grid","slds-p-horizontal--small","slds-p-bottom--x-small"],[1,"slds-size--1-of-2","slds-grid","slds-grid--vertical"],[3,"ngModel","ngModelChange",4,"ngFor","ngForOf"],[3,"title","ngModel","ngModelChange",4,"ngFor","ngForOf"],[3,"ngModel","ngModelChange"],[3,"label"],[3,"title","ngModel","ngModelChange"]],template:function(e,t){1&e&&(r.TgZ(0,"div",0)(1,"h2",1),r._UZ(2,"system-label",2),r.qZA(),r._UZ(3,"object-record-fieldset",3),r.qZA(),r.YNc(4,xe,8,2,"div",4)),2&e&&(r.xp6(3),r.Q6J("fieldset",t.fieldset),r.xp6(1),r.Q6J("ngIf",t.showActions))},directives:[m._,Ae.d,l.O5,l.sg,_e.U,i.JJ,i.On],encapsulation:2}),ACLObjectsManagerObjectDetails})();function Le(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"tr")(1,"td")(2,"div",7),r._uU(3),r.qZA()(),r.TgZ(4,"td")(5,"div",13)(6,"div",14)(7,"select",15),r.NdJ("change",(function(t){const s=r.CHM(e).$implicit;return r.oxw(2).setFieldValue("operator",s.id,"change",t)})),r.TgZ(8,"option",16),r._uU(9,"ignore"),r.qZA(),r.TgZ(10,"option",17),r._uU(11,"="),r.qZA(),r.TgZ(12,"option",18),r._uU(13,"≠"),r.qZA(),r.TgZ(14,"option",19),r._uU(15,">"),r.qZA(),r.TgZ(16,"option",20),r._uU(17,"≥"),r.qZA(),r.TgZ(18,"option",21),r._uU(19,"<"),r.qZA(),r.TgZ(20,"option",22),r._uU(21,"≤"),r.qZA(),r.TgZ(22,"option",23),r._uU(23,"Like"),r.qZA(),r.TgZ(24,"option",24),r._uU(25,"in"),r.qZA(),r.TgZ(26,"option",25),r._uU(27,"is emtpy"),r.qZA(),r.TgZ(28,"option",26),r._uU(29,"is not emtpy"),r.qZA(),r.TgZ(30,"option",27),r._uU(31,"starts with"),r.qZA(),r.TgZ(32,"option",28),r._uU(33,"does not start with"),r.qZA(),r.TgZ(34,"option",29),r._uU(35,"Current User Field"),r.qZA()()()()(),r.TgZ(36,"td")(37,"div",13)(38,"input",30),r.NdJ("blur",(function(t){const s=r.CHM(e).$implicit;return r.oxw(2).setFieldValue("value1",s.id,"blur",t)})),r.qZA()()(),r.TgZ(39,"td")(40,"div",13)(41,"input",31),r.NdJ("change",(function(t){const s=r.CHM(e).$implicit;return r.oxw(2).setFieldValue("value2",s.id,"change",t)})),r.qZA()()(),r.TgZ(42,"td")(43,"system-utility-icon",32),r.NdJ("click",(function(){const t=r.CHM(e).$implicit;return r.oxw(2).resetid(t.id)})),r.qZA()()()}if(2&e){const e=t.$implicit,s=r.oxw(2);r.xp6(3),r.Oqu(e.name),r.xp6(4),r.Q6J("value",s.getFieldValue("operator",e.id)),r.xp6(31),r.Q6J("value",s.getFieldValue("value1",e.id)),r.xp6(3),r.Q6J("value",s.getFieldValue("value2",e.id))}}function Me(e,t){if(1&e&&(r.TgZ(0,"div",3)(1,"table",4)(2,"thead")(3,"tr",5)(4,"th",6)(5,"div",7),r._UZ(6,"system-label",8),r.qZA()(),r.TgZ(7,"th",6)(8,"div",7),r._UZ(9,"system-label",9),r.qZA()(),r.TgZ(10,"th",6)(11,"div",7),r._UZ(12,"system-label",10),r.qZA()(),r.TgZ(13,"th",6)(14,"div",7),r._UZ(15,"system-label",11),r.qZA()(),r._UZ(16,"th",6),r.qZA()(),r.TgZ(17,"tbody"),r.YNc(18,Le,44,4,"tr",12),r.qZA()()()),2&e){const e=r.oxw();r.xp6(18),r.Q6J("ngForOf",e.fields)}}let Oe=(()=>{class ACLObjectsManagerObjectFieldvalues{constructor(e,t,s,l,i,o){this.backend=e,this.view=t,this.metadata=s,this.model=l,this.language=i,this.modelutilities=o,this.fields=[],this.fieldset="",this.loadedtype="",this.view.isEditable=!0,this.view.setEditMode(),this.handleType();let n=this.metadata.getComponentConfig("ACLObjectsManagerObjectFieldvalues","SpiceACLObjects");this.fieldset=n.fieldset}handleType(){let e=this.model.getFieldValue("sysmodule_id");e&&this.loadedtype!=e&&(this.loadedtype=e,this.backend.getRequest("module/SpiceACLObjects/modules/"+e).subscribe((e=>{this.fields=e.authtypefields})))}getFieldValue(e,t){let s=this.model.getFieldValue("fieldvalues");if(s&&s.length>0)for(let l of s)if(l.spiceaclmodulefield_id==t)return l[e];return""}setFieldValue(e,t,s,l){let i=this.model.getFieldValue("fieldvalues");if(i&&i.length>0)for(let s of i)if(s.spiceaclmodulefield_id==t)return void(s[e]=l.currentTarget.value);let o={spiceaclobject_id:this.model.id,spiceaclmodulefield_id:t,operator:"",value1:"",value2:""};o[e]=l.currentTarget.value,i.push(o)}resetid(e){let t=0,s=this.model.getFieldValue("fieldvalues");if(s&&s.length>0)for(let l of s){if(l.spiceaclmodulefield_id==e)return void s.splice(t,1);t++}}}return ACLObjectsManagerObjectFieldvalues.ɵfac=function(e){return new(e||ACLObjectsManagerObjectFieldvalues)(r.Y36(u.y),r.Y36(ye.e),r.Y36(E.Pu),r.Y36(ne.o),r.Y36(f.d),r.Y36(p.A))},ACLObjectsManagerObjectFieldvalues.ɵcmp=r.Xpm({type:ACLObjectsManagerObjectFieldvalues,selectors:[["aclobjects-manager-object-fieldvalues"]],features:[r._Bn([ye.e])],decls:3,vars:2,consts:[["class","slds-box",4,"ngIf"],[1,"slds-p-top--small"],["direction","vertical",3,"fieldset"],[1,"slds-box"],[1,"slds-table","slds-table_bordered","slds-table_cell-buffer"],[1,"slds-text-title_caps"],["scope","col"],[1,"slds-truncate"],["label","LBL_NAME"],["label","LBL_OPERATOR"],["label","LBL_VALUE1"],["label","LBL_VALUE2"],[4,"ngFor","ngForOf"],[1,"slds-form-element__control"],[1,"slds-select_container"],[1,"slds-select",3,"value","change"],["value",""],["value","EQ"],["value","NE"],["value","GT"],["value","GTE"],["value","LT"],["value","LTE"],["value","LK"],["value","IN"],["value","ISEMPTY"],["value","ISNEMPTY"],["value","SW"],["value","SN"],["value","CU"],["type","text",1,"slds-input",3,"value","blur"],["type","text",1,"slds-input",3,"value","change"],["icon","clear","size","x-small",3,"click"]],template:function(e,t){1&e&&(r.YNc(0,Me,19,1,"div",0),r.TgZ(1,"div",1),r._UZ(2,"object-record-fieldset",2),r.qZA()),2&e&&(r.Q6J("ngIf",t.fields.length>0),r.xp6(2),r.Q6J("fieldset",t.fieldset))},directives:[l.O5,m._,l.sg,i.YN,i.Kr,x.r,Ae.d],encapsulation:2}),ACLObjectsManagerObjectFieldvalues})();function je(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"tr")(1,"td")(2,"div",6),r._uU(3),r.qZA()(),r.TgZ(4,"td")(5,"div",12)(6,"div",13)(7,"select",14),r.NdJ("change",(function(t){const s=r.CHM(e).$implicit;return r.oxw(2).setFieldControl(s.field,t)})),r.TgZ(8,"option",15),r._UZ(9,"system-label",16),r.qZA(),r.TgZ(10,"option",17),r._UZ(11,"system-label",18),r.qZA(),r.TgZ(12,"option",19),r._UZ(13,"system-label",20),r.qZA()()()()(),r.TgZ(14,"td")(15,"system-utility-icon",21),r.NdJ("click",(function(){const t=r.CHM(e).$implicit;return r.oxw(2).removeField(t.field)})),r.qZA()()()}if(2&e){const e=t.$implicit,s=r.oxw(2);r.xp6(3),r.Oqu(e.field),r.xp6(4),r.Q6J("value",s.getFieldControl(e.field))}}function qe(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"div",2)(1,"table",3)(2,"thead")(3,"tr",4)(4,"th",5)(5,"div",6),r._UZ(6,"system-label",7),r.qZA()(),r.TgZ(7,"th",5)(8,"div",6),r._UZ(9,"system-label",8),r.qZA()(),r._UZ(10,"th",5),r.qZA()(),r.TgZ(11,"tbody"),r.YNc(12,je,16,2,"tr",9),r.qZA()(),r.TgZ(13,"div",10)(14,"system-utility-icon",11),r.NdJ("click",(function(){r.CHM(e);return r.oxw().addField()})),r.qZA()()()}if(2&e){const e=r.oxw();r.xp6(12),r.Q6J("ngForOf",e.fields)}}function Je(e,t){1&e&&(r.TgZ(0,"div",22),r._UZ(1,"system-label",23),r.qZA())}let ke=(()=>{class ACLObjectsManagerObjectFields{constructor(e,t,s){this.modal=e,this.model=t,this.language=s}get fields(){let e=[],t=this.model.getFieldValue("fieldcontrols");if(t)for(let s of t)e.push(s);return e}get showFieldControls(){return"0"==this.model.getFieldValue("spiceaclobjecttype")||"3"==this.model.getFieldValue("spiceaclobjecttype")}getFieldControl(e){let t=this.model.getFieldValue("fieldcontrols");for(let s of t)if(s.field==e)return s.control;return""}setFieldControl(e,t){let s=this.model.getFieldValue("fieldcontrols");for(let l of s)l.field==e&&(l.control=t.currentTarget.value)}removeField(e){let t=this.model.getFieldValue("fieldcontrols"),s=0;for(let l of t){if(l.field==e)return t.splice(s,1),void this.model.setField("fieldcontrols",t);s++}}addField(){let e=this.model.getFieldValue("spiceacltype_module"),t=[],s=this.model.getFieldValue("fieldcontrols");for(let e of s)t.push({name:e.field,id:e.id});this.modal.openModal("ACLTypesManagerTypesAddFields",!0).subscribe((s=>{s.instance.module=e,s.instance.currentfields=t,s.instance.showAll=!0,s.instance.addfields.subscribe((e=>{if(e){let t=this.model.getFieldValue("fieldcontrols"),s=[];for(let l of e){let e=!1;for(let i in t)t[i].field==l&&(e=!0,s.push(t[i]));e||s.push({spiceaclobject_id:this.model.id,field:l,control:1})}t=s,this.model.setField("fieldcontrols",t)}}))}))}}return ACLObjectsManagerObjectFields.ɵfac=function(e){return new(e||ACLObjectsManagerObjectFields)(r.Y36(A.o),r.Y36(ne.o),r.Y36(f.d))},ACLObjectsManagerObjectFields.ɵcmp=r.Xpm({type:ACLObjectsManagerObjectFields,selectors:[["aclobjects-manager-object-fields"]],decls:3,vars:2,consts:[["class","slds-box",4,"ngIf","ngIfElse"],["nofieldcontrols",""],[1,"slds-box"],[1,"slds-table","slds-table_bordered","slds-table_cell-buffer"],[1,"slds-text-title_caps"],["scope","col"],[1,"slds-truncate"],["label","LBL_NAME"],["label","LBL_CONTROL"],[4,"ngFor","ngForOf"],[1,"slds-align_absolute-center","slds-p-top--medium"],["icon","new","size","x-small",3,"click"],[1,"slds-form-element__control"],[1,"slds-select_container"],[1,"slds-select",3,"value","change"],["value","1"],["label","LBL_HIDE"],["value","2"],["label","LBL_DISPLAY"],["value","3"],["label","LBL_EDIT"],["icon","clear","size","x-small",1,"slds-float--right",3,"click"],[1,"slds-p-around--medium","slds-align_absolute-center"],["label","LBL_NOFIELDCONTROLSFORTHISTYPE"]],template:function(e,t){if(1&e&&(r.YNc(0,qe,15,1,"div",0),r.YNc(1,Je,2,0,"ng-template",null,1,r.W1O)),2&e){const e=r.MAs(2);r.Q6J("ngIf",t.showFieldControls)("ngIfElse",e)}},directives:[l.O5,m._,l.sg,i.YN,i.Kr,x.r],encapsulation:2}),ACLObjectsManagerObjectFields})();function Fe(e,t){1&e&&(r.TgZ(0,"div",8),r._UZ(1,"system-spinner"),r.qZA())}function Ue(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"system-custom-icon",21),r.NdJ("click",(function(){r.CHM(e);const t=r.oxw().$implicit;return r.oxw(2).deactivateProfile(t.id)})),r.qZA()}}function we(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"system-custom-icon",22),r.NdJ("click",(function(){r.CHM(e);const t=r.oxw().$implicit;return r.oxw(2).activateProfile(t.id)})),r.qZA()}}const Ie=function(e){return{"slds-theme--shade":e}};function Ne(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"tr",16),r.NdJ("click",(function(){const t=r.CHM(e).$implicit;return r.oxw(2).selectProfile(t)})),r.TgZ(1,"td",12)(2,"div"),r._uU(3),r.qZA()(),r.TgZ(4,"td",17)(5,"div",18),r.YNc(6,Ue,1,0,"system-custom-icon",19),r.YNc(7,we,1,0,"system-custom-icon",20),r.qZA()()()}if(2&e){const e=t.$implicit,s=r.oxw(2);r.Q6J("ngClass",r.VKq(4,Ie,e.id==s.activeProfileId)),r.xp6(3),r.Oqu(e.name),r.xp6(3),r.Q6J("ngIf","r"==e.status),r.xp6(1),r.Q6J("ngIf","r"!=e.status)}}function Ee(e,t){if(1&e&&(r.TgZ(0,"table",9)(1,"thead")(2,"tr",10)(3,"th",11)(4,"div",12),r._UZ(5,"system-label",13),r.qZA()(),r._UZ(6,"th",14),r.qZA()(),r.TgZ(7,"tbody"),r.YNc(8,Ne,8,6,"tr",15),r.qZA()()),2&e){const e=r.oxw();r.xp6(8),r.Q6J("ngForOf",e.aclprofiles)}}let Ye=(()=>{class ACLProfilesManagerProfiles{constructor(e,t,s,l){this.backend=e,this.modal=t,this.language=s,this.modelutilities=l,this.loading=!1,this.aclprofiles=[],this.activeProfile={},this.activeProfileId="",this.searchterm="",this.profileselected=new r.vpe,this.getProfiles()}keyUp(e){if("Enter"===e.key)this.getProfiles()}getProfiles(){this.loading=!0,this.aclprofiles=[],this.activeProfileId="",this.profileselected.emit(this.activeProfileId);let e={fields:["id","name","description","status","for_portal_users"],searchterm:this.searchterm,limit:"-99"};this.backend.getRequest("module/SpiceACLProfiles",e).subscribe((e=>{this.aclprofiles=e.list,this.aclprofiles.sort(((e,t)=>e.name>t.name?1:-1)),this.aclprofiles.forEach((e=>{e.hasOwnProperty("for_portal_users")&&(e.for_portal_users=this.modelutilities.backend2spice("SpiceACLProfiles","for_portal_users",e.for_portal_users))})),this.loading=!1}))}addProfile(){this.modal.openModal("ACLProfilesManagerAddProfileModal").subscribe((e=>{e.instance.newObjectData.subscribe((e=>{e&&(this.aclprofiles.push(e),this.selectProfile(e))}))}))}selectProfile(e){this.activeProfile=e,this.activeProfileId=e.id,this.profileselected.emit(this.activeProfile)}activateProfile(e){this.backend.postRequest("module/SpiceACLProfiles/"+e+"/activation").subscribe((t=>{this.aclprofiles.some((t=>{if(t.id==e)return t.status="r",!0}))}))}deactivateProfile(e){this.backend.deleteRequest("module/SpiceACLProfiles/"+e+"/activation").subscribe((t=>{this.aclprofiles.some((t=>{if(t.id==e)return t.status="d",!0}))}))}}return ACLProfilesManagerProfiles.ɵfac=function(e){return new(e||ACLProfilesManagerProfiles)(r.Y36(u.y),r.Y36(A.o),r.Y36(f.d),r.Y36(p.A))},ACLProfilesManagerProfiles.ɵcmp=r.Xpm({type:ACLProfilesManagerProfiles,selectors:[["aclprofiles-manager-profiles"]],outputs:{profileselected:"profileselected"},decls:9,vars:3,consts:[[1,"slds-grid","slds-grid--vertical-align-center","slds-p-around--x-small"],["type","text",1,"slds-input",3,"ngModel","ngModelChange","keyup"],[1,"slds-p-left--xx-small"],[1,"slds-button","slds-button--icon-border",3,"click"],["icon","new"],["system-to-bottom",""],["class","slds-p-around--medium slds-align--absolute-center",4,"ngIf","ngIfElse"],["profilesdisplay",""],[1,"slds-p-around--medium","slds-align--absolute-center"],[1,"slds-table","slds-table_bordered","slds-table_cell-buffer"],[1,"slds-text-title_caps"],["scope","col",1,"slds-truncate"],[1,"slds-truncate"],["label","LBL_NAME"],["scope","col",2,"width","3rem"],[3,"ngClass","click",4,"ngFor","ngForOf"],[3,"ngClass","click"],[2,"width","3rem"],[1,"slds-grid"],["icon","light-bulb-on","size","x-small","addclasses","slds-icon slds-icon-text-default",3,"click",4,"ngIf"],["icon","light-bulb-off","size","x-small","addclasses","slds-icon slds-icon-text-light",3,"click",4,"ngIf"],["icon","light-bulb-on","size","x-small","addclasses","slds-icon slds-icon-text-default",3,"click"],["icon","light-bulb-off","size","x-small","addclasses","slds-icon slds-icon-text-light",3,"click"]],template:function(e,t){if(1&e&&(r.TgZ(0,"div",0)(1,"input",1),r.NdJ("ngModelChange",(function(e){return t.searchterm=e}))("keyup",(function(e){return t.keyUp(e)})),r.qZA(),r.TgZ(2,"div",2)(3,"button",3),r.NdJ("click",(function(){return t.addProfile()})),r._UZ(4,"system-button-icon",4),r.qZA()()(),r.TgZ(5,"div",5),r.YNc(6,Fe,2,0,"div",6),r.YNc(7,Ee,9,1,"ng-template",null,7,r.W1O),r.qZA()),2&e){const e=r.MAs(8);r.xp6(1),r.Q6J("ngModel",t.searchterm),r.xp6(5),r.Q6J("ngIf",t.loading)("ngIfElse",e)}},directives:[i.Fj,i.JJ,i.On,V.J,_.H,l.O5,v.W,m._,l.sg,l.mk,$.$],encapsulation:2}),ACLProfilesManagerProfiles})();function Pe(e,t){1&e&&(r.TgZ(0,"div",2)(1,"span",3),r._uU(2,"Please select a profile"),r.qZA()())}function Qe(e,t){1&e&&(r.TgZ(0,"div",18),r._UZ(1,"system-spinner"),r.qZA())}function Se(e,t){1&e&&r._UZ(0,"system-custom-icon",35)}function Be(e,t){1&e&&r._UZ(0,"system-custom-icon",36)}function De(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"tr")(1,"td")(2,"div",22),r._uU(3),r.qZA()(),r.TgZ(4,"td")(5,"div",22),r._uU(6),r.qZA()(),r.TgZ(7,"td",30)(8,"div",31),r.YNc(9,Se,1,0,"system-custom-icon",32),r.YNc(10,Be,1,0,"system-custom-icon",33),r.TgZ(11,"system-utility-icon",34),r.NdJ("click",(function(){const t=r.CHM(e).$implicit;return r.oxw(4).removeProfile(t.id)})),r.qZA()()()()}if(2&e){const e=t.$implicit;r.xp6(3),r.Oqu(e.module),r.xp6(3),r.Oqu(e.name),r.xp6(3),r.Q6J("ngIf","r"==e.status),r.xp6(1),r.Q6J("ngIf","r"!=e.status)}}function Re(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"table",19)(1,"thead")(2,"tr",20)(3,"th",21)(4,"div",22),r._UZ(5,"system-label",23),r.qZA()(),r.TgZ(6,"th",21)(7,"div",22),r._UZ(8,"system-label",24),r.qZA()(),r._UZ(9,"th",25),r.qZA()(),r.TgZ(10,"tbody"),r.YNc(11,De,12,4,"tr",26),r.qZA()(),r.TgZ(12,"div",27)(13,"button",28),r.NdJ("click",(function(){r.CHM(e);return r.oxw(3).selectProfile()})),r._UZ(14,"system-button-icon",29),r.qZA()()}if(2&e){const e=r.oxw(3);r.xp6(11),r.Q6J("ngForOf",e.aclobjects)}}function He(e,t){if(1&e&&(r.TgZ(0,"div",15),r.YNc(1,Qe,2,0,"div",16),r.YNc(2,Re,15,1,"ng-template",null,17,r.W1O),r.qZA()),2&e){const e=r.MAs(3),t=r.oxw(2);r.xp6(1),r.Q6J("ngIf",t.loadingobjects)("ngIfElse",e)}}function Ve(e,t){1&e&&(r.TgZ(0,"div",18),r._UZ(1,"system-spinner"),r.qZA())}function $e(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"div",31)(1,"system-utility-icon",34),r.NdJ("click",(function(){r.CHM(e);const t=r.oxw().$implicit;return r.oxw(5).removeUser(t.id)})),r.qZA()()}}function ze(e,t){if(1&e&&(r.TgZ(0,"tr")(1,"td")(2,"div",22),r._uU(3),r.qZA()(),r.TgZ(4,"td",30),r.YNc(5,$e,2,0,"div",41),r.qZA()()),2&e){const e=t.$implicit;r.xp6(3),r.Oqu(e.user_name?e.user_name:e.id),r.xp6(2),r.Q6J("ngIf","*"!=e.id)}}function We(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"div")(1,"table",19)(2,"thead")(3,"tr",20)(4,"th",21)(5,"div",22),r._UZ(6,"system-label",40),r.qZA()(),r._UZ(7,"th",25),r.qZA()(),r.TgZ(8,"tbody"),r.YNc(9,ze,6,2,"tr",26),r.qZA()(),r.TgZ(10,"div",27)(11,"button",28),r.NdJ("click",(function(){r.CHM(e);return r.oxw(4).selectUser()})),r._UZ(12,"system-button-icon",29),r.qZA()()()}if(2&e){const e=r.oxw(4);r.xp6(9),r.Q6J("ngForOf",e.aclusers)}}function Xe(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"div",38)(1,"system-checkbox",39),r.NdJ("ngModelChange",(function(t){r.CHM(e);return r.oxw(3).aclallusers=t})),r._uU(2,"all users"),r.qZA()(),r.YNc(3,We,13,1,"div",14)}if(2&e){const e=r.oxw(3);r.xp6(1),r.Q6J("ngModel",e.aclallusers),r.xp6(2),r.Q6J("ngIf",!e.aclallusers)}}function Ge(e,t){if(1&e&&(r.TgZ(0,"div",15),r.YNc(1,Ve,2,0,"div",16),r.YNc(2,Xe,4,2,"ng-template",null,37,r.W1O),r.qZA()),2&e){const e=r.MAs(3),t=r.oxw(2);r.xp6(1),r.Q6J("ngIf",t.loadingusers)("ngIfElse",e)}}function Ke(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"div")(1,"div",38)(2,"div",42)(3,"label",43),r._UZ(4,"system-label",24),r.qZA(),r.TgZ(5,"div",44)(6,"input",45),r.NdJ("ngModelChange",(function(t){r.CHM(e);return r.oxw(2).profile.name=t})),r.qZA()()(),r.TgZ(7,"div",42)(8,"label",43),r._UZ(9,"system-label",46),r.qZA(),r.TgZ(10,"div",44)(11,"textarea",47),r.NdJ("ngModelChange",(function(t){r.CHM(e);return r.oxw(2).profile.description=t})),r.qZA()()(),r.TgZ(12,"system-checkbox",39),r.NdJ("ngModelChange",(function(t){r.CHM(e);return r.oxw(2).profile.for_portal_users=t})),r._UZ(13,"system-label",48),r.qZA(),r.TgZ(14,"div",49)(15,"button",50),r.NdJ("click",(function(){r.CHM(e);return r.oxw(2).save()})),r._UZ(16,"system-label",51),r.qZA()()()()}if(2&e){const e=r.oxw(2);r.xp6(6),r.Q6J("ngModel",e.profile.name),r.xp6(5),r.Q6J("ngModel",e.profile.description),r.xp6(1),r.Q6J("ngModel",e.profile.for_portal_users)}}const et=function(e){return{"slds-is-active":e}};function tt(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"div",4)(1,"ul",5)(2,"li",6)(3,"a",7),r.NdJ("click",(function(){r.CHM(e);return r.oxw().activetab="profiles"})),r._UZ(4,"system-label",8),r.qZA()(),r.TgZ(5,"li",9)(6,"a",7),r.NdJ("click",(function(){r.CHM(e);return r.oxw().activetab="users"})),r._UZ(7,"system-label",10),r.qZA()(),r.TgZ(8,"li",11)(9,"a",7),r.NdJ("click",(function(){r.CHM(e);return r.oxw().activetab="details"})),r._UZ(10,"system-label",12),r.qZA()()(),r.YNc(11,He,4,2,"div",13),r.YNc(12,Ge,4,2,"div",13),r.YNc(13,Ke,17,3,"div",14),r.qZA()}if(2&e){const e=r.oxw();r.xp6(2),r.Q6J("ngClass",r.VKq(6,et,"profiles"==e.activetab)),r.xp6(3),r.Q6J("ngClass",r.VKq(8,et,"users"==e.activetab)),r.xp6(3),r.Q6J("ngClass",r.VKq(10,et,"details"==e.activetab)),r.xp6(3),r.Q6J("ngIf","profiles"==e.activetab),r.xp6(1),r.Q6J("ngIf","users"==e.activetab),r.xp6(1),r.Q6J("ngIf","details"==e.activetab)}}let st=(()=>{class ACLProfilesManagerProfile{constructor(e,t,s){this.modal=e,this.language=t,this.backend=s,this.profileid="",this.loaded=!1,this.loadingobjects=!1,this.loadingusers=!1,this.activetab="profiles",this.aclobjects=[],this.aclusers=[]}get aclallusers(){return this.aclusers.filter((e=>"*"==e.id)).length>0}set aclallusers(e){e?this.backend.postRequest("module/SpiceACLProfiles/"+this.profileid+"/related/users",{},{userids:["*"]}).subscribe((e=>{this.aclusers.push({id:"*",user_name:""})})):this.backend.deleteRequest("module/SpiceACLProfiles/"+this.profileid+"/related/users/*").subscribe((e=>{let t=0;for(let e of this.aclusers)"*"==e.id&&this.aclusers.splice(t,1),t++}))}ngOnChanges(){this.loaded=!1,this.profileid&&(this.loadingobjects=!0,this.aclobjects=[],this.loadingusers=!0,this.aclusers=[],this.backend.getRequest("module/SpiceACLProfiles/"+this.profileid+"/related/spiceaclobjects").subscribe((e=>{this.aclobjects=e,this.loadingobjects=!1,this.sortobjects()})),this.backend.getRequest("module/SpiceACLProfiles/"+this.profileid+"/related/users").subscribe((e=>{this.aclusers=e,this.loadingusers=!1,this.sortusers()})))}selectProfile(){this.modal.openModal("ACLProfilesManagerAddObjectModal").subscribe((e=>{e.instance.aclobject.subscribe((e=>{this.backend.postRequest("module/SpiceACLProfiles/"+this.profileid+"/related/spiceaclobjects/"+e.id).subscribe((t=>{this.aclobjects.push(e),this.sortobjects()}))}))}))}removeProfile(e){this.backend.deleteRequest("module/SpiceACLProfiles/"+this.profileid+"/related/spiceaclobjects/"+e).subscribe((t=>{let s=0;for(let t of this.aclobjects){if(t.id==e)return void this.aclobjects.splice(s,1);s++}}))}save(){this.backend.save("SpiceACLProfiles",this.profileid,{name:this.profile.name,description:this.profile.description,for_portal_users:this.profile.for_portal_users})}removeUser(e){this.backend.deleteRequest("module/SpiceACLProfiles/"+this.profileid+"/related/users/"+e).subscribe((t=>{let s=0;for(let t of this.aclusers){if(t.id==e)return void this.aclusers.splice(s,1);s++}}))}selectUser(){this.modal.openModal("ObjectModalModuleLookup").subscribe((e=>{e.instance.module="Users",e.instance.multiselect=!0,e.instance.selectedItems.subscribe((e=>{if(e.length){let t=[];e.forEach((e=>{t.push(e.id)})),this.backend.postRequest("module/SpiceACLProfiles/"+this.profileid+"/related/users",{},{userids:t}).subscribe((t=>{e.forEach((e=>{this.aclusers.push({id:e.id,user_name:e.user_name})})),this.sortusers()}))}}))}))}sortobjects(){this.aclobjects.sort(((e,t)=>e.module==t.module?e.name.localeCompare(t.name):e.module.localeCompare(t.module)))}sortusers(){this.aclusers.sort(((e,t)=>"*"==e.id?-1:"*"==t.id||e.user_name>t.user_name?1:-1))}}return ACLProfilesManagerProfile.ɵfac=function(e){return new(e||ACLProfilesManagerProfile)(r.Y36(A.o),r.Y36(f.d),r.Y36(u.y))},ACLProfilesManagerProfile.ɵcmp=r.Xpm({type:ACLProfilesManagerProfile,selectors:[["aclprofiles-manager-profile"]],inputs:{profile:"profile",profileid:"profileid"},features:[r.TTD],decls:3,vars:2,consts:[["style","height: 100%;","class","slds-align_absolute-center",4,"ngIf","ngIfElse"],["objectlist",""],[1,"slds-align_absolute-center",2,"height","100%"],[1,"slds-text-heading--small"],[1,"slds-tabs_scoped"],["role","tablist",1,"slds-tabs_scoped__nav"],["title","Profiles","role","presentation",1,"slds-tabs_scoped__item",3,"ngClass"],["href","javascript:void(0);","role","tab",1,"slds-tabs_scoped__link",3,"click"],["label","LBL_SPICEACLOBJECTS"],["title","Users","role","presentation",1,"slds-tabs_scoped__item",3,"ngClass"],["label","LBL_USERS"],["title","DETAILS","role","presentation",1,"slds-tabs_scoped__item",3,"ngClass"],["label","LBL_DETAILS"],["system-to-bottom","",4,"ngIf"],[4,"ngIf"],["system-to-bottom",""],["class","slds-p-around--medium slds-align--absolute-center",4,"ngIf","ngIfElse"],["objectsdisplay",""],[1,"slds-p-around--medium","slds-align--absolute-center"],[1,"slds-table","slds-table_bordered","slds-table_cell-buffer"],[1,"slds-text-title_caps"],["scope","col"],[1,"slds-truncate"],["label","LBL_MODULE"],["label","LBL_NAME"],["scope","col",2,"width","3rem"],[4,"ngFor","ngForOf"],[1,"slds-p-around--medium","slds-align_absolute-center"],[1,"slds-button",3,"click"],["icon","new"],[2,"width","3rem"],[1,"slds-grid"],["icon","light-bulb-on","size","x-small","addclasses","slds-icon slds-icon-text-default",4,"ngIf"],["icon","light-bulb-off","size","x-small","addclasses","slds-icon slds-icon-text-light",4,"ngIf"],["icon","delete","size","x-small",3,"click"],["icon","light-bulb-on","size","x-small","addclasses","slds-icon slds-icon-text-default"],["icon","light-bulb-off","size","x-small","addclasses","slds-icon slds-icon-text-light"],["usersdisplay",""],[1,"slds-p-around--x-small"],[3,"ngModel","ngModelChange"],["label","LBL_USER_NAME"],["class","slds-grid",4,"ngIf"],[1,"slds-form-element"],[1,"slds-form-element__label"],[1,"slds-form-element__control"],["type","text",1,"slds-input",3,"ngModel","ngModelChange"],["label","LBL_DESCRIPTION"],[1,"slds-textarea",3,"ngModel","ngModelChange"],["label","LBL_FOR_PORTAL_USERS"],[1,"slds-p-vertical--x-small","slds-align--absolute-center"],[1,"slds-button","slds-button--brand",3,"click"],["label","LBL_SAVE"]],template:function(e,t){if(1&e&&(r.YNc(0,Pe,3,0,"div",0),r.YNc(1,tt,14,12,"ng-template",null,1,r.W1O)),2&e){const e=r.MAs(2);r.Q6J("ngIf",!t.profileid)("ngIfElse",e)}},directives:[l.O5,l.mk,m._,_.H,v.W,l.sg,$.$,x.r,V.J,_e.U,i.JJ,i.On,i.Fj],encapsulation:2}),ACLProfilesManagerProfile})(),lt=(()=>{class ACLProfilesManager{constructor(e,t,s){this.backend=e,this.modelutilities=t,this.elementRef=s,this.activeprofileid=""}setProfile(e){this.activeprofile=e,this.activeprofileid=e.id}}return ACLProfilesManager.ɵfac=function(e){return new(e||ACLProfilesManager)(r.Y36(u.y),r.Y36(p.A),r.Y36(r.SBq))},ACLProfilesManager.ɵcmp=r.Xpm({type:ACLProfilesManager,selectors:[["ng-component"]],decls:4,vars:2,consts:[["displaylabel","LBL_SPICEACLPROFILES"],[1,"slds-grid"],[1,"slds-size--1-of-2","slds-border--right",3,"profileselected"],[1,"slds-size--1-of-2",2,"height","100%",3,"profileid","profile"]],template:function(e,t){1&e&&(r._UZ(0,"acl-manager-header",0),r.TgZ(1,"div",1)(2,"aclprofiles-manager-profiles",2),r.NdJ("profileselected",(function(e){return t.setProfile(e)})),r.qZA(),r._UZ(3,"aclprofiles-manager-profile",3),r.qZA()),2&e&&(r.xp6(3),r.Q6J("profileid",t.activeprofileid)("profile",t.activeprofile))},directives:[h,Ye,st],encapsulation:2}),ACLProfilesManager})();const it=["header"];function ot(e,t){if(1&e&&(r.ynx(0),r.TgZ(1,"option",14),r._uU(2),r.qZA(),r.BQk()),2&e){const e=t.$implicit;r.xp6(1),r.Q6J("value",e.id),r.xp6(1),r.Oqu(e.module)}}function nt(e,t){1&e&&(r.TgZ(0,"div",15),r._UZ(1,"system-spinner"),r.qZA())}function ct(e,t){1&e&&r._UZ(0,"system-custom-icon",28)}function dt(e,t){1&e&&r._UZ(0,"system-custom-icon",29)}const at=function(e){return{"slds-theme--shade":e}};function rt(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"tr",24),r.NdJ("click",(function(){const t=r.CHM(e).$implicit;return r.oxw(2).selectObject(t)})),r.TgZ(1,"td")(2,"div",19),r._uU(3),r.qZA()(),r.TgZ(4,"td")(5,"div",19),r._uU(6),r.qZA()(),r.TgZ(7,"td",25),r.YNc(8,ct,1,0,"system-custom-icon",26),r.YNc(9,dt,1,0,"system-custom-icon",27),r.qZA()()}if(2&e){const e=t.$implicit,s=r.oxw(2);r.Q6J("ngClass",r.VKq(5,at,e.id==s.activeObjectId)),r.xp6(3),r.Oqu(e.name),r.xp6(3),r.Oqu(s.getType(e.spiceaclobjecttype)),r.xp6(2),r.Q6J("ngIf","r"==e.status),r.xp6(1),r.Q6J("ngIf","r"!=e.status)}}function ut(e,t){if(1&e&&(r.TgZ(0,"table",16)(1,"thead")(2,"tr",17)(3,"th",18)(4,"div",19),r._UZ(5,"system-label",20),r.qZA()(),r.TgZ(6,"th",18)(7,"div",19),r._UZ(8,"system-label",21),r.qZA()(),r._UZ(9,"th",22),r.qZA()(),r.TgZ(10,"tbody"),r.YNc(11,rt,10,7,"tr",23),r.qZA()()),2&e){const e=r.oxw();r.xp6(11),r.Q6J("ngForOf",e.aclobjects)}}let pt=(()=>{class ACLProfilesManagerAddObjectModal{constructor(e,t){this.language=e,this.backend=t,this.self={},this.acltypes=[],this.aclobjects=[],this.activeTypeId="",this.activeObjectId="",this.searchterm="",this.loading=!1,this.aclobject=new r.vpe,this.backend.getRequest("module/SpiceACLObjects/modules").subscribe((e=>{this.acltypes=e,this.acltypes.sort(((e,t)=>e.module>t.module?1:-1))}))}keyUp(e){if("Enter"===e.key)this.getObjects()}getObjects(){this.loading=!0,this.aclobjects=[];let e={moduleid:this.activeTypeId,searchterm:this.searchterm};this.backend.getRequest("module/SpiceACLObjects",e).subscribe((e=>{this.aclobjects=e,this.aclobjects.sort(((e,t)=>e.name>t.name?1:-1)),this.loading=!1}))}getType(e){return this.language.getFieldDisplayOptionValue("SpiceACLObjects","spiceaclobjecttype",e)}selectType(e){this.getObjects(),this.activeObjectId=""}get currentModule(){for(let e of this.acltypes)if(e.id==this.activeTypeId)return e.module;return""}selectObject(e){e.module=this.currentModule,this.aclobject.emit(e),this.close()}close(){this.self.destroy()}}return ACLProfilesManagerAddObjectModal.ɵfac=function(e){return new(e||ACLProfilesManagerAddObjectModal)(r.Y36(f.d),r.Y36(u.y))},ACLProfilesManagerAddObjectModal.ɵcmp=r.Xpm({type:ACLProfilesManagerAddObjectModal,selectors:[["ng-component"]],viewQuery:function(e,t){if(1&e&&r.Gf(it,7,r.s_b),2&e){let e;r.iGM(e=r.CRH())&&(t.header=e.first)}},outputs:{aclobject:"aclobject"},features:[r._Bn([ne.o])],decls:17,vars:8,consts:[[3,"close"],["label","LBL_SELECT_SPICEACLOBJECT"],["margin","none",3,"grow"],[1,"slds-grid","slds-grid--vertical-align-center","slds-p-around--x-small"],["header",""],[1,"slds-form-element__control","slds-size--1-of-3","slds-p-right--xx-small"],[1,"slds-select_container"],[1,"slds-select",3,"ngModel","disabled","ngModelChange","change"],[4,"ngFor","ngForOf"],["type","text",1,"slds-input",3,"disabled","ngModel","ngModelChange","keyup"],["class","slds-p-around--medium slds-align--absolute-center",4,"ngIf","ngIfElse"],["typesdisplay",""],[1,"slds-button","slds-button--neutral",3,"click"],["label","LBL_CANCEL"],[3,"value"],[1,"slds-p-around--medium","slds-align--absolute-center"],[1,"slds-table","slds-table_bordered","slds-table_cell-buffer"],[1,"slds-text-title_caps"],["scope","col"],[1,"slds-truncate"],["label","LBL_NAME"],["label","LBL_TYPE"],["scope","col",2,"width","3rem"],[3,"ngClass","click",4,"ngFor","ngForOf"],[3,"ngClass","click"],[2,"width","3rem"],["icon","light-bulb-on","size","x-small","addclasses","slds-icon slds-icon-text-default",4,"ngIf"],["icon","light-bulb-off","size","x-small","addclasses","slds-icon slds-icon-text-light",4,"ngIf"],["icon","light-bulb-on","size","x-small","addclasses","slds-icon slds-icon-text-default"],["icon","light-bulb-off","size","x-small","addclasses","slds-icon slds-icon-text-light"]],template:function(e,t){if(1&e&&(r.TgZ(0,"system-modal")(1,"system-modal-header",0),r.NdJ("close",(function(){return t.close()})),r._UZ(2,"system-label",1),r.qZA(),r.TgZ(3,"system-modal-content",2)(4,"div",3,4)(6,"div",5)(7,"div",6)(8,"select",7),r.NdJ("ngModelChange",(function(e){return t.activeTypeId=e}))("change",(function(e){return t.selectType(e)})),r.YNc(9,ot,3,2,"ng-container",8),r.qZA()()(),r.TgZ(10,"input",9),r.NdJ("ngModelChange",(function(e){return t.searchterm=e}))("keyup",(function(e){return t.keyUp(e)})),r.qZA()(),r.YNc(11,nt,2,0,"div",10),r.YNc(12,ut,12,1,"ng-template",null,11,r.W1O),r.qZA(),r.TgZ(14,"system-modal-footer")(15,"button",12),r.NdJ("click",(function(){return t.close()})),r._UZ(16,"system-label",13),r.qZA()()()),2&e){const e=r.MAs(13);r.xp6(3),r.Q6J("grow",!0),r.xp6(5),r.Q6J("ngModel",t.activeTypeId)("disabled",0==t.acltypes.length),r.xp6(1),r.Q6J("ngForOf",t.acltypes),r.xp6(1),r.Q6J("disabled",!t.activeTypeId)("ngModel",t.searchterm),r.xp6(1),r.Q6J("ngIf",t.loading)("ngIfElse",e)}},directives:[Y.j,P.y,m._,Q.x,i.EJ,i.JJ,i.On,l.sg,i.YN,i.Kr,i.Fj,l.O5,v.W,l.mk,$.$,S.p],encapsulation:2}),ACLProfilesManagerAddObjectModal})(),ft=(()=>{class ACLProfilesManagerAddProfileModal{constructor(e,t,s,l){this.metadata=e,this.model=t,this.view=s,this.language=l,this.self={},this.fieldset="",this.sysmodule_id="",this.newObjectData=new r.vpe,this.model.module="SpiceACLProfiles",this.model.initialize(),this.model.setField("status","d"),this.view.isEditable=!0,this.view.setEditMode();let i=this.metadata.getComponentConfig("ACLProfilesManagerAddProfileModal",this.model.module);this.fieldset=i.fieldset}ngOnInit(){this.model.setField("sysmodule_id",this.sysmodule_id)}close(){this.self.destroy()}save(){this.model.save().subscribe((e=>{this.newObjectData.emit(this.model.data),this.close()}))}}return ACLProfilesManagerAddProfileModal.ɵfac=function(e){return new(e||ACLProfilesManagerAddProfileModal)(r.Y36(E.Pu),r.Y36(ne.o),r.Y36(ye.e),r.Y36(f.d))},ACLProfilesManagerAddProfileModal.ɵcmp=r.Xpm({type:ACLProfilesManagerAddProfileModal,selectors:[["ng-component"]],inputs:{sysmodule_id:"sysmodule_id"},outputs:{newObjectData:"newObjectData"},features:[r._Bn([ne.o,ye.e])],decls:10,vars:1,consts:[[3,"close"],["label","LBL_ADD_SPICEACLPROFILE"],["margin","none"],["direction","vertical",3,"fieldset"],[1,"slds-button","slds-button--neutral",3,"click"],["label","LBL_CANCEL"],[1,"slds-button","slds-button--brand",3,"click"],["label","LBL_SAVE"]],template:function(e,t){1&e&&(r.TgZ(0,"system-modal")(1,"system-modal-header",0),r.NdJ("close",(function(){return t.close()})),r._UZ(2,"system-label",1),r.qZA(),r.TgZ(3,"system-modal-content",2),r._UZ(4,"object-record-fieldset",3),r.qZA(),r.TgZ(5,"system-modal-footer")(6,"button",4),r.NdJ("click",(function(){return t.close()})),r._UZ(7,"system-label",5),r.qZA(),r.TgZ(8,"button",6),r.NdJ("click",(function(){return t.save()})),r._UZ(9,"system-label",7),r.qZA()()()),2&e&&(r.xp6(4),r.Q6J("fieldset",t.fieldset))},directives:[Y.j,P.y,m._,Q.x,Ae.d,S.p],encapsulation:2}),ACLProfilesManagerAddProfileModal})();var gt=s(3278),bt=s(5920);const mt=function(e){return{"slds-is-selected":e}};function ht(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"tr",9),r.ynx(1),r.TgZ(2,"td",10),r.NdJ("click",(function(){const t=r.CHM(e).$implicit;return r.oxw().selectProfile(t.id)})),r._uU(3),r.qZA(),r.TgZ(4,"td",11),r._UZ(5,"system-custom-icon",12),r.qZA(),r.TgZ(6,"td",11),r._UZ(7,"system-custom-icon",13),r.qZA(),r.BQk(),r.qZA()}if(2&e){const e=t.$implicit,s=r.oxw();r.Q6J("ngClass",r.VKq(4,mt,e.id==s.selectedProfileId)),r.xp6(3),r.hij(" ",e.name," "),r.xp6(2),r.Q6J("icon","*"==e.user_id?"global":"custom"),r.xp6(2),r.Q6J("icon","r"==e.statue?"light-bulb-off":"light-bulb-on")}}function yt(e,t){if(1&e&&(r.TgZ(0,"tr",20),r.ynx(1),r.TgZ(2,"td"),r._uU(3),r.qZA(),r.TgZ(4,"td"),r._uU(5),r.qZA(),r.TgZ(6,"td",11),r._UZ(7,"system-custom-icon",13),r.qZA(),r.BQk(),r.qZA()),2&e){const e=t.$implicit;r.xp6(3),r.hij(" ",e.module," "),r.xp6(2),r.hij(" ",e.name," "),r.xp6(2),r.Q6J("icon","r"==e.statue?"light-bulb-off":"light-bulb-on")}}function At(e,t){if(1&e&&(r.TgZ(0,"table",14)(1,"thead",1)(2,"tr",2)(3,"th",15),r._UZ(4,"system-label",16),r.qZA(),r.TgZ(5,"th",17),r._UZ(6,"system-label",18),r.qZA(),r.TgZ(7,"th",4),r._UZ(8,"system-label",6),r.qZA()()(),r.TgZ(9,"tbody"),r.YNc(10,yt,8,3,"tr",19),r.qZA()()),2&e){const e=r.oxw();r.xp6(10),r.Q6J("ngForOf",e.profileObjects)}}let Zt=(()=>{class ACLUserProfiles{constructor(e,t,s,l,i,o){this.backend=e,this.toast=t,this.modal=s,this.model=l,this.session=i,this.language=o,this.userProfiles=[],this.selectedProfileId="",this.profileObjects=[],this.backend.getRequest("module/Users/"+this.model.id+"/related/spiceaclprofiles").subscribe((e=>{this.userProfiles=e}))}selectProfile(e){this.selectedProfileId!=e&&(this.selectedProfileId=e,this.profileObjects=[],this.backend.getRequest("module/SpiceACLProfiles/"+e+"/related/spiceaclobjects").subscribe((e=>{for(let t in e)this.profileObjects.push(e[t])})))}}return ACLUserProfiles.ɵfac=function(e){return new(e||ACLUserProfiles)(r.Y36(u.y),r.Y36(gt.A),r.Y36(A.o),r.Y36(ne.o),r.Y36(bt.n),r.Y36(f.d))},ACLUserProfiles.ɵcmp=r.Xpm({type:ACLUserProfiles,selectors:[["ng-component"]],decls:12,vars:2,consts:[[1,"slds-table","slds-table--fixed-layout","slds-table_bordered",2,"box-shadow","0px 2px 5px 0 rgba(0,0,0,.1)","border-radius",".15rem"],[1,"slds-table--bordered","slds-text-align_center"],[1,"slds-text-title--caps"],["label","LBL_SPICEACLPROFILE"],[1,"slds-text-align--center",2,"width","4rem"],["label","LBL_SCOPE"],["label","LBL_ACTIVE"],["class","slds-hint-parent",3,"ngClass",4,"ngFor","ngForOf"],["class","slds-table slds-table--fixed-layout slds-table_bordered slds-table_cell-buffer slds-m-top--medium","style","box-shadow:0px 2px 5px 0 rgba(0,0,0,.1); border-radius: .15rem",4,"ngIf"],[1,"slds-hint-parent",3,"ngClass"],[3,"click"],[1,"slds-text-align--center"],["size","x-small",3,"icon"],["size","x-small","addclasses","slds-icon slds-icon-text-default",3,"icon"],[1,"slds-table","slds-table--fixed-layout","slds-table_bordered","slds-table_cell-buffer","slds-m-top--medium",2,"box-shadow","0px 2px 5px 0 rgba(0,0,0,.1)","border-radius",".15rem"],[2,"width","30%"],["label","LBL_MODULE"],[2,"width","70%"],["label","LBL_SPICEACLOBJECT"],["class","slds-hint-parent",4,"ngFor","ngForOf"],[1,"slds-hint-parent"]],template:function(e,t){1&e&&(r.TgZ(0,"table",0)(1,"thead",1)(2,"tr",2)(3,"th"),r._UZ(4,"system-label",3),r.qZA(),r.TgZ(5,"th",4),r._UZ(6,"system-label",5),r.qZA(),r.TgZ(7,"th",4),r._UZ(8,"system-label",6),r.qZA()()(),r.TgZ(9,"tbody"),r.YNc(10,ht,8,6,"tr",7),r.qZA()(),r.YNc(11,At,11,1,"table",8)),2&e&&(r.xp6(10),r.Q6J("ngForOf",t.userProfiles),r.xp6(1),r.Q6J("ngIf",t.profileObjects.length>0))},directives:[m._,l.sg,l.mk,$.$,l.O5],encapsulation:2}),ACLUserProfiles})();var _t=s(7040),vt=s(2480),Tt=s(6367),xt=s(3208),Ct=s(1790),Lt=s(4271),Mt=s(5957),Ot=s(5638);function jt(e,t){if(1&e&&r._UZ(0,"field-label",3),2&e){const e=r.oxw();r.Q6J("fieldname",e.fieldname)("fieldconfig",e.fieldconfig)}}function qt(e,t){if(1&e&&(r.TgZ(0,"li",7)(1,"a",8),r._uU(2),r.qZA()()),2&e){const e=t.$implicit;r.xp6(1),r.Q6J("id",e.id),r.xp6(1),r.Oqu(e.summary_text)}}function Jt(e,t){if(1&e&&(r.TgZ(0,"field-generic-display",4)(1,"ul",5),r.YNc(2,qt,3,2,"li",6),r.qZA()()),2&e){const e=r.oxw();r.Q6J("fielddisplayclass",e.fielddisplayclass)("fieldconfig",e.fieldconfig)("editable",e.isEditable()),r.xp6(2),r.Q6J("ngForOf",e.users)}}function kt(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"field-lookup-recent",22),r.NdJ("selectedObject",(function(t){r.CHM(e);return r.oxw(2).addItem(t)})),r.qZA()}}function Ft(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"field-lookup-search",23),r.NdJ("selectedObject",(function(t){r.CHM(e);return r.oxw(2).addItem(t)}))("searchWithModal",(function(){r.CHM(e);return r.oxw(2).searchWithModal()})),r.qZA()}if(2&e){const e=r.oxw(2);r.Q6J("searchterm",e.lookupSearchTerm)("disableadd",!0)}}function Ut(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"li",26)(1,"div",27)(2,"span",28),r._UZ(3,"system-icon",29),r.qZA(),r.TgZ(4,"span",30),r._uU(5),r.qZA(),r.TgZ(6,"button",31),r.NdJ("click",(function(){const t=r.CHM(e).$implicit;return r.oxw(3).removeItem(t.id)})),r._UZ(7,"system-button-icon",16),r.qZA()()()}if(2&e){const e=t.$implicit;r.xp6(4),r.Q6J("id",e.id),r.xp6(1),r.Oqu(e.summary_text),r.xp6(2),r.Q6J("icon","close")}}function wt(e,t){if(1&e&&(r.TgZ(0,"ul",24),r.YNc(1,Ut,8,3,"li",25),r.qZA()),2&e){const e=r.oxw(2);r.xp6(1),r.Q6J("ngForOf",e.users)}}const It=function(e){return{"slds-is-open":e}};function Nt(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"div",9)(1,"div",10)(2,"div",11)(3,"div",12)(4,"div",13)(5,"input",14),r.NdJ("focus",(function(){r.CHM(e);return r.oxw().onFocus()}))("click",(function(){r.CHM(e);return r.oxw().onFieldClick()}))("ngModelChange",(function(t){r.CHM(e);return r.oxw().lookupSearchTerm=t})),r.qZA(),r.TgZ(6,"button",15),r.NdJ("click",(function(){r.CHM(e);return r.oxw().searchWithModal()})),r._UZ(7,"system-button-icon",16),r.qZA()(),r.TgZ(8,"div",17),r.YNc(9,kt,1,0,"field-lookup-recent",18),r.YNc(10,Ft,1,2,"field-lookup-search",19),r.qZA()()()(),r.YNc(11,wt,2,1,"ul",20),r._UZ(12,"field-messages",21),r.qZA()}if(2&e){const e=r.oxw();r.Q6J("ngClass",e.getFieldClass()),r.xp6(3),r.Q6J("ngClass",r.VKq(9,It,e.lookupSearchOpen)),r.xp6(2),r.Q6J("ngModel",e.lookupSearchTerm)("placeholder",e.language.getModuleCombinedLabel("LBL_SEARCH","Users")),r.xp6(2),r.Q6J("icon","search"),r.xp6(2),r.Q6J("ngIf",e.lookupSearchOpen&&""===e.lookupSearchTerm),r.xp6(1),r.Q6J("ngIf",e.lookupSearchOpen&&""!==e.lookupSearchTerm),r.xp6(1),r.Q6J("ngIf",e.users.length>0),r.xp6(1),r.Q6J("fieldname",e.fieldname)}}let Et=(()=>{class fieldACLAdditionalUsers extends _t.O{constructor(e,t,s,l,i,o,n,c){super(e,t,s,l,i),this.model=e,this.view=t,this.language=s,this.metadata=l,this.router=i,this.elementRef=o,this.renderer=n,this.modal=c,this.lookupSearchOpen=!1,this.lookupSearchTerm=""}get displayAssignedUser(){return this.fieldconfig.displayassigneduser}get users(){try{return JSON.parse(this.model.getField("spiceacl_additional_users"))}catch(e){return[]}}set users(e){this.model.setField("spiceacl_additional_users",JSON.stringify(e))}addItem(e){let t=this.users;-1==t.findIndex((t=>t.id==e.id))&&t.push({id:e.id,summary_text:e.text}),this.closePopups(),this.users=t}onClick(e){this.elementRef.nativeElement.contains(e.target)||this.closePopups()}closePopups(){this.lookupSearchOpen=!1,this.lookupSearchTerm="",this.clickListener()}removeItem(e){let t=this.users,s=t.findIndex((t=>t.id==e));s>=0&&t.splice(s,1),this.users=t}onFocus(){this.openSearchDropDown()}onFieldClick(){this.openSearchDropDown()}openSearchDropDown(){this.lookupSearchOpen=!0,this.clickListener=this.renderer.listen("document","click",(e=>this.onClick(e)))}parentSearchStyle(){if(this.lookupSearchOpen)return{display:"block"}}searchWithModal(){this.modal.openModal("ObjectModalModuleLookup").subscribe((e=>{e.instance.module="Users",e.instance.multiselect=!1,e.instance.selectedItems.subscribe((e=>{this.addItem({id:e[0].id,text:e[0].summary_text,data:e[0]})})),e.instance.usedSearchTerm.subscribe((e=>{this.lookupSearchTerm=e})),e.instance.searchTerm=this.lookupSearchTerm}))}}return fieldACLAdditionalUsers.ɵfac=function(e){return new(e||fieldACLAdditionalUsers)(r.Y36(ne.o),r.Y36(ye.e),r.Y36(f.d),r.Y36(E.Pu),r.Y36(vt.F0),r.Y36(r.SBq),r.Y36(r.Qsj),r.Y36(A.o))},fieldACLAdditionalUsers.ɵcmp=r.Xpm({type:fieldACLAdditionalUsers,selectors:[["ng-component"]],features:[r.qOj],decls:3,vars:3,consts:[[3,"fieldname","fieldconfig",4,"ngIf"],[3,"fielddisplayclass","fieldconfig","editable",4,"ngIf"],["class","slds-form-element__control",3,"ngClass",4,"ngIf"],[3,"fieldname","fieldconfig"],[3,"fielddisplayclass","fieldconfig","editable"],[1,"slds-list_horizontal","slds-has-dividers_left"],["class","slds-item",4,"ngFor","ngForOf"],[1,"slds-item"],["href","javascript:void(0);","system-model-popover","","module","Users",1,"slds-text-link_reset",3,"id"],[1,"slds-form-element__control",3,"ngClass"],[1,"slds-form-element__control","slds-box--border"],[1,"slds-combobox_container"],["role","combobox",1,"slds-combobox","slds-dropdown-trigger","slds-dropdown-trigger_click",3,"ngClass"],["role","none",1,"slds-combobox__form-element","slds-input-has-icon","slds-input-has-icon_right"],["type","text","aria-autocomplete","list","autoComplete","off","role","textbox",1,"slds-input","slds-combobox__input",3,"ngModel","placeholder","focus","click","ngModelChange"],[1,"slds-button","slds-button_icon","slds-input__icon","slds-input__icon_right",3,"click"],[3,"icon"],["role","listbox",1,"slds-dropdown","slds-dropdown_length-with-icon-7","slds-dropdown_fluid"],["module","Users",3,"selectedObject",4,"ngIf"],["module","Users",3,"searchterm","disableadd","selectedObject","searchWithModal",4,"ngIf"],["class","slds-listbox slds-listbox_horizontal","role","group",4,"ngIf"],[3,"fieldname"],["module","Users",3,"selectedObject"],["module","Users",3,"searchterm","disableadd","selectedObject","searchWithModal"],["role","group",1,"slds-listbox","slds-listbox_horizontal"],["role","presentation","class","slds-listbox__item slds-p-top_xxx-small",4,"ngFor","ngForOf"],["role","presentation",1,"slds-listbox__item","slds-p-top_xxx-small"],[1,"slds-pill"],[1,"slds-icon_container","slds-icon-standard-account","slds-pill__icon_container"],["module","Users","size","small"],["system-model-popover","","module","Users",1,"slds-pill__label",3,"id"],[1,"slds-button","slds-button--icon","slds-pill__remove",3,"click"]],template:function(e,t){1&e&&(r.YNc(0,jt,1,2,"field-label",0),r.YNc(1,Jt,3,4,"field-generic-display",1),r.YNc(2,Nt,13,11,"div",2)),2&e&&(r.Q6J("ngIf",t.displayLabel),r.xp6(1),r.Q6J("ngIf",!t.isEditMode()),r.xp6(1),r.Q6J("ngIf",t.isEditable()&&t.isEditMode()))},directives:[l.O5,Tt.q,xt.D,l.sg,Ct.g,l.mk,i.Fj,i.JJ,i.On,V.J,Lt.P,Mt.$,g.f,Ot.a],styles:["input[_ngcontent-%COMP%], input[_ngcontent-%COMP%]:focus{border:none;outline:none}"]}),fieldACLAdditionalUsers})(),Yt=(()=>{class ModuleACL{}return ModuleACL.ɵfac=function(e){return new(e||ModuleACL)},ModuleACL.ɵmod=r.oAB({type:ModuleACL}),ModuleACL.ɵinj=r.cJS({imports:[[l.ez,i.u5,o.ObjectFields,n.GlobalComponents,c.ObjectComponents,a.SystemComponents,d.o]]}),ModuleACL})();("undefined"==typeof ngJitMode||ngJitMode)&&r.kYT(Yt,{declarations:[N,h,J,w,H,F,R,he,oe,Ze,be,Ce,Oe,ke,lt,Ye,st,ft,pt,Zt,Et],imports:[l.ez,i.u5,o.ObjectFields,n.GlobalComponents,c.ObjectComponents,a.SystemComponents,d.o]})}}]);