/*
SpiceUI 2018.10.001

Copyright (c) 2016-present, aac services.k.s - All rights reserved.
Redistribution and use in source and binary forms, without modification, are permitted provided that the following conditions are met:
- Redistributions of source code must retain this copyright and license notice, this list of conditions and the following disclaimer.
- Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.
- If used the SpiceCRM Logo needs to be displayed in the upper left corner of the screen in a minimum dimension of 31x31 pixels and be clearly visible, the icon needs to provide a link to http://www.spicecrm.io
THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.

*/

/** 
 * Â© 2015 - 2021 aac services k.s. All rights reserved.
 * release: 2021.03.001
 * date: 2021-11-16 15:32:27
 * build: 2021.03.001.1637073147381
 **/
"use strict";var __assign=this&&this.__assign||function(){return(__assign=Object.assign||function(e){for(var s,t=1,i=arguments.length;t<i;t++)for(var l in s=arguments[t])Object.prototype.hasOwnProperty.call(s,l)&&(e[l]=s[l]);return e}).apply(this,arguments)},__decorate=this&&this.__decorate||function(e,s,t,i){var l,a=arguments.length,o=a<3?s:null===i?i=Object.getOwnPropertyDescriptor(s,t):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,s,t,i);else for(var n=e.length-1;0<=n;n--)(l=e[n])&&(o=(a<3?l(o):3<a?l(s,t,o):l(s,t))||o);return 3<a&&o&&Object.defineProperty(s,t,o),o},__metadata=this&&this.__metadata||function(e,s){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,s)},__spreadArray=this&&this.__spreadArray||function(e,s){for(var t=0,i=s.length,l=e.length;t<i;t++,l++)e[l]=s[t];return e};Object.defineProperty(exports,"__esModule",{value:!0}),exports.AdministrationJobScheduleButton=exports.AdministrationJobRunButton=exports.AdministrationJobLog=exports.AdministrationJobMethods=exports.AdministrationConfigEditor=exports.AdministrationDictRepairConvertDBCharsetModal=exports.AdministrationDictRepairConvertDBCharset=exports.AdministrationDictRepairDbColumnsModal=exports.AdministrationDictRepairDbColumns=exports.AdministrationDictRepairCache=exports.AdministrationDictRepairACLRoles=exports.AdministrationDictRepairLanguage=exports.AdministrationDictRepairModal=exports.AdministrationDictRepairItem=exports.AdministrationDictRepair=exports.AdministrationSysTrashcanRecover=exports.AdministrationSysTrashcanManager=exports.AdministrationApiInspectorMethodTest=exports.AdministrationapiinspectorMethodResponses=exports.AdministrationApiInspectorMethods=exports.AdministrationApiInspectorMethodParameters=exports.AdministrationAPIInspectorDetails=exports.AdministrationAPIInspector=exports.AdministrationSystemVersions=exports.AdministrationSystemStats=exports.AdministrationHomeScreenCardItem=exports.AdministrationHomeScreenCard=exports.AdministrationHomeScreen=exports.AdministrationFtsManagerIndexModal=exports.AdministrationFTSStats=exports.AdministrationFTSManagerFieldsAdd=exports.AdministrationFTSManagerModuleAdd=exports.AdministrationFTSManagerDetails=exports.AdministrationFTSManagerFieldsList=exports.AdministrationFTSManagerFields=exports.AdministrationFTSManager=exports.AdministrationFTSStatus=exports.AdministrationQuotaManagerField=exports.AdministrationQuotaManager=exports.AdministrationConfiguratorItemRole=exports.AdministrationConfiguratorItem=exports.AdministrationConfigurator=exports.AdministrationMenuRouteItem=exports.AdministrationMenu=exports.AdministrationMain=exports.administrationapiinspectorService=exports.administration=exports.dictionary=exports.ftsconfiguration=exports.administrationconfigurator=void 0,exports.AdminComponentsModule=exports.AdministrationGDPRRetentionManager=exports.AdministrationLoginManagement=exports.AdministrationBlockedUsers=exports.AdministrationPasswordConfig=exports.AdministrationLoginRestrictionIpAddressesRow=exports.AdministrationLoginRestrictionIpAddresses=exports.AdministrationLoginRestriction=exports.AdministrationUserAccessLogViewer=exports.AdministrationDefaultPreferences=exports.AdministrationLanguages=exports.AdministrationGeneralSettings=exports.AdministrationDictionaryManagerItem=exports.AdministrationDictionaryManager=exports.AdministrationDictionaryManagerItemField=exports.AdministrationJobCockpit=exports.AdministrationJobFailedList=exports.AdministrationJobRunningList=exports.AdministrationJobTaskRunButton=exports.AdministrationJobKillButton=void 0;var common_1=require("@angular/common"),forms_1=require("@angular/forms"),core_1=require("@angular/core"),drag_drop_1=require("@angular/cdk/drag-drop"),router_1=require("@angular/router"),directives_1=require("../directives/directives"),systemcomponents_1=require("../systemcomponents/systemcomponents"),objectcomponents_1=require("../objectcomponents/objectcomponents"),objectfields_1=require("../objectfields/objectfields"),rxjs_1=require("rxjs"),services_1=require("../services/services"),http_1=require("@angular/common/http"),animations_1=require("@angular/animations"),operators_1=require("rxjs/operators"),administrationconfigurator=function(){function e(e,s){this.backend=e,this.modelutilities=s,this.dictionary="",this.entries=[],this.sorting={field:"",direction:""},this.fielddefobj={}}return e.prototype.loadEntries=function(n){var d=this;void 0===n&&(n=[]),this.backend.getRequest("configuration/configurator/entries/"+this.dictionary).subscribe(function(e){d.fielddefobj={};for(var s=0,t=n;s<t.length;s++){var i=t[s];d.fielddefobj[i.name]=i.type||""}for(var l=0,a=e;l<a.length;l++){var o=a[l];d.entries.push({id:o.id,mode:"",data:d.mapData(o)})}})},e.prototype.mapData=function(e){for(var s in this.fielddefobj)switch(this.fielddefobj[s]){case"bool":case"boolean":e[s]="1"==e[s]}return e},e.prototype.remapData=function(e){var s,t={};for(s in this.fielddefobj)switch(this.fielddefobj[s]){case"bool":case"boolean":t[s]=1==e[s]?"1":"0";break;default:t[s]=e[s]}return t},e.prototype.addEntry=function(){var e=this.modelutilities.generateGuid();this.entries.unshift({id:e,mode:"new",data:{id:e}})},e.prototype.saveEntry=function(e){var t=this;this.entries.some(function(s){if(s.id===e)return delete s.backup,t.backend.postRequest("configuration/configurator/"+t.dictionary+"/"+e,{},{config:t.remapData(s.data)}).subscribe(function(e){s.mode=""}),!0})},e.prototype.deleteEntry=function(t){var i=this;this.entries.some(function(e,s){if(e.id===t)return delete e.backup,i.backend.deleteRequest("configuration/configurator/"+i.dictionary+"/"+t).subscribe(function(e){i.entries.splice(s,1)}),!0})},e.prototype.setEditMode=function(s){this.entries.some(function(e){if(e.id===s)return e.mode="edit",e.backup=JSON.parse(JSON.stringify(e.data)),!0})},e.prototype.cancelEditMode=function(t){var i=this;this.entries.some(function(e,s){if(e.id===t)return"new"===e.mode?i.entries.splice(s,1):(e.data=JSON.parse(JSON.stringify(e.backup)),delete e.backup,e.mode=""),!0})},e.prototype.isEditMode=function(s){var t=!1;return this.entries.some(function(e){if(e.id===s)return t="edit"===e.mode||"new"===e.mode,!0}),t},e.prototype.copy=function(t){var i=this;this.entries.some(function(e){if(e.id===t){var s={};return s.data=JSON.parse(JSON.stringify(e.data)),s.mode="new",s.id=i.modelutilities.generateGuid(),s.data.id=s.id,i.entries.unshift(s),!0}})},e.prototype.sort=function(e){var t=this;this.sorting.field===e?this.sorting.direction="asc"==this.sorting.direction?"dsc":"asc":(this.sorting.field=e,this.sorting.direction="asc"),this.entries.sort(function(e,s){return e.data[t.sorting.field]==s.data[t.sorting.field]?0:"asc"==t.sorting.direction?e.data[t.sorting.field]<s.data[t.sorting.field]?-1:1:e.data[t.sorting.field]<s.data[t.sorting.field]?1:-1})},__decorate([core_1.Injectable(),__metadata("design:paramtypes",[services_1.backend,services_1.modelutilities])],e)}();exports.administrationconfigurator=administrationconfigurator;var ftsconfiguration=function(){function e(e,s,t,i,l){var a=this;this.backend=e,this.metadata=s,this.language=t,this.modal=i,this.toast=l,this.module="",this.module$=new core_1.EventEmitter,this.moduleFtsFields=[],this.moduleFtsSettings={},this.indexing=!1,this.modules=[],this.analyzers=[],this.backend.getRequest("configuration/elastic/core/modules").subscribe(function(e){return a.modules=e}),this.backend.getRequest("configuration/elastic/core/analyzers").subscribe(function(e){return a.analyzers=e.sort(function(e,s){return e.value>s.value?1:-1})})}return e.prototype.setModule=function(e){this.module=e,0<=this.modules.indexOf(e)?(this.getModuleFtsFields(),this.getModuleSettings()):(this.module&&this.modules.push(e),this.moduleFtsFields=[],this.moduleFtsSettings=[]),this.module$.emit(e)},e.prototype.getModuleFtsFields=function(){var s=this;this.moduleFtsFields=[],this.backend.getRequest("configuration/elastic/"+this.module+"/fields").subscribe(function(e){s.moduleFtsFields=e})},e.prototype.getModuleSettings=function(){var s=this;this.moduleFtsSettings=[],this.backend.getRequest("configuration/elastic/"+this.module+"/settings").subscribe(function(e){s.moduleFtsSettings=e})},e.prototype.getFieldDetails=function(s){var t={};return this.moduleFtsFields.some(function(e){if(e.id===s)return t=e,!0}),t},e.prototype.deleteModule=function(s){var t=this;this.backend.deleteRequest("configuration/elastic/"+this.module).subscribe(function(e){t.modules.splice(t.modules.indexOf(s),1),t.module=""})},e.prototype.save=function(s){var t=this;void 0===s&&(s=!0);var i=new rxjs_1.Subject,e={fields:this.moduleFtsFields,settings:this.moduleFtsSettings};return this.backend.postRequest("configuration/elastic/"+this.module,{},e).subscribe(function(e){i.next(e),s&&(e?t.toast.sendToast(t.language.getLabel("LBL_DATA_SAVED"),"success"):t.toast.sendToast(t.language.getLabel("ERR_NETWORK"),"error"))},function(e){return i.error(e)}),i},e.prototype.searchPath=function(s){var t=!1;return this.moduleFtsFields.some(function(e){if(e.path===s)return t=!0}),t},e.prototype.executeAction=function(e,s){var i=this,l="",a="";switch(e){case"bulk":l="configuration/elastic/"+this.module+"/index",a="LBL_INDEX";break;case"init":l="configuration/elastic/core/initialize",a="LBL_INITIALIZE";break;case"reset":l="configuration/elastic/"+this.module+"/index/reset",a="LBL_RESET"}this.modal.openModal("SystemLoadingModal").subscribe(function(t){t.instance.messagelabel=i.language.getLabel("LBL_EXECUTING")+": "+i.language.getLabel(a),"reset"==e?i.save(!1).subscribe(function(e){i.backend.postRequest(l,s).subscribe(function(e){var s;e&&e.message&&"string"==typeof e.message&&0<e.message.length?(s=e.type&&0<e.type.length?e.type:i.language.getLabel("LBL_INFO"),i.modal.info(e.message,s,e.status)):"error"!=e.status&&i.toast.sendToast(i.language.getLabel("MSG_SUCCESSFULLY_EXECUTED"),"success"),t.instance.self.destroy()},function(e){return t.instance.self.destroy()})},function(e){return t.instance.self.destroy()}):i.backend.postRequest(l,s).subscribe(function(e){var s;e&&e.message&&"string"==typeof e.message&&0<e.message.length?(s=e.type&&0<e.type.length?e.type:i.language.getLabel("LBL_INFO"),i.modal.info(e.message,s,e.status)):"error"!=e.status&&i.toast.sendToast(i.language.getLabel("MSG_SUCCESSFULLY_EXECUTED"),"success"),t.instance.self.destroy()},function(e){return t.instance.self.destroy()})})},__decorate([core_1.Injectable(),__metadata("design:paramtypes",[services_1.backend,services_1.metadata,services_1.language,services_1.modal,services_1.toast])],e)}();exports.ftsconfiguration=ftsconfiguration;var dictionary=function(){function e(e,s,t,i){this.http=e,this.configurationService=s,this.session=t,this.metadata=i,this.data=[],this.dictionaryitem="",this.dictionaryfields=[]}return e.prototype.load=function(e){var s=this,t=new rxjs_1.Subject;return this.dictionaryitem=e,this.http.get(this.configurationService.getBackendUrl()+"/dictionary/list/"+e+"?sessionid="+this.session.authData.sessionId).subscribe(function(e){s.data=e.items,s.dictionaryfields=e.fields,t.next(e),t.complete()}),t.asObservable()},e.prototype.getFields=function(){for(var e=[],s=0,t=this.dictionaryfields;s<t.length;s++){var i=t[s];"id"!==i&&e.push(i)}return e},__decorate([core_1.Injectable(),__metadata("design:paramtypes",[http_1.HttpClient,services_1.configurationService,services_1.session,services_1.metadata])],e)}();exports.dictionary=dictionary;var administration=function(){function e(e,s,t){var i=this;this.backend=e,this.broadcast=s,this.language=t,this.loading=!1,this.adminNavigation=[],this.opened_itemid={},this.admincomponent={component:"AdministrationHomeScreen",componentconfig:{}},this.itemfilter="",this.admincomponent$=new rxjs_1.BehaviorSubject(this.admincomponent),this.loadNavigation(),this.broadcastsubscription=this.broadcast.message$.subscribe(function(e){i.handleMessage(e)})}return e.prototype.ngOnDestroy=function(){this.broadcastsubscription.unsubscribe()},e.prototype.handleMessage=function(e){"loader.reloaded"===e.messagetype&&this.loadNavigation()},e.prototype.loadNavigation=function(){var s=this;this.loading=!0,this.backend.getRequest("system/spiceui/admin/navigation").subscribe(function(e){s.adminNavigation=e,s.loading=!1})},e.prototype.navigateHome=function(){this.opened_itemid=null,this.admincomponent={component:"AdministrationHomeScreen",componentconfig:{}},this.admincomponent$.next(this.admincomponent)},e.prototype.getItemLabel=function(s){var t;return this.adminNavigation.some(function(e){if(t=e.groupcomponents.find(function(e){return e.id==s}))return!0}),t.admin_label},e.prototype.navigateto=function(s){var t;this.adminNavigation.some(function(e){if(t=e.groupcomponents.find(function(e){return e.id==s}))return!0}),t.component&&(this.admincomponent=t,this.admincomponent$.next(this.admincomponent),this.opened_itemid=s)},Object.defineProperty(e.prototype,"navigationGroups",{get:function(){if(""==this.itemfilter)return this.adminNavigation;for(var e=[],s=0,t=this.adminNavigation;s<t.length;s++){var i=t[s];if(i.label&&0<=this.language.getLabel(i.label).toLowerCase().indexOf(this.itemfilter.toLowerCase())||i.label&&0<=this.language.getLabel(i.label,"","long").toLowerCase().indexOf(this.itemfilter.toLowerCase()))e.push(i);else{for(var l=[],a=0,o=i.groupcomponents;a<o.length;a++){var n=o[a];(0<=n.adminaction.toLowerCase().indexOf(this.itemfilter.toLowerCase())||n.admin_label&&0<=this.language.getLabel(n.admin_label).toLowerCase().indexOf(this.itemfilter.toLowerCase())||n.admin_label&&0<=this.language.getLabel(n.admin_label,"","long").toLowerCase().indexOf(this.itemfilter.toLowerCase()))&&l.push(n)}0<l.length&&e.push({id:i.id,name:i.name,label:i.label,groupcomponents:l})}}return e},enumerable:!1,configurable:!0}),__decorate([core_1.Injectable(),__metadata("design:paramtypes",[services_1.backend,services_1.broadcast,services_1.language])],e)}();exports.administration=administration;var administrationapiinspectorService=function(){function e(e,s,t,i){this.backend=e,this.toast=s,this.injector=t,this.modelutilities=i,this.loading=!1,this.apiEndpoints=[],this.finalArray={},this.flattendArray=[],this.apiTree=[],this.apiMethods=[],this._apiSubMethods=!0,this._apiFilterUnauthorized=!1,this._apiFilterAdminOnly=!1,this._apiFilterValidatedOnly=!1,this.loadEndpoints()}return Object.defineProperty(e.prototype,"apiFilter",{get:function(){return this._apiFilter},set:function(e){this._apiFilter=e,this.buildTree()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"apiFilterUnauthorized",{get:function(){return this._apiFilterUnauthorized},set:function(e){this._apiFilterUnauthorized=e,this._apiFilterUnauthorized&&(this._apiFilterAdminOnly=!1),this.buildTree()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"apiFilterAdminOnly",{get:function(){return this._apiFilterAdminOnly},set:function(e){this._apiFilterAdminOnly=e,this._apiFilterAdminOnly&&(this._apiFilterUnauthorized=!1),this.buildTree()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"apiFilterValidatedOnly",{get:function(){return this._apiFilterValidatedOnly},set:function(e){this._apiFilterValidatedOnly=e,this.buildTree()},enumerable:!1,configurable:!0}),e.prototype.loadEndpoints=function(){var s=this;this.loading=!0,this.backend.getRequest("admin/routes").subscribe(function(e){s.apiEndpoints=e,s.apiEndpoints.sort(function(e,s){return e.route.replace("{","").localeCompare(s.route.replace("{",""))}),s.buildTree(),s.loading=!1},function(e){s.toast.sendToast("Error Loading Routes","error"),s.loading=!1})},e.prototype.buildTree=function(){var s=this;this.apiMethods=[],this.apiTree=[],this.loading=!0;for(var e=this,t=0,i=this.apiEndpoints.filter(function(e){return(!s._apiFilterUnauthorized||!0===e.options.noAuth)&&((!s._apiFilterAdminOnly||!0===e.options.adminOnly)&&((!s._apiFilterValidatedOnly||!0!==e.options.validate)&&(!s._apiFilter||0<=e.route.toLowerCase().indexOf(s._apiFilter.toLowerCase()))))});t<i.length;t++)!function(s){if(!s.route)return;e.apiTree.find(function(e){return e.route==s.route})||e.addRouteToTree(s.route)}(i[t]);this.loading=!1},e.prototype.addRouteToTree=function(e){var s=this.getPartentId(e),t=this.getRouteId(e);return this.apiTree.push({id:t,name:"/"!=e?e.split("/").pop():e,route:e,parent_id:s,parent_sequence:this.apiTree.filter(function(e){return e.parent_id==s}).length,clickable:!0}),t},e.prototype.getPartentId=function(e){e=e.substring(1).split("/");if(e.pop(),0!=e.length){var s="/"+e.join("/"),e=this.apiTree.find(function(e){return e.route==s});return e?e.id:this.addRouteToTree(s)}},e.prototype.getRouteId=function(s){return this.apiTree.find(function(e){return e.route==s})?this.apiTree.find(function(e){return e.route==s}).id:this.modelutilities.generateGuid()},e.prototype.selectAPI=function(s){this.selectedAPI=this.apiTree.find(function(e){return e.id==s}),this.filterMethods()},Object.defineProperty(e.prototype,"apiSubMethods",{get:function(){return this._apiSubMethods},set:function(e){this._apiSubMethods=e,this.filterMethods()},enumerable:!1,configurable:!0}),e.prototype.filterMethods=function(){var s=this;this.apiMethods=this.apiEndpoints.filter(function(e){return s._apiSubMethods?0==e.route.indexOf(s.selectedAPI.route):e.route==s.selectedAPI.route})},e.prototype.getMethodParameters=function(s,t,e){var i,l=[],a=this.apiEndpoints.find(function(e){return e.route==s&&e.method==t});if(!a.parameters)return[];for(i in a.parameters){var o=__assign({},a.parameters[i]);o.in==e&&(o.name=i,l.push(o))}return l.sort(function(e,s){return e.name.localeCompare(s.name)})},e.prototype.getMethodResponses=function(s,t){var e,i=[],l=this.apiEndpoints.find(function(e){return e.route==s&&e.method==t});if(!l.responses)return[];for(e in l.responses){var a=__assign({},l.responses[e]);a.name=e,i.push(a)}return i.sort(function(e,s){return e.name.localeCompare(s.name)})},e.prototype.getMethodRequests=function(s,t,e){var i,l=this.apiEndpoints.find(function(e){return e.route==s&&e.method==t});if(!l.requestBody)return[];for(i in l.requestBody)__assign({},l.requestBody[i]);return[].sort(function(e,s){return e.name.localeCompare(s.name)})},e.prototype.getMethodStyle=function(e){var s="inherit";switch(e){case"get":s="#05628a";break;case"post":s="#f38303";break;case"put":s="#41b658";break;case"delete":s="#d83a00"}return{width:"100px",color:"#ffffff",background:s}},__decorate([core_1.Injectable(),__metadata("design:paramtypes",[services_1.backend,services_1.toast,core_1.Injector,services_1.modelutilities])],e)}();exports.administrationapiinspectorService=administrationapiinspectorService;var AdministrationMain=function(){function AdministrationMain(e,s,t,i,l){this.administration=e,this.metadata=s,this.language=t,this.navigation=i,this.navigationtab=l,this.admincontentObject=null,this.navigationtab.setTabInfo({displayname:this.language.getLabel("LBL_ADMINISTRATION"),displayicon:"settings"})}return AdministrationMain.prototype.ngAfterViewInit=function(){var s=this;this.administration.admincomponent$.subscribe(function(e){s.openContent(e)})},AdministrationMain.prototype.openContent=function(s){var t=this;this.admincontentObject&&this.admincontentObject.destroy(),this.metadata.addComponent(s.component,this.admincontentcontainer).subscribe(function(e){e.instance.componentconfig=s.componentconfig,t.admincontentObject=e})},__decorate([core_1.ViewChild("admincontentcontainer",{read:core_1.ViewContainerRef,static:!0}),__metadata("design:type",core_1.ViewContainerRef)],AdministrationMain.prototype,"admincontentcontainer",void 0),__decorate([core_1.Component({template:'<div system-to-bottom-noscroll class="slds-grid" [system-overlay-loading-spinner]="administration.loading"><div class="slds-large-size--1-of-8 slds-medium-size--1-of-6" style="min-width: 220px;"><administration-menu></administration-menu></div><div class="slds-grow" system-to-bottom><div #admincontentcontainer></div></div></div>',providers:[administration]}),__metadata("design:paramtypes",[administration,services_1.metadata,services_1.language,services_1.navigation,services_1.navigationtab])],AdministrationMain)}();exports.AdministrationMain=AdministrationMain;var AdministrationMenu=function(){function e(e,s,t){this.language=e,this.navigationtab=s,this.administration=t}return e.prototype.trackbyfn=function(e,s){return s.id},e.prototype.openContent=function(e){if(this.administration.opened_itemid==e)return!0;var s=this.administration.getItemLabel(e);this.navigationtab.setTabInfo({displayname:this.language.getLabel(s||"LBL_ADMINISTRATION"),displayicon:"settings"}),this.administration.navigateto(e)},__decorate([core_1.Component({selector:"administration-menu",template:'<div class="slds-grid slds-grid--vertical slds-navigation-list--vertical slds-navigation-list--vertical-inverse slds-border--right"><div class="slds-p-horizontal--xx-small slds-p-vertical--small slds-border--bottom slds-grid slds-grid--vertical-align-center"><div class="slds-p-horizontal--x-small"><button class="slds-button slds-button_icon" (click)="administration.navigateHome()" tabindex="-1"><system-button-icon icon="home"></system-button-icon></button></div><div class="slds-grow slds-form-element__control slds-input-has-icon slds-input-has-icon_right slds-input-has-icon_group-right slds-m-vertical--xx-small"><input type="text" class="slds-input" [placeholder]="language.getLabel(\'LBL_SEARCH\')" [(ngModel)]="administration.itemfilter"><system-utility-icon *ngIf="administration.itemfilter == \'\'" [icon]="\'search\'" [addclasses]="\'slds-input__icon slds-input__icon--left\'"></system-utility-icon><div *ngIf="administration.itemfilter != \'\'" class="slds-input__icon-group slds-input__icon-group_right" style="margin-top: initial;"><button class="slds-input__icon slds-input__icon_right slds-button slds-button_icon" (click)="administration.itemfilter = \'\'" tabindex="-1"><system-button-icon [icon]="\'clear\'"></system-button-icon></button></div></div></div><div system-to-bottom><div class="slds-p-bottom--medium"><ng-container *ngFor="let adminNavigationBlock of administration.navigationGroups; trackBy: trackbyfn"><h2 class="slds-text-title--caps slds-p-around--medium"><system-label [label]="adminNavigationBlock.label"></system-label></h2><ul><li *ngFor="let item of adminNavigationBlock.groupcomponents; trackBy: trackbyfn" [title]="language.getLabel(item.admin_label, \'\', \'long\')"><a href="javascript:void(0);" class="slds-navigation-list--vertical__action slds-p-vertical--xxx-small slds-text-link--reset" (click)="openContent(item.id)" [ngClass]="{\'slds-theme_inverse\': item.id == administration.opened_itemid}"><div class="slds-grid slds-grid--vertical-align-center slds-truncate"><system-icon [icon]="item.icon?item.icon:\'empty\'" size="x-small"></system-icon><system-label [label]="item.admin_label"></system-label></div></a></li></ul></ng-container></div></div></div>'}),__metadata("design:paramtypes",[services_1.language,services_1.navigationtab,administration])],e)}();exports.AdministrationMenu=AdministrationMenu;var AdministrationMenuRouteItem=function(){function AdministrationMenuRouteItem(e){this.router=e,this.componentconfig={},this.self={}}return AdministrationMenuRouteItem.prototype.ngOnInit=function(){this.componentconfig.route&&this.router.navigate([this.componentconfig.route])},__decorate([core_1.Component({template:""}),__metadata("design:paramtypes",[router_1.Router])],AdministrationMenuRouteItem)}();exports.AdministrationMenuRouteItem=AdministrationMenuRouteItem;var AdministrationConfigurator=function(){function AdministrationConfigurator(e,s,t){this.metadata=e,this.administrationconfigurator=s,this.language=t,this.componentconfig={},this.displayFilters=!1,this.filters={}}return AdministrationConfigurator.prototype.ngOnInit=function(){this.administrationconfigurator.dictionary=this.componentconfig.dictionary,this.administrationconfigurator.loadEntries(this.componentconfig.fields)},Object.defineProperty(AdministrationConfigurator.prototype,"count",{get:function(){return this.administrationconfigurator.entries.length},enumerable:!1,configurable:!0}),AdministrationConfigurator.prototype.trackByFn=function(e,s){return s.id},AdministrationConfigurator.prototype.getEntries=function(){for(var e=[],s=0,t=this.administrationconfigurator.entries;s<t.length;s++){var i=t[s],l=!1;if(this.displayFilters)for(var a in this.filters)!this.administrationconfigurator.isEditMode(i.id)&&this.filters[a]&&i.data[a]&&-1==i.data[a].toUpperCase().indexOf(this.filters[a].toUpperCase())&&(l=!0);l||e.push(i)}return e},AdministrationConfigurator.prototype.getFields=function(){for(var e=[],s=0,t=this.componentconfig.fields;s<t.length;s++){var i=t[s];!0!==i.hidden&&e.push(i)}return e},AdministrationConfigurator.prototype.addEntry=function(){this.administrationconfigurator.addEntry()},AdministrationConfigurator.prototype.sort=function(e){this.administrationconfigurator.sort(e)},AdministrationConfigurator.prototype.toggleFilter=function(){this.displayFilters=!this.displayFilters},AdministrationConfigurator.prototype.clearFilter=function(){this.filters={}},__decorate([core_1.Component({selector:"administration-configurator",template:'<div class="slds-grid slds-grid--align-spread slds-p-around--medium"><h2 class="slds-text-heading--medium"><system-label label="LBL_DICTIONARY_ITEM"></system-label>: {{componentconfig.dictionary}} ({{count}} <system-label label="LBL_RECORDS"></system-label>)</h2><button class="slds-button slds-button--neutral" (click)="addEntry()"><system-label label="LBL_ADD"></system-label></button></div><table class="slds-table slds-table--bordered slds-table--cell-buffer"><thead><tr class="slds-text-title--caps"><th *ngFor="let field of getFields()" scope="col" (click)="sort(field.name)"><div class="slds-truncate slds-p-horizontal--small">{{field.name}}<ng-container *ngIf="administrationconfigurator.sorting.field == field.name"><system-utility-icon *ngIf="administrationconfigurator.sorting.direction == \'asc\'" [icon]="\'arrowup\'" [size]="\'x-small\'"></system-utility-icon><system-utility-icon *ngIf="administrationconfigurator.sorting.direction == \'dsc\'" [icon]="\'arrowdown\'" [size]="\'x-small\'"></system-utility-icon></ng-container></div></th><th scope="col" style="width:2rem;"><div class="slds-button-group slds-float--right" role="group"><button class="slds-button slds-button--icon-border" (click)="toggleFilter()"><system-button-icon [icon]="\'filterList\'" [size]="\'small\'"></system-button-icon></button></div></th></tr><tr *ngIf="displayFilters" class="slds-theme--shade"><td *ngFor="let field of getFields()"><div class="slds-form-element"><div class="slds-form-element__control"><input type="text" class="slds-input" [(ngModel)]="filters[field.name]"></div></div></td><td><div class="slds-button-group slds-float--right" role="group"><button class="slds-button slds-button--icon-border" (click)="clearFilter()"><system-button-icon [icon]="\'clear\'" [size]="\'small\'"></system-button-icon></button> <button class="slds-button slds-button--icon-border" (click)="toggleFilter()"><system-button-icon [icon]="\'chevronup\'" [size]="\'small\'"></system-button-icon></button></div></td></tr></thead><tbody><tr style="vertical-align: middle" class="slds-align-top" administration-configurator-item *ngFor="let entry of getEntries(); trackBy: trackByFn" [entry]="entry" [fields]="getFields()"></tr></tbody></table>',providers:[administrationconfigurator]}),__metadata("design:paramtypes",[services_1.metadata,administrationconfigurator,services_1.language])],AdministrationConfigurator)}();exports.AdministrationConfigurator=AdministrationConfigurator;var AdministrationConfiguratorItem=function(){function e(e){this.administrationconfigurator=e,this.fields=[],this.entry={}}return e.prototype.ngOnInit=function(){},e.prototype.setEditMode=function(){this.administrationconfigurator.setEditMode(this.entry.id)},e.prototype.isEditMode=function(e){return(!(e=void 0===e?null:e)||!e.readonly)&&this.administrationconfigurator.isEditMode(this.entry.id)},e.prototype.setViewMode=function(){this.administrationconfigurator.cancelEditMode(this.entry.id)},e.prototype.save=function(){this.administrationconfigurator.saveEntry(this.entry.id)},e.prototype.delete=function(){this.administrationconfigurator.deleteEntry(this.entry.id)},e.prototype.copy=function(e){this.administrationconfigurator.copy(e)},e.prototype.getJSON=function(s){try{var e=JSON.parse(s);return JSON.stringify(e,null,2)}catch(e){return s}},__decorate([core_1.Input(),__metadata("design:type",Array)],e.prototype,"fields",void 0),__decorate([core_1.Input(),__metadata("design:type",Object)],e.prototype,"entry",void 0),__decorate([core_1.Component({selector:"[administration-configurator-item]",template:'<td *ngFor="let field of fields"><div *ngIf="!isEditMode(field);else editfield" class="slds-truncate slds-p-horizontal--small" style="max-width: 200px;" [ngSwitch]="field.type"><span *ngSwitchCase="\'json\'"><pre class="slds-m-vertical--none">{{getJSON(entry.data[field.name])}}</pre></span> <span *ngSwitchCase="\'text\'" class="slds-truncate_container_25" style="max-width: 200px;">{{entry.data[field.name]}}</span><system-checkbox *ngSwitchCase="\'bool\'" [disabled]="true" [(ngModel)]="entry.data[field.name]"></system-checkbox><system-checkbox *ngSwitchCase="\'boolean\'" [disabled]="true" [(ngModel)]="entry.data[field.name]"></system-checkbox><administration-configurator-item-role *ngSwitchCase="\'role\'" [editmode]="false" [fieldvalue]="entry.data[field.name]"></administration-configurator-item-role><span *ngSwitchDefault>{{entry.data[field.name]}}</span></div><ng-template #editfield><div class="slds-form-element"><div class="slds-form-element__control" [ngSwitch]="field.type"><textarea *ngSwitchCase="\'json\'" class="slds-textarea slds-scrollable--y slds-m-vertical--xx-small" [(ngModel)]="entry.data[field.name]"></textarea> <textarea *ngSwitchCase="\'text\'" class="slds-textarea slds-scrollable--y slds-m-vertical--xx-small" [(ngModel)]="entry.data[field.name]"></textarea><system-input-label *ngSwitchCase="\'label\'" [(ngModel)]="entry.data[field.name]"></system-input-label><system-checkbox *ngSwitchCase="\'bool\'" class="slds-m-horizontal--small" style="display: block" [(ngModel)]="entry.data[field.name]"></system-checkbox><system-checkbox *ngSwitchCase="\'boolean\'" class="slds-m-horizontal--small" style="display: block" [(ngModel)]="entry.data[field.name]"></system-checkbox><administration-configurator-item-role *ngSwitchCase="\'role\'" [editmode]="true" [(fieldvalue)]="entry.data[field.name]"></administration-configurator-item-role><input *ngSwitchDefault type="text" class="slds-input" [(ngModel)]="entry.data[field.name]"></div></div></ng-template></td><td><div *ngIf="!isEditMode()" class="slds-button-group slds-float--right" role="group"><button class="slds-button slds-button--icon-border" (click)="setEditMode()"><system-button-icon [icon]="\'edit\'" [size]="\'small\'"></system-button-icon></button> <button class="slds-button slds-button--icon-border" (click)="copy(entry.id)"><system-button-icon [icon]="\'copy\'" [size]="\'small\'"></system-button-icon></button> <button class="slds-button slds-button--icon-border" (click)="delete()"><system-button-icon [icon]="\'delete\'" [size]="\'small\'"></system-button-icon></button></div><div *ngIf="isEditMode()" class="slds-button-group slds-float--right" role="group"><button class="slds-button slds-button--icon-border" (click)="setViewMode()"><system-button-icon [icon]="\'close\'" [size]="\'small\'"></system-button-icon></button> <button class="slds-button slds-button--icon-border" (click)="save()"><system-button-icon [icon]="\'check\'" [size]="\'small\'"></system-button-icon></button></div></td>'}),__metadata("design:paramtypes",[administrationconfigurator])],e)}();exports.AdministrationConfiguratorItem=AdministrationConfiguratorItem;var AdministrationConfiguratorItemRole=function(){function e(e){this.metadata=e,this.editmode=!1,this.fieldvalue={},this.fieldvalueChange=new core_1.EventEmitter,this.roles=[]}return e.prototype.loadRoles=function(){var e=this.metadata.getRoles();e.sort(function(e,s){return e.name>s.name?1:-1});for(var s=0,t=e;s<t.length;s++){var i=t[s];this.roles.push(i)}},e.prototype.ngOnInit=function(){!this.editmode&&"*"==this.fieldvalue||this.loadRoles()},Object.defineProperty(e.prototype,"roleValue",{get:function(){return this.fieldvalue},set:function(e){this.fieldvalue=e,this.fieldvalueChange.emit(e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rolename",{get:function(){for(var e=0,s=this.roles;e<s.length;e++){var t=s[e];if(t.id==this.fieldvalue)return t.name}return this.fieldvalue},enumerable:!1,configurable:!0}),__decorate([core_1.Input(),__metadata("design:type",Boolean)],e.prototype,"editmode",void 0),__decorate([core_1.Input(),__metadata("design:type",Object)],e.prototype,"fieldvalue",void 0),__decorate([core_1.Output(),__metadata("design:type",core_1.EventEmitter)],e.prototype,"fieldvalueChange",void 0),__decorate([core_1.Component({selector:"administration-configurator-item-role",template:'<div *ngIf="!editmode"><div class="slds-truncate">{{rolename}}</div></div><div *ngIf="editmode" class="slds-form-element"><div class="slds-form-element__control"><div class="slds-select_container slds-m-vertical--xx-small"><select class="slds-select" [(ngModel)]="roleValue"><option value="*">*</option><option *ngFor="let role of roles" [value]="role.id">{{role.name}}</option></select></div></div></div>'}),__metadata("design:paramtypes",[services_1.metadata])],e)}();exports.AdministrationConfiguratorItemRole=AdministrationConfiguratorItemRole;var AdministrationQuotaManager=function(){function AdministrationQuotaManager(e){this.backend=e,this.users=[],this.monthlyQuotas={},this.quotas=[],this.yearlyQuotas={},this.year=(new Date).getFullYear(),this.monthNamesList=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],this.yearsList=[]}return AdministrationQuotaManager.prototype.ngOnInit=function(){this.getYears(),this.getQuotaUsers()},AdministrationQuotaManager.prototype.getYears=function(){for(var e=(new Date).getFullYear(),s=e-2;s<e+7;s++)this.yearsList.push(s)},AdministrationQuotaManager.prototype.getQuotaUsers=function(){var l=this;this.backend.getRequest("module/QuotaManager/users").subscribe(function(e){for(var s=0,t=e;s<t.length;s++){var i=t[s];l.users.push({id:i.id,mode:"",data:i}),0}l.getQuotas().subscribe()})},AdministrationQuotaManager.prototype.getQuotas=function(){var d=this,r=new rxjs_1.Subject;return this.backend.getRequest("module/QuotaManager/quotas/"+this.year).subscribe(function(e){d.quotas=e,d.monthlyQuotas={},d.yearlyQuotas={};for(var s=0,t=e;s<t.length;s++){var i=t[s],l=i.assigned_user_id,a=Math.round(i.sales_quota),i=i.period-1;d.monthlyQuotas[l]||(d.monthlyQuotas[l]=new Array(12)),d.monthlyQuotas[l][i]=a,d.yearlyQuotas[l]||(d.yearlyQuotas[l]=0),d.yearlyQuotas[l]+=a}r.next(d.users),r.complete();for(var o=0,n=d.users;o<n.length;o++){l=n[o].data.id;d.monthlyQuotas[l]||(d.monthlyQuotas[l]=new Array(12)),d.yearlyQuotas[l]||(d.yearlyQuotas[l]=0)}}),r.asObservable()},AdministrationQuotaManager.prototype.updateQuota=function(e,s,t){var i=e.target.value?+e.target.value:0,e=(e=this.monthlyQuotas[s][t])||0;this.yearlyQuotas[s]-=e-i,0<i?(this.monthlyQuotas[s][t]=i,this.backend.postRequest("module/QuotaManager/quota/"+s+"/"+this.year+"/"+(t+1)+"/"+i)):(delete this.monthlyQuotas[s][t],this.backend.deleteRequest("module/QuotaManager/quota/"+s+"/"+this.year+"/"+(t+1)))},__decorate([core_1.Component({selector:"administration-quotamanager",template:'<div class="slds-page-header"><div class="slds-grid slds-grid_vertical-align-center slds-grid--align-spread"><div class="slds-media"><div class="slds-media__body"><h1 class="slds-page-header__title slds-truncate slds-align-middle">Quota Manager</h1></div></div><div class="slds-p-top--small"><label for="year-select">Year</label><select id="year-select" [(ngModel)]="year" (change)="getQuotas()"><option *ngFor="let aYear of yearsList">{{aYear}}</option></select></div></div></div><div class="slds-scrollable--x"><table class="slds-table slds-table_bordered slds-table_cell-buffer"><thead><tr class="slds-text-title_caps"><th scope="col">Name</th><th scope="col">Total</th><th scope="col" *ngFor="let monthName of monthNamesList">{{monthName}}</th></tr></thead><tbody><tr *ngFor="let quotaUser of users" class="slds-text-title_caps"><td>{{quotaUser.data.last_name}} {{quotaUser.data.first_name}} ({{quotaUser.data.user_name}})</td><td>{{yearlyQuotas[quotaUser.data.id]}}</td><td *ngFor="let quota of monthlyQuotas[quotaUser.data.id]; let monthIndex = index"><administration-quotamanager-field [userid]="quotaUser.data.id" [data]="quotas" [monthindex]="monthIndex" [year]="year"></administration-quotamanager-field></td></tr></tbody></table></div>'}),__metadata("design:paramtypes",[services_1.backend])],AdministrationQuotaManager)}();exports.AdministrationQuotaManager=AdministrationQuotaManager;var AdministrationQuotaManagerField=function(){function e(e){this.backend=e,this.userid="",this.monthindex=0,this.year=0,this.data=[]}return Object.defineProperty(e.prototype,"value",{get:function(){for(var e=0,s=this.data;e<s.length;e++){var t=s[e];if(t&&t.assigned_user_id===this.userid&&t.period===""+(this.monthindex+1))return""+Math.round(t.sales_quota)}return""},set:function(e){for(var s=0,t=+e,i=0,l=this.data;i<l.length;i++){var a=l[i];a&&a.assigned_user_id===this.userid&&a.period===""+(this.monthindex+1)&&(0<t?this.data[s].sales_quota=e:delete this.data[s]),s++}0<t?this.backend.postRequest("module/QuotaManager/quota/"+this.userid+"/"+this.year+"/"+(this.monthindex+1)+"/"+e).subscribe(function(e){}):this.backend.deleteRequest("module/QuotaManager/quota/"+this.userid+"/"+this.year+"/"+(this.monthindex+1))},enumerable:!1,configurable:!0}),e.prototype.changeValue=function(e){},__decorate([core_1.Input(),__metadata("design:type",String)],e.prototype,"userid",void 0),__decorate([core_1.Input(),__metadata("design:type",Number)],e.prototype,"monthindex",void 0),__decorate([core_1.Input(),__metadata("design:type",Number)],e.prototype,"year",void 0),__decorate([core_1.Input(),__metadata("design:type",Array)],e.prototype,"data",void 0),__decorate([core_1.Component({selector:"administration-quotamanager-field",template:'<input style="width:80px;" [(ngModel)]="value" (ngModelChange)="changeValue($event)">'}),__metadata("design:paramtypes",[services_1.backend])],e)}();exports.AdministrationQuotaManagerField=AdministrationQuotaManagerField;var AdministrationFTSStatus=function(){function AdministrationFTSStatus(e,s,t,i,l,a,o){this.metadata=e,this.language=s,this.modal=t,this.backend=i,this.helper=l,this.toast=a,this.injector=o,this.version={},this.stats={docs:0,size:0},this.loading=!1,this.indices=[],this.loadstatus()}return AdministrationFTSStatus.prototype.loadstatus=function(){var l=this;this.loading=!0,this.indices=[],this.backend.getRequest("admin/elastic/status").subscribe(function(e){var s,t,i;for(i in l.version=e.version,l.stats.docs=0,l.stats.size=0,null!==(s=e.stats)&&void 0!==s&&s._all&&(e.stats._all.total.docs&&e.stats._all.total.docs.count&&(l.stats.docs=e.stats._all.total.docs.count),null!==(s=e.stats._all.total)&&void 0!==s&&s.store&&e.stats._all.total.store.size_in_bytes&&(l.stats.size=l.helper.humanFileSize(e.stats._all.total.store.size_in_bytes))),e.stats.indices)l.indices.push({name:i,docs:e.stats.indices[i].total.docs.count,size:l.helper.humanFileSize(e.stats.indices[i].total.store.size_in_bytes),blocked:!!(e.settings&&e.settings[i]&&null!==(t=e.settings[i].settings.index.blocks)&&void 0!==t&&t.read_only_allow_delete)});l.indices.sort(function(e,s){return e.name>s.name?1:-1}),l.loading=!1},function(e){l.loading=!1,l.toast.sendToast("Error loading Status","error")})},AdministrationFTSStatus.prototype.unlock=function(){var s=this;this.backend.putRequest("admin/elastic/unblock").subscribe(function(e){console.log(e),s.loadstatus()})},Object.defineProperty(AdministrationFTSStatus.prototype,"hasLocks",{get:function(){return!!this.indices.find(function(e){return e.blocked})},enumerable:!1,configurable:!0}),__decorate([core_1.Component({selector:"[administration-ftsstatus]",template:'<div class="slds-grid slds-grid_vertical-align-center slds-grid--align-spread slds-p-around--small"><h2 class="slds-text-heading_medium"><system-label label="LBL_FTS_STATUS"></system-label></h2><button class="slds-button slds-col--bump-left slds-button_icon slds-button_icon-border-filled" [disabled]="loading || ! hasLocks" (click)="unlock()"><system-button-icon icon="unlock"></system-button-icon></button> <button class="slds-button slds-button_icon slds-button_icon-border-filled" [disabled]="loading" (click)="loadstatus()"><system-button-icon icon="refresh"></system-button-icon></button></div><div [system-overlay-loading-spinner]="loading" system-to-bottom-noscroll><div *ngIf="!loading"><table class="slds-table slds-table_bordered slds-table_cell-buffer slds-m-bottom--medium"><thead><tr class="slds-text-title_caps"><th scope="col"><system-label label="LBL_ATTRIBUTE"></system-label></th><th scope="col"><system-label label="LBL_VALUE"></system-label></th></tr></thead><tbody><tr><td><system-label label="LBL_VERSION"></system-label></td><td><div class="slds-truncate">{{version?.version?.number}}</div></td></tr><tr><td><system-label label="LBL_DOCS"></system-label></td><td><div class="slds-truncate">{{stats.docs}}</div></td></tr><tr><td><system-label label="LBL_SIZE"></system-label></td><td><div class="slds-truncate">{{stats.size}}</div></td></tr></tbody></table><h2 class="slds-p-around--small">Index Details</h2><div class="slds-border--top" system-to-bottom><table class="slds-table slds-table_bordered slds-table_cell-buffer slds-table--header-fixed"><thead><tr class="slds-text-title_caps"><th scope="col"><div class="slds-truncate"><system-label label="LBL_INDEX"></system-label></div></th><th scope="col"><div class="slds-truncate"><system-label label="LBL_DOCS"></system-label></div></th><th scope="col"><div class="slds-truncate"><system-label label="LBL_SIZE"></system-label></div></th><th scope="col"><div class="slds-truncate"><system-label label="LBL_BLOCKED"></system-label></div></th></tr></thead><tbody><tr *ngFor="let index of indices"><td><div class="slds-truncate">{{index.name}}</div></td><td><div class="slds-truncate">{{index.docs}}</div></td><td><div class="slds-truncate">{{index.size}}</div></td><td><system-utility-icon *ngIf="index.blocked" icon="lock" size="x-small" colorclass="slds-icon-text-error"></system-utility-icon><system-utility-icon *ngIf="!index.blocked" icon="unlock" size="x-small" colorclass="slds-icon-text-success"></system-utility-icon></td></tr></tbody></table></div></div></div>'}),__metadata("design:paramtypes",[services_1.metadata,services_1.language,services_1.modal,services_1.backend,services_1.helper,services_1.toast,core_1.Injector])],AdministrationFTSStatus)}();exports.AdministrationFTSStatus=AdministrationFTSStatus;var AdministrationFTSManager=function(){function AdministrationFTSManager(e,s,t,i,l){this.metadata=e,this.language=s,this.modal=t,this.ftsconfiguration=i,this.injector=l,this.activeTab="fields"}return Object.defineProperty(AdministrationFTSManager.prototype,"modules",{get:function(){return this.ftsconfiguration.modules.sort()},enumerable:!1,configurable:!0}),Object.defineProperty(AdministrationFTSManager.prototype,"module",{get:function(){return this.ftsconfiguration.module},set:function(e){this.ftsconfiguration.setModule(e)},enumerable:!1,configurable:!0}),AdministrationFTSManager.prototype.add=function(){var s=this;this.modal.openModal("AdministrationFTSManagerModuleAdd",!0,this.injector).subscribe(function(e){e.instance.module$.subscribe(function(e){e&&(s.module=e)})})},AdministrationFTSManager.prototype.delete=function(){var s=this;this.modal.confirmDeleteRecord().subscribe(function(e){e&&(s.ftsconfiguration.deleteModule(s.module),s.module="")})},AdministrationFTSManager.prototype.setActiveTab=function(e){this.activeTab=e},AdministrationFTSManager.prototype.save=function(){this.ftsconfiguration.save()},AdministrationFTSManager.prototype.indexModule=function(){var s=this;this.modal.openModal("AdministrationFtsManagerIndexModal").subscribe(function(e){e.instance.response.subscribe(function(e){e&&s.ftsconfiguration.executeAction("bulk",e)})})},AdministrationFTSManager.prototype.resetModule=function(){this.ftsconfiguration.executeAction("reset")},AdministrationFTSManager.prototype.initialize=function(){var s=this;this.modal.confirm("Are you sure you want to initialize your FTS? It recreates new indices, so indexed data will be lost and have to be rebuild!","Initialize").subscribe(function(e){e&&s.ftsconfiguration.executeAction("init")})},__decorate([core_1.Component({selector:"[administration-ftsmanager]",template:'<div class="slds-grid slds-form--inline slds-p-around--small slds-border--bottom"><div class="slds-form-element"><label class="slds-form-element__label"><system-label label="LBL_MODULE"></system-label></label><div class="slds-form-element__control"><div class="slds-select_container"><select class="slds-select" [(ngModel)]="module" [disabled]="modules.length == 0"><option></option><option *ngFor="let module of modules" [value]="module">{{module}}</option></select></div></div></div><div class="slds-button-group" role="group"><button type="button" class="slds-button slds-button--neutral" (click)="add()"><system-label label="LBL_ADD"></system-label></button> <button type="button" [disabled]="!module" class="slds-button slds-button--neutral" (click)="delete()"><system-label label="LBL_DELETE"></system-label></button></div><div class="slds-form-element slds-col--bump-left"><button type="button" class="slds-button slds-button--neutral" (click)="initialize()"><system-label label="LBL_INITIALIZE"></system-label></button><div class="slds-button-group" role="group" *ngIf="!ftsconfiguration.indexing"><button type="button" class="slds-button slds-button--neutral" [disabled]="!module" (click)="save()"><system-label label="LBL_SAVE"></system-label></button> <button type="button" class="slds-button slds-button--neutral" [disabled]="!module" (click)="resetModule()"><system-label label="LBL_RESET"></system-label></button> <button type="button" class="slds-button slds-button--neutral" [disabled]="!module" (click)="indexModule()"><system-label label="LBL_INDEX"></system-label></button></div></div></div><div class="slds-tabs--default slds-p-top--xx-small"><div *ngIf="module; else selectmodule"><ul class="slds-tabs--default__nav" role="tablist"><li class="slds-tabs--default__item slds-text-title--caps" [ngClass]="{\'slds-active\': activeTab === \'fields\'}" role="presentation" (click)="setActiveTab(\'fields\')"><a class="slds-tabs--default__link" href="javascript:void(0);" role="tab" aria-selected="false"><system-label label="LBL_FIELDS"></system-label></a></li><li class="slds-tabs--default__item slds-text-title--caps" [ngClass]="{\'slds-active\': activeTab === \'details\'}" role="presentation" (click)="setActiveTab(\'details\')"><a class="slds-tabs--default__link" href="javascript:void(0);" role="tab" aria-selected="false"><system-label label="LBL_INDEX_PARAMETERS"></system-label></a></li></ul><administration-ftsmanager-fields *ngIf="activeTab===\'fields\'"></administration-ftsmanager-fields><administration-ftsmanager-details *ngIf="activeTab===\'details\'"></administration-ftsmanager-details></div><ng-template #selectmodule><div class="slds-p-around--small slds-align--absolute-center" system-to-bottom><system-label label="LBL_SELECT_A_MODULE"></system-label></div></ng-template></div>',providers:[ftsconfiguration]}),__metadata("design:paramtypes",[services_1.metadata,services_1.language,services_1.modal,ftsconfiguration,core_1.Injector])],AdministrationFTSManager)}();exports.AdministrationFTSManager=AdministrationFTSManager;var AdministrationFTSManagerFields=function(){function e(e,s,t,i,l){var a=this;this.metadata=e,this.language=s,this.modal=t,this.injector=i,this.ftsconfiguration=l,this.currentfield="",this.fieldDetails={},this.displayAddFieldModal=!1,this.ftsconfiguration.module$.subscribe(function(e){a.currentfield=""})}return Object.defineProperty(e.prototype,"moduleFtsFields",{get:function(){return this.ftsconfiguration.moduleFtsFields},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"aggregateaddparams",{get:function(){return this.fieldDetails.aggregateaddparams?atob(this.fieldDetails.aggregateaddparams):""},set:function(e){this.fieldDetails.aggregateaddparams=e?btoa(e):""},enumerable:!1,configurable:!0}),e.prototype.selectField=function(e){this.currentfield=e,this.fieldDetails=this.ftsconfiguration.getFieldDetails(e)},e.prototype.showAddFields=function(){this.modal.openModal("AdministrationFTSManagerFieldsAdd",!0,this.injector)},e.prototype.closeAddFields=function(e){this.displayAddFieldModal=!1},__decorate([core_1.Component({selector:"administration-ftsmanager-fields",template:'<div class="slds-grid"><div class="slds-size--1-of-2 slds-grid slds-grid--vertical" system-to-bottom><div class="slds-grow slds-scrollable--y" style="height: 100%"><administration-ftsmanager-fields-list style="display: block; height: 100%" (selectListField)="selectField($event)" [selectedField]="currentfield"></administration-ftsmanager-fields-list></div><div class="slds-p-around--small slds-text-align--center"><button class="slds-button slds-button--neutral" (click)="showAddFields()"><system-label label="LBL_ADD_FIELD"></system-label></button></div></div><div class="slds-size--1-of-2 slds-border--left slds-p-left--x-small" system-to-bottom><div *ngIf="currentfield; else selectfield"><h2 class="slds-text-heading--small slds-p-vertical--x-small"><system-label label="LBL_FIELD_DETAILS"></system-label>: {{fieldDetails.displaypath}}->{{fieldDetails.fieldname}}</h2><fieldset class="slds-form-element slds-form-element_compound slds-p-vertical--x-small"><legend class="slds-form-element__legend slds-form-element__label"><system-label label="LBL_INDEX_PARAMETERS"></system-label></legend><div class="slds-form-element__control"><div class="slds-form-element"><label class="slds-form-element__label"><system-label label="LBL_INDEX_FIELD_NAME"></system-label></label><div class="slds-form-element__control"><input type="text" class="slds-input" [(ngModel)]="fieldDetails.indexfieldname"></div></div><div class="slds-form-element"><label class="slds-form-element__label"><system-label label="LBL_NAME"></system-label></label><system-input-label [(ngModel)]="fieldDetails.name"></system-input-label></div><div class="slds-form-element"><label class="slds-form-element__label"><system-label label="LBL_TYPE"></system-label></label><system-icon-help-text [helpText]="language.getLabel(\'HLP_FTS_DATATYPE\')"></system-icon-help-text><div class="slds-form-element__control"><div class="slds-select_container"><select class="slds-select" [(ngModel)]="fieldDetails.indextype"><option [ngValue]="null"></option><option value="text">text</option><option value="keyword">keyword</option><option value="date">date</option><option value="double">double</option></select></div></div></div></div><div class="slds-grid slds-grid_vertical-align-center slds-m-top--x-small"><div class="slds-form-element slds-size--1-of-2"><label class="slds-form-element__label"><system-label label="LBL_BOOST"></system-label></label><system-icon-help-text [helpText]="language.getLabel(\'HLP_FTS_BOOST\')"></system-icon-help-text><div class="slds-form-element__control"><input type="text" class="slds-input" [(ngModel)]="fieldDetails.boost"></div></div><div class="slds-form-element"><div class="slds-form-element__control"><system-checkbox [(ngModel)]="fieldDetails.enablesort"><system-label label="LBL_SORTABLE"></system-label><system-icon-help-text [helpText]="language.getLabel(\'HLP_FTS_ENABLE_SORT\')"></system-icon-help-text></system-checkbox></div></div><div class="slds-form-element"><div class="slds-form-element__control"><system-checkbox [(ngModel)]="fieldDetails.search"><system-label label="LBL_SEARCH"></system-label><system-icon-help-text [helpText]="language.getLabel(\'HLP_FTS_ENABLE_SEARCH\')"></system-icon-help-text></system-checkbox></div></div></div><div class="slds-grid slds-grid_vertical-align-center slds-m-top--x-small"><div class="slds-form-element slds-size--1-of-1"><label class="slds-form-element__label"><system-label label="LBL_FUNCTION"></system-label></label><system-icon-help-text [helpText]="language.getLabel(\'HLP_FTS_FIELD_FUNCTION\')"></system-icon-help-text><div class="slds-form-element__control"><system-input-backend-method [(ngModel)]="fieldDetails.function"></system-input-backend-method></div></div></div></fieldset><fieldset class="slds-form-element slds-form-element_compound slds-p-vertical--x-small slds-p-right--x-small"><legend class="slds-form-element__legend slds-form-element__label"><system-label label="LBL_AGGREGATE"></system-label></legend><div class="slds-form-element__control"><div class="slds-form-element"><label class="slds-form-element__label"><system-label label="LBL_AGGREGATE"></system-label></label><system-icon-help-text [helpText]="language.getLabel(\'HLP_FTS_AGGREGATE\')"></system-icon-help-text><div class="slds-form-element__control"><div class="slds-select_container"><select class="slds-select" [(ngModel)]="fieldDetails.aggregate"><option [ngValue]="null"></option><option value="term">Term</option><option value="range">Range</option><option value="datew">Date Week</option><option value="datem">Date Month</option><option value="dateq">Date Quarter</option><option value="datey">Date Year</option></select></div></div></div><div class="slds-form-element slds-p-vertical--x-small slds-grid"><div class="slds-form-element__control slds-size--1-of-3"><system-checkbox [disabled]="!fieldDetails.aggregate" [(ngModel)]="fieldDetails.aggregatecollapsed"><system-label label="LBL_COLLAPSED"></system-label></system-checkbox></div><div class="slds-form-element__control slds-size--1-of-3"><system-checkbox [disabled]="fieldDetails.aggregate != \'term\'" [(ngModel)]="fieldDetails.aggregateempty"><system-label label="LBL_AGGREGATEEMPTYVALUES"></system-label></system-checkbox></div><div class="slds-form-element__control slds-size--1-of-3"><system-checkbox [disabled]="fieldDetails.aggregate != \'term\'" [(ngModel)]="fieldDetails.aggregatesystem"><system-label label="LBL_SYSTEMAGGREGATE"></system-label></system-checkbox></div></div><div class="slds-form-element" *ngIf="fieldDetails.aggregate"><label class="slds-form-element__label"><system-label label="LBL_PARAMETERS"></system-label></label><system-icon-help-text [helpText]="language.getLabel(\'HLP_FTS_AGGREGATE_PARAMS\')"></system-icon-help-text><div class="slds-form-element__control"><textarea class="slds-textarea" [(ngModel)]="aggregateaddparams"></textarea></div></div><div class="slds-grid"><div class="slds-form-element slds-size--1-of-2"><label class="slds-form-element__label"><system-label label="LBL_AGGREGATE_SIZE"></system-label></label><system-icon-help-text [helpText]="language.getLabel(\'HLP_FTS_AGGREGATE_SIZE\')"></system-icon-help-text><div class="slds-form-element__control"><input type="text" class="slds-input" [(ngModel)]="fieldDetails.aggregatesize"></div></div><div class="slds-form-element slds-size--1-of-2"><label class="slds-form-element__label"><system-label label="LBL_AGGREGATE_PRIORITY"></system-label></label><div class="slds-form-element__control"><input type="text" class="slds-input" [(ngModel)]="fieldDetails.aggregatepriority"></div></div></div><div class="slds-grid"><div class="slds-form-element slds-size--1-of-2"><label class="slds-form-element__label"><system-label label="LBL_AGGREGATE_SORTBY"></system-label></label><system-icon-help-text [helpText]="language.getLabel(\'HLP_FTS_AGGREGATE_SORTBY\')"></system-icon-help-text><div class="slds-form-element__control"><div class="slds-select_container"><select class="slds-select" [(ngModel)]="fieldDetails.aggregatesortby"><option [ngValue]="null"></option><option value="_count">Count (default)</option><option value="_key">Key</option></select></div></div></div><div class="slds-form-element slds-size--1-of-2"><label class="slds-form-element__label"><system-label label="LBL_AGGREGATE_SORT"></system-label></label><system-icon-help-text [helpText]="language.getLabel(\'HLP_FTS_AGGREGATE_SORT\')"></system-icon-help-text><div class="slds-form-element__control"><select class="slds-select" [(ngModel)]="fieldDetails.aggregatesort"><option [ngValue]="null"></option><option value="asc">asc</option><option value="desc">desc (default)</option></select></div></div></div></div></fieldset><fieldset class="slds-form-element slds-form-element_compound slds-p-vertical--x-small"><legend class="slds-form-element__legend slds-form-element__label"><system-label label="LBL_ANALYZER"></system-label></legend><div class="slds-form-element__control"><div class="slds-grid"><div class="slds-form-element slds-size--1-of-2"><label class="slds-form-element__label"><system-label label="LBL_ANALYZER"></system-label></label><system-icon-help-text [helpText]="language.getLabel(\'HLP_FTS_ANALYZER\') + \'\\n\' + language.getLabel(\'HLP_FTS_ANALYZER_STANDARD\') + \'\\n\' + language.getLabel(\'HLP_FTS_ANALYZER_NGRAM\') + \'\\n\' + language.getLabel(\'HLP_FTS_ANALYZER_HTML\') + \'\\n\' + language.getLabel(\'HLP_FTS_ANALYZER_EDGENGRAM\') + \'\\n\' + language.getLabel(\'HLP_FTS_ANALYZER_EMAIL\')"></system-icon-help-text><div class="slds-form-element__control"><div class="slds-select_container"><select class="slds-select" [(ngModel)]="fieldDetails.analyzer"><option>standard</option><option *ngFor="let analyzer of ftsconfiguration.analyzers" [value]="analyzer.value">{{analyzer.text}}</option></select></div></div></div><div class="slds-form-element slds-size--1-of-2"><label class="slds-form-element__label"><system-label label="LBL_SEARCH_ANALYZER"></system-label></label><system-icon-help-text [helpText]="language.getLabel(\'HLP_FTS_SEARCHANALYZER\') + \'\\n\' + language.getLabel(\'HLP_FTS_ANALYZER_STANDARD\') + \'\\n\' + language.getLabel(\'HLP_FTS_ANALYZER_NGRAM\') + \'\\n\' + language.getLabel(\'HLP_FTS_ANALYZER_HTML\') + \'\\n\' + language.getLabel(\'HLP_FTS_ANALYZER_EDGENGRAM\') + \'\\n\' + language.getLabel(\'HLP_FTS_ANALYZER_EMAIL\')"></system-icon-help-text><div class="slds-form-element__control"><div class="slds-select_container"><select class="slds-select" [(ngModel)]="fieldDetails.search_analyzer"><option>standard</option><option *ngFor="let analyzer of ftsconfiguration.analyzers" [value]="analyzer.value">{{analyzer.text}}</option></select></div></div></div></div></div></fieldset><fieldset class="slds-form-element slds-form-element_compound slds-p-vertical--x-small"><legend class="slds-form-element__legend slds-form-element__label"><system-label label="LBL_DUPLICATECHECK_SETTINGS"></system-label></legend><div class="slds-form-element__control"><div class="slds-form-element"><div class="slds-form-element__control"><system-checkbox [(ngModel)]="fieldDetails.duplicatecheck"><system-label label="LBL_DUPLICATE_CHECK"></system-label><system-icon-help-text [helpText]="language.getLabel(\'HLP_FTS_DUPLICATE_CHECK\')"></system-icon-help-text></system-checkbox></div></div><div class="slds-grid slds-grid_vertical-align-center"><div class="slds-col slds-size--1-of-2 slds-form-element"><label class="slds-form-element__label"><system-label label="LBL_QUERY"></system-label></label><system-icon-help-text [helpText]="language.getLabel(\'HLP_FTS_DUPLICATE_QUERY\')"></system-icon-help-text><div class="slds-form-element__control"><div class="slds-select_container"><select [disabled]="!fieldDetails.duplicatecheck" class="slds-select" [(ngModel)]="fieldDetails.duplicatequery"><option>match (or)</option><option value="match_and">match (and)</option><option value="term">term</option></select></div></div></div><div class="slds-col slds-size--1-of-2 slds-form-element"><label class="slds-form-element__label"><system-label label="LBL_FUZZINESS"></system-label></label><system-icon-help-text [helpText]="language.getLabel(\'HLP_FTS_DUPLICATE_FUZZINESS\')"></system-icon-help-text><div class="slds-form-element__control"><input type="text" [disabled]="!fieldDetails.duplicatecheck" class="slds-input" [(ngModel)]="fieldDetails.duplicatefuzz"></div></div></div></div></fieldset><fieldset class="slds-form-element slds-form-element_compound slds-p-vertical--x-small"><legend class="slds-form-element__legend slds-form-element__label"><system-label label="LBL_EMAIL_PHONE_SETTINGS"></system-label></legend><div class="slds-form-element__control slds-size--1-of-2"><system-checkbox [(ngModel)]="fieldDetails.email"><system-label label="LBL_EMAIL_SEARCH"></system-label><system-icon-help-text [helpText]="language.getLabel(\'HLP_FTS_ENABLE_EMAIL\')"></system-icon-help-text></system-checkbox></div><div class="slds-form-element__control slds-size--1-of-2"><system-checkbox [(ngModel)]="fieldDetails.phonesearch"><system-label label="LBL_PHONE_SEARCH"></system-label><system-icon-help-text [helpText]="language.getLabel(\'HLP_FTS_ENABLE_PHONE\')"></system-icon-help-text></system-checkbox></div></fieldset><fieldset class="slds-form-element slds-form-element_compound slds-p-vertical--x-small"><legend class="slds-form-element__legend slds-form-element__label"><system-label label="LBL_FTS_ACTIVITY_PARAMS"></system-label></legend><div class="slds-form-element__control"><div class="slds-form-element"><label class="slds-form-element__label"><system-label label="LBL_TYPE"></system-label></label><div class="slds-form-element__control"><div class="slds-select_container"><select class="slds-select" [(ngModel)]="fieldDetails.activitytype"><option>---</option><option value="activityparentid">activityparentid</option><option value="activitydate">activitydate</option><option value="activityenddate">activityenddate</option><option value="activityparticipant">activityparticipant</option><option value="activitystatus">activitystatus</option></select></div></div></div></div></fieldset></div><ng-template #selectfield><div class="slds-p-around--small slds-align--absolute-center slds-height_full">select a field</div></ng-template></div></div>'}),__metadata("design:paramtypes",[services_1.metadata,services_1.language,services_1.modal,core_1.Injector,ftsconfiguration])],e)}();exports.AdministrationFTSManagerFields=AdministrationFTSManagerFields;var AdministrationFTSManagerFieldsList=function(){function e(e,s,t,i,l,a){this.metadata=e,this.language=s,this.ftsconfiguration=t,this.backend=i,this.modal=l,this.modelutilities=a,this.links=[],this.self={},this.fields=[],this.nodePath="",this.selectedField="",this.selectListField=new core_1.EventEmitter}return e.prototype.ngAfterViewInit=function(){var e=this;window.setTimeout(function(){return e.ftsconfiguration.fieldsDropList=e.dropList},100)},e.prototype.rightDrop=function(e){var s,t;this.removePlaceHolderElement(e.previousContainer.element.nativeElement),e.previousContainer===e.container?drag_drop_1.moveItemInArray(e.container.data,e.previousIndex,e.currentIndex):(t=e.item.data,t={id:s=this.modelutilities.generateGuid(),fieldid:s,fieldname:t.name,indexfieldname:t.name,name:t.label,path:this.nodePath+"::"+t.id},this.ftsconfiguration.moduleFtsFields.splice(e.currentIndex,0,t))},e.prototype.removePlaceHolderElement=function(e){this.dragPlaceHolderNode&&(e.removeChild(this.dragPlaceHolderNode),this.dragPlaceHolderNode=void 0)},e.prototype.trackByFn=function(e,s){return s.id},e.prototype.deleteField=function(s){var t=this;this.modal.confirmDeleteRecord().subscribe(function(e){e&&t.ftsconfiguration.moduleFtsFields.splice(s,1)})},e.prototype.handleSelection=function(e){this.selectListField.emit(e)},e.prototype.isSelected=function(e){return this.selectedField==e},__decorate([core_1.Input(),__metadata("design:type",drag_drop_1.CdkDropList)],e.prototype,"dragList",void 0),__decorate([core_1.Input(),__metadata("design:type",Node)],e.prototype,"dragPlaceHolderNode",void 0),__decorate([core_1.Input(),__metadata("design:type",String)],e.prototype,"nodePath",void 0),__decorate([core_1.Input(),__metadata("design:type",String)],e.prototype,"selectedField",void 0),__decorate([core_1.Output(),__metadata("design:type",core_1.EventEmitter)],e.prototype,"selectListField",void 0),__decorate([core_1.ViewChild("dropList",{static:!1}),__metadata("design:type",Object)],e.prototype,"dropList",void 0),__decorate([core_1.Component({selector:"administration-ftsmanager-fields-list",template:'<div cdkDropList #dropList="cdkDropList" [cdkDropListData]="ftsconfiguration.moduleFtsFields" [cdkDropListConnectedTo]="[dragList]" (cdkDropListDropped)="rightDrop($event)" class="slds-size--1-of-1 slds-border--left" style="height: 100%"><table class="slds-table slds-table--cell-buffer spice-table_header-fixed slds-table--fixed-layout"><thead><tr class="slds-text-title--caps slds-theme--shade"><th class="slds-cell-shrink"></th><th><div class="slds-truncate"><system-label label="LBL_PATH"></system-label></div></th><th scope="col"><div class="slds-truncate"><system-label label="LBL_FIELD"></system-label></div></th><th scope="col"><div class="slds-truncate"><system-label label="LBL_NAME"></system-label></div></th><th class="slds-cell-shrink"></th></tr></thead><tbody><tr cdkDrag [cdkDragData]="field" *ngFor="let field of ftsconfiguration.moduleFtsFields; let i = index; trackBy: trackByFn" (click)="handleSelection(field.id)" [class.slds-theme--shade]="isSelected(field.id)" cdkDragBoundary="#administration-fts-manager-field-add-drop-table" class="slds-border--bottom slds-drag--preview"><td class="slds-p-around--none"><system-utility-icon class="slds-p-horizontal--x-small" cdkDragHandle style="cursor: move" icon="drag_and_drop" size="x-small"></system-utility-icon></td><td><div class="slds-truncate">{{field.path}}</div></td><td data-label="Account Name"><div class="slds-truncate">{{field.fieldname}}</div></td><td data-label="Account Name"><div class="slds-truncate"><system-label [label]="field.name"></system-label></div></td><td class="slds-cell-shrink"><button class="slds-button slds-button--icon" (click)="deleteField(i)"><system-button-icon icon="close"></system-button-icon></button></td></tr></tbody></table></div>'}),__metadata("design:paramtypes",[services_1.metadata,services_1.language,ftsconfiguration,services_1.backend,services_1.modal,services_1.modelutilities])],e)}();exports.AdministrationFTSManagerFieldsList=AdministrationFTSManagerFieldsList;var AdministrationFTSManagerDetails=function(){function e(e,s,t){this.metadata=e,this.language=s,this.ftsconfiguration=t}return __decorate([core_1.Component({selector:"administration-ftsmanager-details",template:'<div class="slds-p-top--x-small slds-p-horizontal--x-small" system-to-bottom><fieldset class="slds-form-element slds-form-element_compound slds-p-vertical--x-small"><legend class="slds-form-element__legend slds-form-element__label"><system-label label="LBL_INDEX_PARAMETERS"></system-label></legend><div class="slds-form-element__control"><div class="slds-form-element"><label class="slds-form-element__label"><system-label label="LBL_INDEX_PRIORITY"></system-label></label><div class="slds-form-element__control"><input type="text" class="slds-input" [(ngModel)]="ftsconfiguration.moduleFtsSettings.index_priority"></div></div><div class="slds-form-element"><label class="slds-form-element__label"><system-label label="LBL_FTS_MULTIMATCH_TYPE"></system-label></label><div class="slds-form-element__control"><div class="slds-select_container"><select class="slds-select" [(ngModel)]="ftsconfiguration.moduleFtsSettings.multimatch_type"><option>default</option><option value="best_fields">Best Fields</option><option value="most_fields">Most Fields</option><option value="phrase">Phrase</option><option value="phrase_prefix">Phrase Prefix</option><option value="cross_fields">Cross Fields</option></select></div></div></div><div class="slds-form-element slds-p-vertical--x-small"><system-checkbox [(ngModel)]="ftsconfiguration.moduleFtsSettings.waitfor"><system-label label="LBL_SYNCRONOUS"></system-label></system-checkbox></div></div></fieldset><fieldset class="slds-form-element slds-form-element_compound slds-p-vertical--x-small"><legend class="slds-form-element__legend slds-form-element__label"><system-label label="LBL_SEARCH_PARAMETERS"></system-label></legend><div class="slds-form-element__control"><div class="slds-grid"><div class="slds-form-element slds-size--1-of-2"><label class="slds-form-element__label"><system-label label="LBL_OPERATOR"></system-label></label><div class="slds-form-element__control"><div class="slds-select_container"><select class="slds-select" [(ngModel)]="ftsconfiguration.moduleFtsSettings.operator"><option value="and"><system-label label="LBL_AND"></system-label></option><option value="or"><system-label label="LBL_OR"></system-label></option></select></div></div></div><div class="slds-form-element slds-size--1-of-2"><label class="slds-form-element__label"><system-label label="LBL_SEARCH_ANALYZER"></system-label></label><system-icon-help-text [helpText]="language.getLabel(\'HLP_FTS_SEARCHANALYZER\') + \'\\n\' + language.getLabel(\'HLP_FTS_ANALYZER_STANDARD\') + \'\\n\' + language.getLabel(\'HLP_FTS_ANALYZER_NGRAM\') + \'\\n\' + language.getLabel(\'HLP_FTS_ANALYZER_HTML\') + \'\\n\' + language.getLabel(\'HLP_FTS_ANALYZER_EDGENGRAM\') + \'\\n\' + language.getLabel(\'HLP_FTS_ANALYZER_EMAIL\')"></system-icon-help-text><div class="slds-form-element__control"><div class="slds-select_container"><select class="slds-select" [(ngModel)]="ftsconfiguration.moduleFtsSettings.search_analyzer"><option>standard</option><option *ngFor="let analyzer of ftsconfiguration.analyzers" [value]="analyzer.value">{{analyzer.text}}</option></select></div></div></div></div><div class="slds-grid slds-p-vertical--x-small"><system-checkbox [(ngModel)]="ftsconfiguration.moduleFtsSettings.globalsearch"><system-label label="LBL_GLOBAL_SEARCH"></system-label></system-checkbox><system-checkbox [(ngModel)]="ftsconfiguration.moduleFtsSettings.emailsearch"><system-label label="LBL_EMAIL_SEARCH"></system-label></system-checkbox><system-checkbox [(ngModel)]="ftsconfiguration.moduleFtsSettings.phonesearch"><system-label label="LBL_PHONE_SEARCH"></system-label></system-checkbox></div></div></fieldset><fieldset class="slds-form-element slds-form-element_compound slds-p-vertical--x-small"><legend class="slds-form-element__legend slds-form-element__label"><system-label label="LBL_GEO_SEARCH_PARAMETERS"></system-label></legend><div class="slds-form-element__control"><system-checkbox [(ngModel)]="ftsconfiguration.moduleFtsSettings.geosearch"><system-label label="LBL_GEO_SEARCH"></system-label></system-checkbox></div><div class="slds-form-element__control slds-grid"><div class="slds-form-element slds-size--1-of-2"><label class="slds-form-element__label"><system-label label="LBL_LATITUDE"></system-label></label><system-input-module-field [disabled]="!ftsconfiguration.moduleFtsSettings.geosearch" [(ngModel)]="ftsconfiguration.moduleFtsSettings.geolat" [module]="ftsconfiguration.module"></system-input-module-field></div><div class="slds-form-element slds-size--1-of-2"><label class="slds-form-element__label"><system-label label="LBL_LONGITUDE"></system-label></label><system-input-module-field [disabled]="!ftsconfiguration.moduleFtsSettings.geosearch" [(ngModel)]="ftsconfiguration.moduleFtsSettings.geolng" [module]="ftsconfiguration.module"></system-input-module-field></div></div></fieldset><fieldset class="slds-form-element slds-form-element_compound slds-p-vertical--x-small"><legend class="slds-form-element__legend slds-form-element__label"><system-label label="LBL_FTS_ACTIVITY_PARAMS"></system-label></legend><div class="slds-form-element__control"><div class="slds-form-element slds-grid slds-grid--vertical-align-center slds-gutters_direct-small"><div class="slds-form-element__control slds-col slds-size--1-of-3"><system-checkbox [(ngModel)]="ftsconfiguration.moduleFtsSettings.activitiessearch"><system-label label="LBL_FTS_IN_ACTIVITIES"></system-label></system-checkbox></div><div class="slds-col slds-size--2-of-3 slds-grid slds-grid--vertical-align-center"><label class="slds-form-element__label"><system-label label="LBL_FILTER"></system-label></label><system-input-module-filter class="slds-grow" [(ngModel)]="ftsconfiguration.moduleFtsSettings.activitiesfilter"></system-input-module-filter></div></div><div class="slds-form-element slds-grid slds-grid--vertical-align-center slds-gutters_direct-small"><div class="slds-form-element__control slds-col slds-size--1-of-3"><system-checkbox [(ngModel)]="ftsconfiguration.moduleFtsSettings.historysearch"><system-label label="LBL_FTS_IN_HISTORY"></system-label></system-checkbox></div><div class="slds-col slds-size--2-of-3 slds-grid slds-grid--vertical-align-center"><label class="slds-form-element__label"><system-label label="LBL_FILTER"></system-label></label><system-input-module-filter class="slds-grow" [(ngModel)]="ftsconfiguration.moduleFtsSettings.historyfilter"></system-input-module-filter></div></div><div class="slds-form-element slds-grid slds-grid--vertical-align-center slds-gutters_direct-small"><div class="slds-form-element__control slds-col slds-size--1-of-3"><system-checkbox [(ngModel)]="ftsconfiguration.moduleFtsSettings.assistantsearch"><system-label label="LBL_FTS_IN_ASSISTANT"></system-label></system-checkbox></div><div class="slds-col slds-size--2-of-3 slds-grid slds-grid--vertical-align-center"><label class="slds-form-element__label"><system-label label="LBL_FILTER"></system-label></label><system-input-module-filter class="slds-grow" [(ngModel)]="ftsconfiguration.moduleFtsSettings.assistantfilter"></system-input-module-filter></div></div><div class="slds-form-element slds-grid slds-grid--vertical-align-center slds-gutters_direct-small"><div class="slds-form-element__control slds-col slds-size--1-of-3"><system-checkbox [(ngModel)]="ftsconfiguration.moduleFtsSettings.calendarsearch"><system-label label="LBL_FTS_IN_CALENDAR"></system-label></system-checkbox></div><div class="slds-col slds-size--2-of-3 slds-grid slds-grid--vertical-align-center"><label class="slds-form-element__label"><system-label label="LBL_FILTER"></system-label></label><system-input-module-filter class="slds-grow" [(ngModel)]="ftsconfiguration.moduleFtsSettings.calendarfilter"></system-input-module-filter></div></div></div></fieldset></div>'}),__metadata("design:paramtypes",[services_1.metadata,services_1.language,ftsconfiguration])],e)}();exports.AdministrationFTSManagerDetails=AdministrationFTSManagerDetails;var AdministrationFTSManagerModuleAdd=function(){function AdministrationFTSManagerModuleAdd(e,s,t){this.metadata=e,this.language=s,this.ftsconfiguration=t,this.modules=[],this.module="",this.module$=new core_1.EventEmitter}return AdministrationFTSManagerModuleAdd.prototype.ngOnInit=function(){for(var e=this.ftsconfiguration.modules,s=0,t=this.metadata.getModules();s<t.length;s++){var i=t[s];-1==e.indexOf(i)&&this.modules.push(i)}this.modules.sort()},AdministrationFTSManagerModuleAdd.prototype.add=function(){this.module$.emit(this.module),this.self.destroy()},AdministrationFTSManagerModuleAdd.prototype.close=function(){this.module$.emit(!1),this.self.destroy()},__decorate([core_1.Component({template:'<system-modal><system-modal-header (close)="close()"><system-label label="LBL_ADD_MODULE"></system-label></system-modal-header><system-modal-content><div class="slds-form-element"><label class="slds-form-element__label"><system-label label="LBL_MODULE"></system-label></label><div class="slds-form-element__control"><div class="slds-select_container"><select class="slds-select" [(ngModel)]="module"><option *ngFor="let newmodule of modules" [value]="newmodule">{{newmodule}} ({{language.getModuleName(newmodule)}})</option></select></div></div></div></system-modal-content><system-modal-footer><button class="slds-button slds-button--neutral" (click)="close()"><system-label label="LBL_CANCEL"></system-label></button> <button class="slds-button slds-button--brand" (click)="add()"><system-label label="LBL_ADD"></system-label></button></system-modal-footer></system-modal>'}),__metadata("design:paramtypes",[services_1.metadata,services_1.language,ftsconfiguration])],AdministrationFTSManagerModuleAdd)}();exports.AdministrationFTSManagerModuleAdd=AdministrationFTSManagerModuleAdd;var AdministrationFTSManagerFieldsAdd=function(){function AdministrationFTSManagerFieldsAdd(e,s,t,i){this.metadata=e,this.language=s,this.ftsconfiguration=t,this.backend=i,this.links=[],this.self={},this.fields=[],this.nodefields=[],this.path=[],this.nodePath=""}return Object.defineProperty(AdministrationFTSManagerFieldsAdd.prototype,"filteredNodeFields",{get:function(){var s=this;return this.filterKey?this.nodefields.filter(function(e){return e.name.toLowerCase().includes(s.filterKey.toLowerCase())||e.label&&e.label.toLowerCase().includes(s.filterKey.toLowerCase())}):this.nodefields},enumerable:!1,configurable:!0}),Object.defineProperty(AdministrationFTSManagerFieldsAdd.prototype,"fieldsDropList",{get:function(){return this.ftsconfiguration.fieldsDropList||""},enumerable:!1,configurable:!0}),AdministrationFTSManagerFieldsAdd.prototype.close=function(){this.self.destroy()},AdministrationFTSManagerFieldsAdd.prototype.itemSelected=function(e){var s=this;window.setTimeout(function(){return s.nodePath=e.path}),this.getModuleFields(e.module)},AdministrationFTSManagerFieldsAdd.prototype.getModuleFields=function(e){var s=this;this.nodefields=[],this.backend.getRequest("dictionary/browser/"+e+"/fields").subscribe(function(e){s.nodefields=e})},AdministrationFTSManagerFieldsAdd.prototype.dropExited=function(s){var e=document.createElement("tr"),t=document.createElement("td");t.colSpan=10,t.innerHTML="&nbsp;",t.style.background="#fff",e.appendChild(t),this.dragPlaceHolderNode=e;t=s.container.data.findIndex(function(e){return e.id==s.item.data.id});-1<t&&s.container.element.nativeElement.insertBefore(e,s.container.element.nativeElement.children[t])},AdministrationFTSManagerFieldsAdd.prototype.dropEntered=function(e){this.removePlaceHolderElement(e.container.element.nativeElement)},AdministrationFTSManagerFieldsAdd.prototype.removePlaceHolderElement=function(e){this.dragPlaceHolderNode&&(e.removeChild(this.dragPlaceHolderNode),this.dragPlaceHolderNode=void 0)},AdministrationFTSManagerFieldsAdd.prototype.trackByFn=function(e,s){return s.id},__decorate([core_1.Component({selector:"administration-ftsmanager-fields-add",template:'<system-modal size="large"><system-modal-header (close)="close()">Add Field</system-modal-header><system-modal-content margin="none" [grow]="true"><div class="slds-grid administration-fts-manager-field-add-modal" style="height: 100%"><div class="slds-size--1-of-3 slds-grid--vertical" style="height: 100%;"><div class="slds-scrollable--y slds-border--bottom" style="height: 50%;"><system-module-tree [module]="ftsconfiguration.module" (itemSelected)="itemSelected($event)"></system-module-tree></div><div class="slds-scrollable" style="height: 50%;"><div class="slds-combobox__form-element slds-input-has-icon slds-input-has-icon_left" role="none"><system-utility-icon icon="search" addclasses="slds-input__icon slds-input__icon--left"></system-utility-icon><input class="slds-input slds-combobox__input" type="search" [placeholder]="language.getLabel(\'LBL_SEARCH\')" [(ngModel)]="filterKey"></div><table class="slds-table slds-table_cell-buffer slds-table_bordered"><thead><tr class="slds-line-height_reset"><th class="slds-cell-shrink"></th><th scope="col"><div class="slds-truncate"><system-label label="LBL_FIELD"></system-label></div></th><th scope="col"><div class="slds-truncate"><system-label label="LBL_NAME"></system-label></div></th></tr></thead><tbody cdkDropList #dragList="cdkDropList" (cdkDropListExited)="dropExited($event)" (cdkDropListEntered)="dropEntered($event)" cdkDropListSortingDisabled [cdkDropListData]="nodefields" [cdkDropListConnectedTo]="[fieldsDropList]"><tr cdkDrag [cdkDragData]="nodefield" *ngFor="let nodefield of filteredNodeFields; trackBy: trackByFn" cdkDragBoundary=".administration-fts-manager-field-add-modal" class="slds-hint-parent slds-drag--preview"><td class="slds-p-around--none slds-cell-shrink"><system-utility-icon class="slds-p-horizontal--x-small" cdkDragHandle style="cursor: move" icon="drag_and_drop" size="x-small"></system-utility-icon></td><td data-label="Account Name"><div class="slds-truncate">{{nodefield.name}}</div></td><td><div class="slds-truncate"><system-label [label]="nodefield.label"></system-label></div></td></tr></tbody></table></div></div><div class="slds-size--2-of-3" style="height: 100%"><administration-ftsmanager-fields-list style="display: block; height: 100%" class="slds-scrollable--y" [dragPlaceHolderNode]="dragPlaceHolderNode" [nodePath]="nodePath" [dragList]="dragList"></administration-ftsmanager-fields-list></div></div></system-modal-content><system-modal-footer><button class="slds-button slds-button--brand" (click)="close()"><system-label label="LBL_OK"></system-label></button></system-modal-footer></system-modal>'}),__metadata("design:paramtypes",[services_1.metadata,services_1.language,ftsconfiguration,services_1.backend])],AdministrationFTSManagerFieldsAdd)}();exports.AdministrationFTSManagerFieldsAdd=AdministrationFTSManagerFieldsAdd;var AdministrationFTSStats=function(){function AdministrationFTSStats(e,s,t){var i=this;this.metadata=e,this.language=s,this.backend=t,this.stats={},this.indices=[],this.backend.getRequest("admin/elastic/stats").subscribe(function(e){for(var s in(i.stats=e).indices)i.indices.push({name:s,size:e.indices[s].total.store.size_in_bytes,documents:e.indices[s].total.docs.count});i.indices.sort(function(e,s){return e.name>s.name?1:-1})})}return __decorate([core_1.Component({template:'<h2 class="slds-text-heading_medium slds-p-around--small">FTS Stats</h2><table class="slds-table slds-table_bordered slds-table_cell-buffer"><thead><tr class="slds-text-title_caps"><th scope="col"><div class="slds-truncate">Name</div></th><th scope="col"><div class="slds-truncate">Size</div></th><th scope="col"><div class="slds-truncate">Documents</div></th></tr></thead><tbody><tr *ngFor="let index of indices"><td><div class="slds-truncate">{{index.name}}</div></td><td><div class="slds-truncate">{{index.size}}</div></td><td><div class="slds-truncate">{{index.documents}}</div></td></tr></tbody></table>'}),__metadata("design:paramtypes",[services_1.metadata,services_1.language,services_1.backend])],AdministrationFTSStats)}();exports.AdministrationFTSStats=AdministrationFTSStats;var AdministrationFtsManagerIndexModal=function(){function AdministrationFtsManagerIndexModal(e){this.language=e,this.settings={},this.self={},this.responseSubject=new rxjs_1.Subject,this.response=this.responseSubject.asObservable(),this.settings.bulkAmount=-1}return AdministrationFtsManagerIndexModal.prototype.cancel=function(){this.responseSubject.next(!1),this.responseSubject.complete(),this.self.destroy()},AdministrationFtsManagerIndexModal.prototype.start=function(){this.responseSubject.next(this.settings),this.responseSubject.complete(),this.self.destroy()},__decorate([core_1.Component({template:'<system-modal><system-modal-header (close)="cancel()"><system-label label="LBL_INDEX"></system-label></system-modal-header><system-modal-content><div class="slds-p-bottom--xx-small"><system-label label="LBL_RESET_INDEX_DATE" length="long"></system-label></div><div class="slds-m-bottom--medium"><system-checkbox [(ngModel)]="settings.resetIndexDates"><system-label label="LBL_RESET_INDEX_DATE"></system-label></system-checkbox></div><div class="slds-p-bottom--xx-small"><system-label label="LBL_BULK_INDEX"></system-label></div><div><system-input-radio style="display: block" name="ftsmanagerbulk" value="0" [ngModel]="settings.bulkAmount" (ngModelChange)="settings.bulkAmount = 0"><system-label label="LBL_NONE"></system-label></system-input-radio><system-input-radio style="display: block" name="ftsmanagerbulk" value="100" [ngModel]="settings.bulkAmount" (ngModelChange)="settings.bulkAmount = 100">100 <system-label label="LBL_RECORDS"></system-label></system-input-radio><system-input-radio style="display: block" name="ftsmanagerbulk" value="1000" [ngModel]="settings.bulkAmount" (ngModelChange)="settings.bulkAmount = 1000">1000 <system-label label="LBL_RECORDS"></system-label></system-input-radio><system-input-radio style="display: block" name="ftsmanagerbulk" value="-1" [ngModel]="settings.bulkAmount" (ngModelChange)="settings.bulkAmount = -1"><system-label label="LBL_SYSTEM_DEFAULT"></system-label></system-input-radio></div></system-modal-content><system-modal-footer><button type="button" class="slds-button slds-button--neutral" (click)="cancel()"><system-label label="LBL_CANCEL"></system-label></button> <button type="button" class="slds-button slds-button--brand" (click)="start()"><system-label label="LBL_START"></system-label></button></system-modal-footer></system-modal>'}),__metadata("design:paramtypes",[services_1.language])],AdministrationFtsManagerIndexModal)}();exports.AdministrationFtsManagerIndexModal=AdministrationFtsManagerIndexModal;var AdministrationHomeScreen=function(){function AdministrationHomeScreen(e,s,t,i){this.router=e,this.metadata=s,this.language=t,this.administration=i}return AdministrationHomeScreen.prototype.trackbyfn=function(e,s){return s.id},__decorate([core_1.Component({template:'<administration-card *ngFor="let adminNavigationBlock of administration.navigationGroups; trackBy: trackbyfn" [adminNavigationBlock]="adminNavigationBlock"></administration-card>'}),__metadata("design:paramtypes",[router_1.Router,services_1.metadata,services_1.language,administration])],AdministrationHomeScreen)}();exports.AdministrationHomeScreen=AdministrationHomeScreen;var AdministrationHomeScreenCard=function(){function e(e,s,t,i){this.router=e,this.metadata=s,this.language=t,this.administration=i}return e.prototype.trackbyfn=function(e,s){return s.id},__decorate([core_1.Input(),__metadata("design:type",Object)],e.prototype,"adminNavigationBlock",void 0),__decorate([core_1.Component({selector:"administration-card",template:'<div class="slds-p-around--medium"><article class="slds-card slds-p-around--small"><div class="slds-card__header slds-grid"><header class="slds-media slds-media_center slds-has-flexi-truncate"><div class="slds-media__body"><h2 class="slds-card__header-title slds-text-heading_medium slds-grid--vertical"><p class="slds-card__header-link slds-truncate"><system-label [label]="adminNavigationBlock.label"></system-label></p><p class="slds-text-body_small slds-p-top_small"><system-label [label]="adminNavigationBlock.label" length="long"></system-label></p></h2></div></header></div><div class="slds-card__body slds-card__body_inner"><ul class="slds-grid slds-wrap slds-grid_pull-padded"><li class="slds-p-horizontal_small slds-size_1-of-1 slds-medium-size_1-of-3" administration-card-item *ngFor="let item of adminNavigationBlock.groupcomponents; trackBy: trackbyfn" [adminNavigationItem]="item"></li></ul></div></article></div>'}),__metadata("design:paramtypes",[router_1.Router,services_1.metadata,services_1.language,administration])],e)}();exports.AdministrationHomeScreenCard=AdministrationHomeScreenCard;var AdministrationHomeScreenCardItem=function(){function e(e,s,t,i,l){this.router=e,this.metadata=s,this.language=t,this.administration=i,this.navigationtab=l,this.adminNavigationItem={},this.adminNavigationBlock=""}return e.prototype.openContent=function(){var e=this.administration.getItemLabel(this.adminNavigationItem.id);this.navigationtab.setTabInfo({displayname:this.language.getLabel(e||"LBL_ADMINISTRATION"),displayicon:"settings"}),this.administration.navigateto(this.adminNavigationItem.id)},Object.defineProperty(e.prototype,"icon",{get:function(){return this.adminNavigationItem.icon||"empty"},enumerable:!1,configurable:!0}),__decorate([core_1.Input(),__metadata("design:type",Object)],e.prototype,"adminNavigationItem",void 0),__decorate([core_1.Input(),__metadata("design:type",String)],e.prototype,"adminNavigationBlock",void 0),__decorate([core_1.Component({selector:"[administration-card-item]",template:'<a class="slds-text-link_reset" href="javascript:void(0);" (click)="openContent()"><article class="slds-tile slds-media slds-card__tile slds-hint-parent"><div class="slds-media__figure"><system-icon [icon]="icon" size="large"></system-icon></div><div class="slds-media__body"><div class="slds-grid slds-grid_align-spread"><h3 class="slds-tile__title slds-text-heading_small"><p><system-label [label]="adminNavigationItem.admin_label"></system-label></p><p class="slds-text-body_small"><system-label [label]="adminNavigationItem.admin_label" length="long"></system-label></p></h3></div></div></article></a>'}),__metadata("design:paramtypes",[router_1.Router,services_1.metadata,services_1.language,administration,services_1.navigationtab])],e)}();exports.AdministrationHomeScreenCardItem=AdministrationHomeScreenCardItem;var AdministrationSystemStats=function(){function AdministrationSystemStats(e,s,t,i){this.metadata=e,this.language=s,this.backend=t,this.helper=i,this.loaded=!1,this.stats={},this.totaldbrecords=0,this.totaldbsize=0,this.loadStats()}return AdministrationSystemStats.prototype.loadStats=function(){var s=this;this.loaded=!1,this.backend.getRequest("configuration/systemstats").subscribe(function(e){s.stats=e,s.calculateTotalsDB(),s.loaded=!0})},AdministrationSystemStats.prototype.refresh=function(){this.loadStats()},Object.defineProperty(AdministrationSystemStats.prototype,"totalelasticrecords",{get:function(){try{return this.stats.elastic._all.total.docs.count}catch(e){return 0}},enumerable:!1,configurable:!0}),Object.defineProperty(AdministrationSystemStats.prototype,"totalelasticsize",{get:function(){try{return this.stats.elastic._all.total.store.size_in_bytes}catch(e){return 0}},enumerable:!1,configurable:!0}),Object.defineProperty(AdministrationSystemStats.prototype,"uploadcount",{get:function(){try{return this.stats.uploadfiles.count}catch(e){return 0}},enumerable:!1,configurable:!0}),Object.defineProperty(AdministrationSystemStats.prototype,"uploadsize",{get:function(){try{return this.stats.uploadfiles.size}catch(e){return 0}},enumerable:!1,configurable:!0}),Object.defineProperty(AdministrationSystemStats.prototype,"totalsize",{get:function(){return this.totaldbsize+this.totalelasticsize+this.uploadsize},enumerable:!1,configurable:!0}),AdministrationSystemStats.prototype.sortby=function(t,i){void 0===i&&(i=!0),this.stats.database.sort(function(e,s){return e[t]>s[t]?i?-1:1:i?1:-1})},AdministrationSystemStats.prototype.calculateTotalsDB=function(){this.totaldbrecords=0;for(var e=this.totaldbsize=0,s=this.stats.database;e<s.length;e++){var t=s[e];this.totaldbrecords+=parseInt(t.records,10),this.totaldbsize+=parseInt(t.size,10)}},AdministrationSystemStats.prototype.humanReadableSize=function(e){return this.helper.humanFileSize(e)},AdministrationSystemStats.prototype.ftsDocumentCount=function(e){try{return this.stats.elastic.indices[this.stats.elastic._prefix+e].total.docs.count}catch(e){return""}},AdministrationSystemStats.prototype.ftsIndexSize=function(e){try{return this.humanReadableSize(this.stats.elastic.indices[this.stats.elastic._prefix+e].total.store.size_in_bytes)}catch(e){return""}},__decorate([core_1.Component({template:'<ng-container *ngIf="loaded; else loading"><div class="slds-grid slds-grid_vertical-align-center slds-grid--align-spread slds-p-around--small"><h2 class="slds-text-heading_medium">System and Storage Statistics Summary</h2><button class="slds-button slds-button_icon slds-button_icon-border-filled" (click)="refresh()"><system-button-icon icon="refresh"></system-button-icon></button></div><table class="slds-table slds-table_bordered slds-table_cell-buffer slds-m-bottom--medium"><thead><tr class="slds-text-title_caps"><th scope="col">Object</th><th scope="col">Records</th><th scope="col">Size</th></tr></thead><tbody><tr><td><div class="slds-truncate">Database</div></td><td><div class="slds-truncate">{{totaldbrecords}}</div></td><td><div class="slds-truncate">{{humanReadableSize(totaldbsize)}}</div></td></tr><tr><td><div class="slds-truncate">Elasticsearch</div></td><td><div class="slds-truncate">{{totalelasticrecords}}</div></td><td><div class="slds-truncate">{{humanReadableSize(totalelasticsize)}}</div></td></tr><tr><td><div class="slds-truncate">Uploadfiles</div></td><td><div class="slds-truncate">{{uploadcount}}</div></td><td><div class="slds-truncate">{{humanReadableSize(uploadsize)}}</div></td></tr></tbody><tfoot><tr class="slds-theme--shade slds-text-title_caps"><th><div class="slds-truncate">total</div></th><th><div class="slds-truncate"></div></th><th><div class="slds-truncate">{{humanReadableSize(totalsize)}}</div></th></tr></tfoot></table><h2 class="slds-p-around--small">System and Storage Statistics Details</h2><div class="slds-border--top" system-to-bottom><table class="slds-table slds-table_bordered slds-table_cell-buffer slds-table--header-fixed"><thead><tr class="slds-text-title_caps"><th scope="col"><div class="slds-truncate" (click)="sortby(\'name\', false)">Table</div></th><th scope="col"><div class="slds-truncate" (click)="sortby(\'records\')">Records</div></th><th scope="col"><div class="slds-truncate" (click)="sortby(\'size\')">Size</div></th><th scope="col"><div class="slds-truncate">indexed Records</div></th><th scope="col"><div class="slds-truncate">Index Size</div></th></tr></thead><tbody><tr *ngFor="let table of stats.database"><td><div class="slds-truncate">{{table.name}}</div></td><td><div class="slds-truncate">{{table.records}}</div></td><td><div class="slds-truncate">{{humanReadableSize(table.size)}}</div></td><td><div class="slds-truncate">{{ftsDocumentCount(table.name)}}</div></td><td><div class="slds-truncate">{{ftsIndexSize(table.name)}}</div></td></tr></tbody></table></div></ng-container><ng-template #loading><div class="slds-align--absolute-center slds-height_full slds-size--1-of-1"><system-spinner></system-spinner></div></ng-template>'}),__metadata("design:paramtypes",[services_1.metadata,services_1.language,services_1.backend,services_1.helper])],AdministrationSystemStats)}();exports.AdministrationSystemStats=AdministrationSystemStats;var AdministrationSystemVersions=function(){function AdministrationSystemVersions(e,s,t){this.http=e,this.language=s,this.backend=t,this.loaded=!1,this.versions={},this.vendorpackages=[],this.loadVersions()}return AdministrationSystemVersions.prototype.loadVersions=function(){var t=this;this.loaded=!1,this.http.get("config/systemdetails/").subscribe(function(e){for(var s in t.versions=e,t.vendorpackages=[],t.versions.vendor)t.vendorpackages.push({vendorpackage:s,files:t.versions.vendor[s]});t.loaded=!0})},__decorate([core_1.Component({template:'<ng-container *ngIf="loaded; else loading"><div class="slds-grid slds-grid_vertical-align-center slds-grid--align-spread slds-p-around--small"><h2 class="slds-text-heading_medium">Libraries Versions</h2></div><div class="slds-border--top" system-to-bottom><div class="slds-p-around--small slds-text-heading_small"><h3><system-label label="LBL_MODULES"></system-label></h3></div><table class="slds-table slds-table_bordered slds-table_cell-buffer"><thead><tr class="slds-text-title_caps"><th scope="col" width="45%"><div class="slds-truncate"><system-label label="LBL_NAME"></system-label></div></th><th scope="col" width="20%"><div class="slds-truncate"><system-label label="LBL_DATE"></system-label></div></th><th scope="col" width="20%"><div class="slds-truncate"><system-label label="LBL_BUILD"></system-label></div></th><th scope="col" width="15%"><div class="slds-truncate"><system-label label="LBL_RELEASE"></system-label></div></th></tr></thead><tbody><tr *ngFor="let component of versions.app"><td><div class="slds-truncate">{{component.name}}</div></td><td><div class="slds-truncate">{{component.date}}</div></td><td><div class="slds-truncate">{{component.build}}</div></td><td><div class="slds-truncate">{{component.release}}</div></td></tr></tbody></table><div *ngFor="let vendorpackage of vendorpackages"><div class="slds-p-around--small slds-text-heading_small"><h3>{{vendorpackage.vendorpackage}}</h3></div><table class="slds-table slds-table_bordered slds-table_cell-buffer"><thead><tr class="slds-text-title_caps"><th scope="col" width="85%"><div class="slds-truncate"><system-label label="LBL_NAME"></system-label></div></th><th scope="col" width="15%"><div class="slds-truncate"><system-label label="LBL_VERSION"></system-label></div></th></tr></thead><tbody><tr *ngFor="let packagefile of vendorpackage.files"><td><div class="slds-truncate">{{packagefile.name}}</div></td><td><div class="slds-truncate">{{packagefile.version}}</div></td></tr></tbody></table></div></div></ng-container><ng-template #loading><div class="slds-align--absolute-center slds-height_full slds-size--1-of-1"><system-spinner></system-spinner></div></ng-template>'}),__metadata("design:paramtypes",[http_1.HttpClient,services_1.language,services_1.backend])],AdministrationSystemVersions)}();exports.AdministrationSystemVersions=AdministrationSystemVersions;var AdministrationAPIInspector=function(){function AdministrationAPIInspector(e,s,t,i){this.toast=e,this.modal=s,this.injector=t,this.apiinspector=i,this.toggleClassSub=[]}return AdministrationAPIInspector.prototype.toggleUnauthorized=function(e){e.preventDefault(),e.stopPropagation(),this.apiinspector.apiFilterUnauthorized=!this.apiinspector.apiFilterUnauthorized},AdministrationAPIInspector.prototype.toggleAdminOnly=function(e){e.preventDefault(),e.stopPropagation(),this.apiinspector.apiFilterAdminOnly=!this.apiinspector.apiFilterAdminOnly},AdministrationAPIInspector.prototype.toggleValidatedOnly=function(e){e.preventDefault(),e.stopPropagation(),this.apiinspector.apiFilterValidatedOnly=!this.apiinspector.apiFilterValidatedOnly},AdministrationAPIInspector.prototype.selectNode=function(e){this.apiinspector.selectAPI(e)},__decorate([core_1.Component({selector:"[administration-api-inspector]",template:'<div class="slds-grid slds-grid_vertical-align-center slds-p-around--small slds-border--bottom"><system-icon icon="apex_plugin"></system-icon><h2 class="slds-text-heading_medium"><system-label label="LBL_API_INSPECTOR"></system-label> ({{apiinspector.apiEndpoints.length}})</h2></div><div class="slds-theme--default slds-grid" [system-overlay-loading-spinner]="apiinspector.loading"><div class="slds-size--1-of-3 slds-border--right"><div class="slds-p-around--x-small slds-border--bottom"><div class="slds-grid slds-grid--vertical-align-center"><input class="slds-input" system-placeholder="LBL_FILTER" [(ngModel)]="apiinspector.apiFilter"><system-utility-icon class="slds-p-left--xx-small" (click)="toggleUnauthorized($event)" icon="unlock" size="x-small" [colorclass]="apiinspector.apiFilterUnauthorized ? \'slds-icon-text-warning\' : \'slds-icon-text-light\'"></system-utility-icon><system-utility-icon class="slds-p-left--xx-small" (click)="toggleAdminOnly($event)" icon="user_role" size="x-small" [colorclass]="apiinspector.apiFilterAdminOnly ? \'slds-icon-text-warning\' : \'slds-icon-text-light\'"></system-utility-icon><system-utility-icon class="slds-p-left--xx-small" (click)="toggleValidatedOnly($event)" icon="ribbon" size="x-small" [colorclass]="apiinspector.apiFilterValidatedOnly ? \'slds-icon-text-warning\' : \'slds-icon-text-light\'"></system-utility-icon></div></div><div system-to-bottom><system-tree *ngIf="!apiinspector.loading; else treeLoadingSpinner" [sourceList]="apiinspector.apiTree" (selectedItemChange)="selectNode($event)"></system-tree><ng-template #treeLoadingSpinner><div class="slds-height_full slds-align--absolute-center"><div class="slds-grid slds-grid--vertical"><system-spinner></system-spinner><system-label class="slds-p-vertical--small" label="LBL_LOADING_ENDPOINTS"></system-label></div></div></ng-template></div></div><div class="slds-size--2-of-3"><div style="min-height: 49px;" class="slds-p-around--x-small slds-border--bottom slds-grid slds-grid--align-spread slds-grid--vertical-align-center"><span class="slds-text-heading--medium">{{apiinspector.selectedAPI?.route}} ({{apiinspector.apiMethods.length}})</span><system-checkbox [(ngModel)]="apiinspector.apiSubMethods"><system-label label="LBL_INCLUDE_SUBROUTES"></system-label></system-checkbox></div><div system-to-bottom><administration-api-inspector-methods *ngIf="apiinspector.apiMethods.length > 0; else noMethodsAvailable"></administration-api-inspector-methods><ng-template #noMethodsAvailable><div class="slds-height_full slds-align--absolute-center"><system-illustration-no-data><system-label label="LBL_NO_METHODS_FOR_ENDPOINT"></system-label></system-illustration-no-data></div></ng-template></div></div></div>',providers:[administrationapiinspectorService]}),__metadata("design:paramtypes",[services_1.toast,services_1.modal,core_1.Injector,administrationapiinspectorService])],AdministrationAPIInspector)}();exports.AdministrationAPIInspector=AdministrationAPIInspector;var AdministrationAPIInspectorDetails=function(){function e(){this.endpoint={}}return e.prototype.close=function(){this.self.destroy()},__decorate([core_1.Component({selector:"administration-api-inspector-details",template:'<system-modal><system-modal-header (close)="close()"><system-label label="LBL_API_ENDPOINT"></system-label></system-modal-header><system-modal-content [grow]="true">{{endpoint.method}}</system-modal-content><system-modal-footer><button class="slds-button slds-button--neutral" (click)="close()"><system-label label="LBL_CLOSE"></system-label></button></system-modal-footer></system-modal>',providers:[administrationapiinspectorService]})],e)}();exports.AdministrationAPIInspectorDetails=AdministrationAPIInspectorDetails;var AdministrationApiInspectorMethodParameters=function(){function e(e){this.apiinspector=e}return e.prototype.ngOnChanges=function(){this.parameters=this.apiinspector.getMethodParameters(this.apimethod.route,this.apimethod.method,this.in)},__decorate([core_1.Input(),__metadata("design:type",Object)],e.prototype,"apimethod",void 0),__decorate([core_1.Input(),__metadata("design:type",String)],e.prototype,"in",void 0),__decorate([core_1.Input(),__metadata("design:type",Object)],e.prototype,"parameterCollector",void 0),__decorate([core_1.Component({selector:"administration-api-inspector-method-parameters",template:'<ng-container *ngIf="this.parameters.length > 0"><div class="slds-p-around--small slds-text-heading--label"><system-label [label]="\'LBL_\'+in.toUpperCase()+\'_PARAMETERS\'"></system-label></div><table class="slds-table slds-table--fixed-layout slds-table_cell-buffer slds-table_bordered"><thead><tr class="slds-line-height_reset"><th style="width: 120px" scope="col"><div class="slds-truncate"><system-label label="LBL_NAME"></system-label></div></th><th scope="col"><div class="slds-truncate"><system-label label="LBL_DESCRIPTION"></system-label></div></th><th style="width: 100px" scope="col"><div class="slds-truncate"><system-label label="LBL_TYPE"></system-label></div></th><th *ngIf="parameterCollector" scope="col"><div class="slds-truncate"><system-label label="LBL_TYPE"></system-label></div></th></tr></thead><tbody><tr *ngFor="let parameter of parameters" class="slds-hint-parent"><td><div class="slds-truncate">{{parameter.name}}<abbr *ngIf="parameter.required" class="slds-required">*</abbr></div></td><td><div class="slds-truncate">{{parameter.description}}</div></td><td><div class="slds-truncate">{{parameter.type}}</div></td><td *ngIf="parameterCollector"><input class="slds-input" [(ngModel)]="parameterCollector[parameter.name]"></td></tr></tbody></table></ng-container>'}),__metadata("design:paramtypes",[administrationapiinspectorService])],e)}();exports.AdministrationApiInspectorMethodParameters=AdministrationApiInspectorMethodParameters;var AdministrationApiInspectorMethods=function(){function e(e,s,t){this.modal=e,this.injector=s,this.apiinspector=t}return e.prototype.test=function(s,e){e.preventDefault(),e.stopPropagation(),this.modal.openModal("AdministrationApiInspectorMethodTest",!0,this.injector).subscribe(function(e){e.instance.apiMethod=s})},__decorate([core_1.Component({selector:"administration-api-inspector-methods",template:'<div *ngFor="let apimethod of apiinspector.apiMethods" class="slds-m-around--x-small slds-p-around--none slds-box"><div class="slds-p-around--small slds-grid slds-grid--vertical-align-center slds-p-bottom--small slds-border--bottom"><div class="slds-badge slds-m-right--x-small" [ngStyle]="apiinspector.getMethodStyle(apimethod.method)"><div class="slds-size--1-of-1 slds-text-align--center">{{apimethod.method}}</div></div><div class="slds-truncate slds-text-heading--small slds-grow">{{apimethod.route}}</div><system-utility-icon class="slds-p-left--xx-small" icon="ribbon" size="x-small" [colorclass]="apimethod.options.validate ? \'slds-icon-text-success\' : \'slds-icon-text-light\'"></system-utility-icon><system-utility-icon class="slds-p-left--xx-small" icon="unlock" size="x-small" [colorclass]="apimethod.options.noAuth ? \'slds-icon-text-error\' : \'slds-icon-text-light\'"></system-utility-icon><system-utility-icon class="slds-p-left--xx-small" icon="user_role" size="x-small" [colorclass]="apimethod.options.adminOnly ? \'slds-icon-text-error\' : \'slds-icon-text-light\'"></system-utility-icon><system-utility-icon class="slds-p-left--xx-small slds-text-link--reset" (click)="test(apimethod, $event)" icon="play" size="x-small"></system-utility-icon></div><div class="slds-p-around--small"><div class="slds-p-bottom--small slds-text-heading--small"><system-label label="LBL_SUMMARY"></system-label></div><div>{{apimethod.description}}</div></div><administration-api-inspector-method-parameters [apimethod]="apimethod" in="path"></administration-api-inspector-method-parameters><administration-api-inspector-method-parameters [apimethod]="apimethod" in="query"></administration-api-inspector-method-parameters><administration-api-inspector-method-parameters [apimethod]="apimethod" in="body"></administration-api-inspector-method-parameters><administration-api-inspector-method-responses [apimethod]="apimethod"></administration-api-inspector-method-responses></div>'}),__metadata("design:paramtypes",[services_1.modal,core_1.Injector,administrationapiinspectorService])],e)}();exports.AdministrationApiInspectorMethods=AdministrationApiInspectorMethods;var AdministrationapiinspectorMethodResponses=function(){function e(e){this.apiinspector=e}return e.prototype.ngOnChanges=function(){this.response=this.apiinspector.getMethodResponses(this.apimethod.route,this.apimethod.method)},__decorate([core_1.Input(),__metadata("design:type",Object)],e.prototype,"apimethod",void 0),__decorate([core_1.Component({selector:"administration-api-inspector-method-responses",template:'<ng-container *ngIf="this.response.length > 0"><div class="slds-p-around--small slds-text-heading--label"><system-label label="LBL_API_RESPONSES"></system-label></div><table class="slds-table slds-table--fixed-layout slds-table_cell-buffer slds-table_bordered"><thead><tr class="slds-line-height_reset"><th style="width: 100px;" scope="col"><div class="slds-truncate"><system-label label="LBL_NAME"></system-label></div></th><th scope="col"><div class="slds-truncate"><system-label label="LBL_DESCRIPTION"></system-label></div></th></tr></thead><tbody><tr *ngFor="let response of response" class="slds-hint-parent"><td><div class="slds-truncate">{{response.name}}</div></td><td><div class="slds-truncate">{{response.description}}</div></td></tr></tbody></table></ng-container>'}),__metadata("design:paramtypes",[administrationapiinspectorService])],e)}();exports.AdministrationapiinspectorMethodResponses=AdministrationapiinspectorMethodResponses;var AdministrationApiInspectorMethodTest=function(){function AdministrationApiInspectorMethodTest(e,s,t){this.backend=e,this.libloader=s,this.apiInspector=t,this.activetab="parameters",this.executing=!1,this.parameterCollector={},this.libloader.loadLib("jsonbeautify")}return AdministrationApiInspectorMethodTest.prototype.ngAfterViewInit=function(){var e=this.modalcontent.element.nativeElement.getBoundingClientRect(),s=this.tabcontent.element.nativeElement.getBoundingClientRect();this.tabHeigth=e.height-s.top+e.top},Object.defineProperty(AdministrationApiInspectorMethodTest.prototype,"tabStyle",{get:function(){return{height:this.tabHeigth+"px"}},enumerable:!1,configurable:!0}),AdministrationApiInspectorMethodTest.prototype.test=function(){var s=this;switch(this.executing=!0,this.response=void 0,this.activetab="response",this.apiMethod.method){case"get":this.backend.getRequest(this.buildRoute(),this.buildParams()).subscribe(function(e){s.response=js_beautify(JSON.stringify(e)),s.executing=!1},function(e){s.response=js_beautify(JSON.stringify(e))});break;case"post":this.backend.postRequest(this.buildRoute(),this.buildParams(),this.buildBody()).subscribe(function(e){s.response=js_beautify(JSON.stringify(e)),s.executing=!1},function(e){s.response=js_beautify(JSON.stringify(e))})}},AdministrationApiInspectorMethodTest.prototype.checkParameters=function(){return!0},AdministrationApiInspectorMethodTest.prototype.buildRoute=function(){for(var e=this.apiMethod.route.substring(1),s=0,t=this.apiInspector.getMethodParameters(this.apiMethod.route,this.apiMethod.method,"path");s<t.length;s++)var i=t[s],e=e.replace("{"+i.name+"}",this.parameterCollector[i.name]);return e},AdministrationApiInspectorMethodTest.prototype.buildParams=function(){for(var e={},s=0,t=this.apiInspector.getMethodParameters(this.apiMethod.route,this.apiMethod.method,"query");s<t.length;s++){var i=t[s];e[i.name]=this.parameterCollector[i.name]}return e},AdministrationApiInspectorMethodTest.prototype.buildBody=function(){for(var e={},s=0,t=this.apiInspector.getMethodParameters(this.apiMethod.route,this.apiMethod.method,"body");s<t.length;s++){var i=t[s];e[i.name]=this.parameterCollector[i.name]}return e},AdministrationApiInspectorMethodTest.prototype.close=function(){this.self.destroy()},__decorate([core_1.ViewChild("modalcontent",{read:core_1.ViewContainerRef,static:!0}),__metadata("design:type",core_1.ViewContainerRef)],AdministrationApiInspectorMethodTest.prototype,"modalcontent",void 0),__decorate([core_1.ViewChild("tabcontent",{read:core_1.ViewContainerRef,static:!0}),__metadata("design:type",core_1.ViewContainerRef)],AdministrationApiInspectorMethodTest.prototype,"tabcontent",void 0),__decorate([core_1.Component({selector:"administration-api-inspector-method-test",template:'<system-modal><system-modal-header (close)="close()">{{apiMethod.route}}<system-modal-header-right><div class="slds-badge" [ngStyle]="apiInspector.getMethodStyle(apiMethod.method)"><div class="slds-size--1-of-1 slds-text-align--center">{{apiMethod.method}}</div></div></system-modal-header-right></system-modal-header><system-modal-content [grow]="true" #modalcontent margin="none"><div class="slds-tabs_default"><ul class="slds-tabs_default__nav" role="tablist"><li class="slds-tabs_default__item" [ngClass]="{\'slds-is-active\': activetab == \'parameters\'}" role="presentation"><a class="slds-tabs_default__link" role="tab" (click)="activetab = \'parameters\'"><system-label label="LBL_PARAMETERS"></system-label></a></li><li class="slds-tabs_default__item" title="Item Three" [ngClass]="{\'slds-is-active\': activetab == \'response\'}" role="presentation"><a class="slds-tabs_default__link" role="tab" (click)="activetab = \'response\'"><system-label label="LBL_RESPONSE"></system-label></a></li></ul><div #tabcontent [ngStyle]="tabStyle" class="slds-scrollable"><div class="slds-tabs_default__content" [ngClass]="{\'slds-hide\': activetab != \'parameters\'}" role="tabpanel"><administration-api-inspector-method-parameters [apimethod]="apiMethod" [parameterCollector]="parameterCollector" in="path"></administration-api-inspector-method-parameters><administration-api-inspector-method-parameters [apimethod]="apiMethod" [parameterCollector]="parameterCollector" in="query"></administration-api-inspector-method-parameters><administration-api-inspector-method-parameters [apimethod]="apiMethod" [parameterCollector]="parameterCollector" in="body"></administration-api-inspector-method-parameters></div><div class="slds-tabs_default__content" [ngClass]="{\'slds-hide\': activetab != \'response\'}" role="tabpanel"><pre class="slds-p-horizontal--x-small" style="white-space: pre-wrap">{{this.response}}</pre></div></div></div></system-modal-content><system-modal-footer><button class="slds-button slds-button--neutral" (click)="close()"><system-label label="LBL_CLOSE"></system-label></button> <button class="slds-button slds-button--brand" (click)="test()"><system-label label="LBL_TEST"></system-label></button></system-modal-footer></system-modal>'}),__metadata("design:paramtypes",[services_1.backend,services_1.libloader,administrationapiinspectorService])],AdministrationApiInspectorMethodTest)}();exports.AdministrationApiInspectorMethodTest=AdministrationApiInspectorMethodTest;var AdministrationSysTrashcanManager=function(){function AdministrationSysTrashcanManager(e,s,t,i,l,a){this.metadata=e,this.modal=s,this.backend=t,this.language=i,this.userpreferences=l,this.footer=a,this.records=[],this.loaddate={},this.loading=!0}return AdministrationSysTrashcanManager.prototype.ngOnInit=function(){this.getEntries()},AdministrationSysTrashcanManager.prototype.getEntries=function(){var s=this;this.backend.getRequest("admin/systrashcan").subscribe(function(e){s.records=e,s.loaddate=new moment,s.loading=!1})},AdministrationSysTrashcanManager.prototype.reload=function(){this.loading=!0,this.records=[],this.getEntries()},AdministrationSysTrashcanManager.prototype.getUserDate=function(e){return this.userpreferences.formatDateTime(e)},AdministrationSysTrashcanManager.prototype.recoverRecord=function(t){var i=this;this.modal.openModal("AdministrationSysTrashcanRecover").subscribe(function(e){e.instance.record=t,e.instance.recovered.subscribe(function(e){e&&i.records.some(function(e,s){if(e.id==t.id)return i.records.splice(s,1),!0})})})},AdministrationSysTrashcanManager.prototype.getModule=function(e){return this.metadata.getModuleFromSingular(e)},Object.defineProperty(AdministrationSysTrashcanManager.prototype,"loadDate",{get:function(){return this.loaddate?this.getUserDate(this.loaddate):"---"},enumerable:!1,configurable:!0}),__decorate([core_1.Component({selector:"administration-systrashcan-manager",template:'<div class="slds-page-header"><div class="slds-media"><div class="slds-p-horizontal--x-small"><system-action-icon icon="recall"></system-action-icon></div><div class="slds-media__body"><h1 class="slds-page-header__title slds-truncate slds-align-middle">Record Recovery</h1><div class="slds-text-body_small slds-line-height_reset slds-p-vertical--xx-small" (click)="reload()">{{loadDate}}</div></div></div></div><div system-to-bottom><table class="slds-table slds-table_bordered slds-table--header-fixed slds-table_cell-buffer"><thead><tr class="slds-text-title_caps"><th scope="col" colspan="2"><div class="slds-truncate"><system-label label="LBL_OBJECT"></system-label></div></th><th scope="col"><div class="slds-truncate"><system-label label="LBL_NAME"></system-label></div></th><th scope="col"><div class="slds-truncate"><system-label label="LBL_DATE_DELETED"></system-label></div></th><th scope="col"><div class="slds-truncate"><system-label label="LBL_DELETED_BY"></system-label></div></th><th scope="col" class="slds-cell-shrink"></th></tr></thead><tbody><tr *ngFor="let record of records"><td role="gridcell" class="slds-cell-shrink"><system-icon [module]="getModule(record.recordmodule)" size="small"></system-icon></td><td scope="row"><div class="slds-truncate">{{record.recordmodule}}</div></td><td><div class="slds-truncate">{{record.recordname}}</div></td><td><div class="slds-truncate">{{getUserDate(record.date_deleted)}}</div></td><td><div class="slds-truncate">{{record.user_name}}</div></td><td role="gridcell"><button class="slds-button slds-button_icon slds-button_icon-border-filled slds-button_icon-x-small" (click)="recoverRecord(record)"><system-button-icon [icon]="\'undelete\'"></system-button-icon></button></td></tr></tbody><tbody system-table-stencils [columns]="5" [select]="false" [tools]="true" [rows]="5" *ngIf="loading"></tbody></table><div *ngIf="!loading && records.length == 0" class="slds-p-around--medium slds-align--absolute-center"><h2 class="slds-text-heading--small"><system-label label="LBL_NO_RECORDS_FOUND"></system-label></h2></div></div>'}),__metadata("design:paramtypes",[services_1.metadata,services_1.modal,services_1.backend,services_1.language,services_1.userpreferences,services_1.footer])],AdministrationSysTrashcanManager)}();exports.AdministrationSysTrashcanManager=AdministrationSysTrashcanManager;var AdministrationSysTrashcanRecover=function(){function AdministrationSysTrashcanRecover(e,s,t,i){this.metadata=e,this.backend=s,this.language=t,this.toast=i,this.record={},this.self={},this.relatedRecords=[],this.loading=!0,this.recoverrelated=!1,this.recovering=!1,this.recovered=new core_1.EventEmitter}return AdministrationSysTrashcanRecover.prototype.ngOnInit=function(){var s=this;this.backend.getRequest("admin/systrashcan/related/"+this.record.transactionid+"/"+this.record.recordid).subscribe(function(e){s.relatedRecords=e,0<s.relatedRecords.length&&(s.recoverrelated=!0),s.loading=!1},function(e){s.loading=!1})},AdministrationSysTrashcanRecover.prototype.close=function(){this.recovered.emit(!1),this.self.destroy()},AdministrationSysTrashcanRecover.prototype.getModule=function(e){return this.metadata.getModuleFromSingular(e)},Object.defineProperty(AdministrationSysTrashcanRecover.prototype,"recorverDisabled",{get:function(){return 0==this.relatedRecords.length},enumerable:!1,configurable:!0}),AdministrationSysTrashcanRecover.prototype.doRecover=function(){var s=this;this.recovering=!0,this.backend.postRequest("admin/systrashcan/recover/"+this.record.id,{recoverrelated:this.recoverrelated}).subscribe(function(e){s.toast.sendToast("record "+s.record.recordname+" recovered"),s.recovered.emit(!0),s.self.destroy()})},__decorate([core_1.Input(),__metadata("design:type",Object)],AdministrationSysTrashcanRecover.prototype,"record",void 0),__decorate([core_1.Component({template:'<system-modal><system-modal-header (close)="close()">Recover {{record.recordmodule}} {{record.recordname}}</system-modal-header><system-modal-content margin="none"><table *ngIf="relatedRecords.length > 0; else norelatedrecords" class="slds-table slds-table_bordered slds-table_cell-buffer"><thead><tr class="slds-text-title_caps"><th scope="col" colspan="2"><div class="slds-truncate">Object</div></th><th scope="col"><div class="slds-truncate">Name</div></th><th scope="col"><div class="slds-truncate">link</div></th></tr></thead><tbody><tr *ngFor="let relatedRecord of relatedRecords"><td role="gridcell" class="slds-cell-shrink"><system-icon [module]="getModule(relatedRecord.linkmodule)" size="small"></system-icon></td><td scope="row"><div class="slds-truncate">{{relatedRecord.linkmodule}}</div></td><td><div class="slds-truncate">{{relatedRecord.recordname}}</div></td><td><div class="slds-truncate">{{relatedRecord.linkname}}</div></td></tr></tbody></table><ng-template #norelatedrecords><div style="height: 100%;" class="slds-p-around--medium slds-align--absolute-center"><h2 class="slds-text-heading--small">no related records found</h2></div></ng-template></system-modal-content><system-modal-footer><div class="slds-grid slds-grid--vertical-align-center slds-grid--align-spread"><div><div [ngClass]="{\'slds-hide\': recorverDisabled}" class="slds-form-element__control"><span class="slds-checkbox"><input type="checkbox" [(ngModel)]="recoverrelated" id="recoverrelated"> <label class="slds-checkbox__label" for="recoverrelated"><span class="slds-checkbox_faux"></span> <span class="slds-form-element__label">recover Related</span></label></span></div></div><div><button class="slds-button slds-button--neutral" (click)="close()">Cancel</button> <button class="slds-button slds-button--brand" [disabled]="loading" (click)="doRecover()">Recover</button></div></div></system-modal-footer></system-modal>'}),__metadata("design:paramtypes",[services_1.metadata,services_1.backend,services_1.language,services_1.toast])],AdministrationSysTrashcanRecover)}();exports.AdministrationSysTrashcanRecover=AdministrationSysTrashcanRecover;var AdministrationDictRepair=function(){function AdministrationDictRepair(e,s,t){this.backend=e,this.toast=s,this.language=t}return __decorate([core_1.Component({selector:"administration-dict-repair",template:'<div class="slds-grid slds-grid--align-spread slds-p-around--medium"><h2 class="slds-text-heading--medium"><system-label label="LBL_REPAIR_DICTIONARY"></system-label></h2></div><div class="slds-p-around--small slds-theme--default" system-to-bottom><administration-dict-repair-item></administration-dict-repair-item><administration-dict-repair-language></administration-dict-repair-language><administration-dict-repair-acl-roles></administration-dict-repair-acl-roles><administration-dict-repair-cache></administration-dict-repair-cache><administration-dict-repair-db-columns></administration-dict-repair-db-columns><administration-dict-repair-convert-db-charset></administration-dict-repair-convert-db-charset></div>'}),__metadata("design:paramtypes",[services_1.backend,services_1.toast,services_1.language])],AdministrationDictRepair)}();exports.AdministrationDictRepair=AdministrationDictRepair;var AdministrationDictRepairItem=function(){function AdministrationDictRepairItem(e,s,t,i,l){this.backend=e,this.toast=s,this.language=t,this.modal=i,this.injector=l,this.sql=[]}return AdministrationDictRepairItem.prototype.executeDB=function(){var s=this,t=this.modal.await(this.language.getLabel("LBL_LOADING"));this.backend.getRequest("admin/repair/sql").subscribe(function(e){t.emit(!0),s.sql=e.sql,s.wholeSQL=e.wholeSQL,e&&s.modal.openModal("AdministrationDictRepairModal",!0,s.injector).subscribe(function(e){e.instance.sql=s.sql,e.instance.wholeSQL=s.wholeSQL})})},__decorate([core_1.Component({selector:"administration-dict-repair-item",template:'<div class="slds-grid slds-grid--vertical-align-center slds-grid--align-spread slds-p-vertical--xx-small slds-border--bottom"><system-utility-icon icon="custom_apps" size="x-small"></system-utility-icon><system-label class="slds-p-horizontal--x-small" label="LBL_REPAIR_DATABASE"></system-label> <system-label class="slds-grow" label="LBL_REPAIR_DATABASE" length="long"></system-label> <button class="slds-button slds-button--neutral slds-button--small" (click)="executeDB()"><system-label label="LBL_EXECUTE"></system-label></button></div>'}),__metadata("design:paramtypes",[services_1.backend,services_1.toast,services_1.language,services_1.modal,core_1.Injector])],AdministrationDictRepairItem)}();exports.AdministrationDictRepairItem=AdministrationDictRepairItem;var AdministrationDictRepairModal=function(){function AdministrationDictRepairModal(e,s,t,i){this.backend=e,this.toast=s,this.language=t,this.modal=i,this.synced=!1,this.sql=[],this.dbErrors=[],this.self={}}return AdministrationDictRepairModal.prototype.close=function(){this.self.destroy()},Object.defineProperty(AdministrationDictRepairModal.prototype,"hidden",{get:function(){return null==typeof navigator.clipboard},enumerable:!1,configurable:!0}),AdministrationDictRepairModal.prototype.doRepair=function(){var t=this;this.modal.openModal("SystemLoadingModal").subscribe(function(s){var e=t.sql.filter(function(e){return e.selected});t.backend.postRequest("admin/repair/database",{},{selectedqueries:e}).subscribe(function(e){e.response?(e.synced?t.toast.sendToast(t.language.getLabel("LBL_REPAIR_DATABASE_ALREADY_SYNCED"),"success"):t.toast.sendToast(t.language.getLabel("LBL_REPAIR_DATABASE_SYNCED"),"success"),t.close()):t.dbErrors=e.errors,s.instance.self.destroy()},function(e){500===e.status&&(t.toast.sendAlert(e.message,"error"),t.close(),s.instance.self.destroy())})})},AdministrationDictRepairModal.prototype.copy2clipboard=function(){var s=this,e=this.sql.filter(function(e){return e.selected}).map(function(e){return e.statement}).toString().replace(/;,/g,";\n");navigator.clipboard.writeText(e).then(function(e){s.toast.sendToast(s.language.getLabel("LBL_COPIED_TO_CLIPBOARD"),"info")})},AdministrationDictRepairModal.prototype.selectAll=function(){this.sql.forEach(function(e){e.selected=!0})},__decorate([core_1.Component({selector:"administration-dict-repair-modal",template:'<system-modal><system-modal-header (close)="close()"><system-label label="LBL_REPAIR_DICTIONARY"></system-label></system-modal-header><system-modal-content [margin]="\'none\'"><table class="slds-table slds-table_bordered slds-table_cell-buffer" system-multi-select-checkboxes><tbody><tr *ngFor="let query of sql"><td style="white-space: normal"><div class="slds-grid slds-grid--vertical-align-center slds-p-around--xx-small"><system-checkbox [(ngModel)]="query.selected"></system-checkbox><div><p>{{query.comment}}</p><p>{{query.statement}}</p></div></div></td></tr></tbody></table><div *ngIf="dbErrors.length > 0" class="slds-form-element"><system-label label="LBL_LAST_DB_ERROR"></system-label><div class="slds-form-element__control"><textarea *ngFor="let error of dbErrors" disabled class="slds-textarea" style="min-height: 400px;" [value]="error"></textarea></div></div><div *ngIf="sql == \'\'" class="slds-form-element__control"><system-label label="LBL_REPAIR_DATABASE_ALREADY_SYNCED"></system-label></div></system-modal-content><system-modal-footer><button class="slds-button slds-button--neutral" [disabled]="sql.length <= 0" (click)="selectAll()"><system-label label="LBL_SELECT_ALL"></system-label></button> <button *ngIf="!hidden" class="slds-button slds-button--neutral" [disabled]="wholeSQL.length <= 0" (click)="copy2clipboard()"><system-label label="LBL_COPY_TO_CLIPBOARD"></system-label></button> <button class="slds-button slds-button--brand" [disabled]="sql.length <= 0" (click)="doRepair()"><system-label label="LBL_EXECUTE"></system-label></button></system-modal-footer></system-modal>'}),__metadata("design:paramtypes",[services_1.backend,services_1.toast,services_1.language,services_1.modal])],AdministrationDictRepairModal)}();exports.AdministrationDictRepairModal=AdministrationDictRepairModal;var AdministrationDictRepairLanguage=function(){function AdministrationDictRepairLanguage(e,s,t,i){this.backend=e,this.toast=s,this.language=t,this.modal=i,this.loaderHandler=new rxjs_1.Subject}return AdministrationDictRepairLanguage.prototype.executeLG=function(){var s=this,t=this.modal.await(this.language.getLabel("LBL_LOADING"));this.backend.getRequest("admin/repair/language").subscribe(function(e){t.emit(!0),e.response?(s.language.getLanguage(s.loaderHandler),s.toast.sendToast(s.language.getLabel("LBL_LANGUAGES_REPAIRED"),"success")):s.toast.sendToast(s.language.getLabel("LBL_ERROR"),"error")})},__decorate([core_1.Component({selector:"administration-dict-repair-language",template:'<div class="slds-grid slds-grid--vertical-align-center slds-grid--align-spread slds-p-vertical--xx-small slds-border--bottom"><system-utility-icon icon="custom_apps" size="x-small"></system-utility-icon><system-label class="slds-p-horizontal--x-small" label="LBL_REPAIR_LANGUAGE"></system-label> <system-label class="slds-grow" label="LBL_REPAIR_LANGUAGE" length="long"></system-label> <button class="slds-button slds-button--neutral slds-button--small" (click)="executeLG()"><system-label label="LBL_EXECUTE"></system-label></button></div>'}),__metadata("design:paramtypes",[services_1.backend,services_1.toast,services_1.language,services_1.modal])],AdministrationDictRepairLanguage)}();exports.AdministrationDictRepairLanguage=AdministrationDictRepairLanguage;var AdministrationDictRepairACLRoles=function(){function e(e,s,t,i){this.backend=e,this.toast=s,this.language=t,this.modal=i}return e.prototype.executeRepairRoles=function(){var s=this,t=this.modal.await(this.language.getLabel("LBL_LOADING"));this.backend.getRequest("admin/repair/aclroles").subscribe(function(e){t.emit(!0),e?s.toast.sendToast(s.language.getLabel("LBL_ROLES_REPAIRED"),"success"):s.toast.sendToast(s.language.getLabel("LBL_ERROR"),"error")})},__decorate([core_1.Component({selector:"administration-dict-repair-acl-roles",template:'<div class="slds-grid slds-grid--vertical-align-center slds-grid--align-spread slds-p-vertical--xx-small slds-border--bottom"><system-utility-icon icon="custom_apps" size="x-small"></system-utility-icon><system-label class="slds-p-horizontal--x-small" label="LBL_REPAIR_ACL_ROLES"></system-label> <system-label class="slds-grow" label="LBL_REPAIR_ACL_ROLES" length="long"></system-label> <button class="slds-button slds-button--neutral slds-button--small" (click)="executeRepairRoles()"><system-label label="LBL_EXECUTE"></system-label></button></div>'}),__metadata("design:paramtypes",[services_1.backend,services_1.toast,services_1.language,services_1.modal])],e)}();exports.AdministrationDictRepairACLRoles=AdministrationDictRepairACLRoles;var AdministrationDictRepairCache=function(){function AdministrationDictRepairCache(e,s,t,i){this.backend=e,this.toast=s,this.language=t,this.modal=i}return AdministrationDictRepairCache.prototype.executeRepairCache=function(){var s=this,t=this.modal.await(this.language.getLabel("LBL_LOADING"));this.backend.getRequest("admin/repair/cache").subscribe(function(e){t.emit(!0),e?s.toast.sendToast(s.language.getLabel("LBL_CACHE_REPAIRED"),"success"):s.toast.sendToast(s.language.getLabel("LBL_ERROR"),"error")})},__decorate([core_1.Component({selector:"administration-dict-repair-cache",template:'<div class="slds-grid slds-grid--vertical-align-center slds-grid--align-spread slds-p-vertical--xx-small slds-border--bottom"><system-utility-icon icon="custom_apps" size="x-small"></system-utility-icon><system-label class="slds-p-horizontal--x-small" label="LBL_REPAIR_CACHE"></system-label> <system-label class="slds-grow" label="LBL_REPAIR_CACHE" length="long"></system-label> <button class="slds-button slds-button--neutral slds-button--small" (click)="executeRepairCache()"><system-label label="LBL_EXECUTE"></system-label></button></div>'}),__metadata("design:paramtypes",[services_1.backend,services_1.toast,services_1.language,services_1.modal])],AdministrationDictRepairCache)}();exports.AdministrationDictRepairCache=AdministrationDictRepairCache;var AdministrationDictRepairDbColumns=function(){function e(e,s,t,i,l){this.backend=e,this.toast=s,this.language=t,this.modal=i,this.injector=l}return e.prototype.executeRepairDbColumns=function(){this.modal.openModal("AdministrationDictRepairDbColumnsModal",!0,this.injector)},__decorate([core_1.Component({selector:"administration-dict-repair-db-columns",template:'<div class="slds-grid slds-grid--vertical-align-center slds-grid--align-spread slds-p-vertical--xx-small slds-border--bottom"><system-utility-icon icon="custom_apps" size="x-small"></system-utility-icon><system-label class="slds-p-horizontal--x-small" label="LBL_REPAIR_DBCOLUMNS"></system-label> <system-label class="slds-grow" label="LBL_REPAIR_DBCOLUMNS_DESC" length="long"></system-label> <button class="slds-button slds-button--neutral slds-button--small" (click)="executeRepairDbColumns()"><system-label label="LBL_EXECUTE"></system-label></button></div>'}),__metadata("design:paramtypes",[services_1.backend,services_1.toast,services_1.language,services_1.modal,core_1.Injector])],e)}();exports.AdministrationDictRepairDbColumns=AdministrationDictRepairDbColumns;var AdministrationDictRepairDbColumnsModal=function(){function AdministrationDictRepairDbColumnsModal(e,s,t,i,l,a){this.backend=e,this.toast=s,this.language=t,this.modal=i,this.metadata=l,this.helper=a,this.self={},this._module="",this.allFields=[],this.modules=this.metadata.getModules(),this.modules.sort()}return Object.defineProperty(AdministrationDictRepairDbColumnsModal.prototype,"module",{get:function(){return this._module},set:function(e){e!=this._module&&(this._module=e,this.mergeColumns())},enumerable:!1,configurable:!0}),AdministrationDictRepairDbColumnsModal.prototype.mergeColumns=function(){var n=this;this.allFields=[],this.backend.getRequest("dictionary/browser/"+this.module+"/dbcolumns").subscribe(function(e){var s,t,i=n.metadata.getModuleFields(n.module);for(s in i)"non-db"!=i[s].source&&n.allFields.unshift({name:i[s].name,vardef_available:!0});for(t in e){var l,a=e[t].name,o=!1;for(l in n.allFields)n.allFields[l].name==a&&(n.allFields[l].db_available=!0,n.allFields.push(n.allFields[l]),n.allFields.splice(l,1),o=!0);o||n.allFields.unshift({name:a,db_available:!0})}})},AdministrationDictRepairDbColumnsModal.prototype.selectAll=function(){for(var e=0,s=this.allFields.filter(function(e){return e.db_available&&!e.vardef_available});e<s.length;e++)s[e].todelete=!0},Object.defineProperty(AdministrationDictRepairDbColumnsModal.prototype,"canSelectAll",{get:function(){return this.allFields&&0<this.allFields.filter(function(e){return e.db_available&&!e.vardef_available&&!e.todelete}).length},enumerable:!1,configurable:!0}),Object.defineProperty(AdministrationDictRepairDbColumnsModal.prototype,"canDelete",{get:function(){return this.allFields&&0<this.allFields.filter(function(e){return e.todelete}).length},enumerable:!1,configurable:!0}),AdministrationDictRepairDbColumnsModal.prototype.close=function(){this.self.destroy()},AdministrationDictRepairDbColumnsModal.prototype.doRepair=function(){for(var s=this,e="",t=0,i=this.allFields.filter(function(e){return e.todelete});t<i.length;t++)e+="- "+i[t].name+"\r\n";this.helper.confirm(this.language.getLabel("LBL_CLEAN_DB_COLUMNS"),this.language.getLabel("MSG_DELETE_COLUMNS","long")+"\r\n\r\n"+e).subscribe(function(e){e&&s.delete()})},AdministrationDictRepairDbColumnsModal.prototype.delete=function(){var t=this;this.modal.openModal("SystemLoadingModal").subscribe(function(s){var e={dbcolumns:t.allFields.filter(function(e){return e.todelete}),module:t.module};t.backend.postRequest("admin/repair/dbcolumns",{},e).subscribe(function(e){e?t.toast.sendToast(t.language.getLabel("MSG_SUCCESSFULLY_EXECUTED"),"success"):t.toast.sendToast(t.language.getLabel("LBL_ERROR"),"error"),t.mergeColumns(),s.instance.self.destroy()})})},__decorate([core_1.Component({selector:"administration-dict-repair-db-columns-modal",template:'<system-modal><system-modal-header (close)="close()"><system-label label="LBL_CLEAN_DB_COLUMNS"></system-label></system-modal-header><system-modal-content margin="none" [grow]="true"><div class="slds-p-around--x-small slds-border--bottom"><div class="slds-form-element slds-grid slds-grid--vertical-align-center"><label for="moduleselect" class="slds-form-element__label"><system-label label="LBL_MODULE"></system-label></label><div class="slds-form-element__control slds-col"><div class="slds-select_container"><select id="moduleselect" class="slds-select" [(ngModel)]="module"><option><system-label label="LBL_SELECT"></system-label></option><option *ngFor="let thismodule of modules" [value]="thismodule">{{thismodule}}</option></select></div></div></div></div><div *ngIf="module"><table class="slds-table slds-table--bordered slds-table--cell-buffer"><thead><tr class="slds-text-title--caps"><th scope="col">Vardef</th><th scope="col">Database column</th><th scope="col"></th></tr></thead><tbody><tr *ngFor="let field of allFields | keyvalue" [ngStyle]="field.value.vardef_available && field.value.db_available?{\'background-color\':\'#C7D6A9\'} : {\'background-color\': \'#EDD0AB\'}"><td><div *ngIf="field.value.vardef_available">{{field.value.name}}</div><div *ngIf="!field.value.vardef_available"><system-icon icon="first_non_empty" size="x-small"></system-icon></div></td><td class="slds-truncate"><div *ngIf="field.value.db_available">{{field.value.name}}</div><div *ngIf="!field.value.db_available"><system-icon icon="first_non_empty" size="x-small"></system-icon></div></td><td><div *ngIf="field.value.db_available && !field.value.vardef_available"><system-checkbox [(ngModel)]="field.value.todelete" [disabled]="!field.value.db_available"></system-checkbox></div></td></tr></tbody></table></div></system-modal-content><system-modal-footer><button class="slds-button slds-button--neutral" [disabled]="!canSelectAll" (click)="selectAll()"><system-label label="LBL_SELECT_ALL"></system-label></button> <button class="slds-button slds-button--brand" [disabled]="!canDelete" (click)="doRepair()"><system-label label="LBL_DELETE_IRREVOCABLY"></system-label></button></system-modal-footer></system-modal>'}),__metadata("design:paramtypes",[services_1.backend,services_1.toast,services_1.language,services_1.modal,services_1.metadata,services_1.helper])],AdministrationDictRepairDbColumnsModal)}();exports.AdministrationDictRepairDbColumnsModal=AdministrationDictRepairDbColumnsModal;var AdministrationDictRepairConvertDBCharset=function(){function e(e,s){this.modal=e,this.injector=s}return e.prototype.openModal=function(){this.modal.openModal("AdministrationDictRepairConvertDBCharsetModal",!0,this.injector)},__decorate([core_1.Component({selector:"administration-dict-repair-convert-db-charset",template:'<div class="slds-grid slds-grid--vertical-align-center slds-grid--align-spread slds-p-vertical--xx-small slds-border--bottom"><system-utility-icon icon="custom_apps" size="x-small"></system-utility-icon><system-label class="slds-p-horizontal--x-small" label="LBL_CONVERT_DB_CHARSET"></system-label> <system-label class="slds-grow" label="LBL_CONVERT_DB_CHARSET" length="long"></system-label> <button class="slds-button slds-button--neutral slds-button--small" (click)="openModal()"><system-label label="LBL_EXECUTE"></system-label></button></div>'}),__metadata("design:paramtypes",[services_1.modal,core_1.Injector])],e)}();exports.AdministrationDictRepairConvertDBCharset=AdministrationDictRepairConvertDBCharset;var AdministrationDictRepairConvertDBCharsetModal=function(){function AdministrationDictRepairConvertDBCharsetModal(e,s,t){this.backend=e,this.toast=s,this.language=t,this.tables=[],this.filteredTables=[],this.selectedTables=[]}return Object.defineProperty(AdministrationDictRepairConvertDBCharsetModal.prototype,"listFilterTerm",{get:function(){return this._listFilterTerm},set:function(s){this._listFilterTerm=s,this.filteredTables=this.tables.filter(function(e){return-1<e.table_name.indexOf(s)})},enumerable:!1,configurable:!0}),AdministrationDictRepairConvertDBCharsetModal.prototype.ngOnInit=function(){this.loadDBTables()},AdministrationDictRepairConvertDBCharsetModal.prototype.close=function(){this.self.destroy()},AdministrationDictRepairConvertDBCharsetModal.prototype.convertTables=function(){var s=this;this.close();var e={tables:this.filteredTables.filter(function(e){return!!e.selected}).map(function(e){return e.table_name}),charset:this.convertToCharset};this.backend.postRequest("admin/convert/tables",{},e).subscribe(function(e){e?s.toast.sendToast(s.language.getLabel("MSG_SUCCESSFULLY_EXECUTED"),"success"):s.toast.sendToast(s.language.getLabel("ERR_FAILED_TO_EXECUTE"),"error")})},AdministrationDictRepairConvertDBCharsetModal.prototype.convertDatabase=function(){var s=this;this.close();var e={charset:this.convertToCharset};this.backend.postRequest("admin/convert/database",{},e).subscribe(function(e){e?s.toast.sendToast(s.language.getLabel("MSG_SUCCESSFULLY_EXECUTED"),"success"):s.toast.sendToast(s.language.getLabel("ERR_FAILED_TO_EXECUTE"),"error")})},AdministrationDictRepairConvertDBCharsetModal.prototype.toggleSelectAll=function(s){this.selectedTables=s?this.filteredTables.map(function(e){return e.table_name}):[],this.filteredTables.forEach(function(e){return e.selected=s})},AdministrationDictRepairConvertDBCharsetModal.prototype.selectTable=function(e,s){e&&!this.selectedTables.some(function(e){return e==s})?this.selectedTables.push(s):e||(this.selectedTables=this.selectedTables.filter(function(e){return e!=s}))},AdministrationDictRepairConvertDBCharsetModal.prototype.loadDBTables=function(){var s=this;this.backend.getRequest("admin/charset/database").subscribe(function(e){s.tables=e.tables,s.filteredTables=s.tables,s.databaseData=e.database})},__decorate([core_1.Component({selector:"administration-dict-repair-convert-db-charset-modal",template:'<system-modal><system-modal-header (close)="close()"><system-label label="LBL_CONVERT_DATABASE_CHARSET"></system-label></system-modal-header><system-modal-content margin="none" [grow]="true"><div class="slds-grid slds-grid--vertical slds-height_full"><div class="slds-grid slds-p-around--x-small"><div class="slds-grow"><div class="slds-grid slds-grid--vertical-align-center"><system-label label="LBL_DATABASE" class="slds-m-right--x-small slds-text-title--caps"></system-label> <span>{{databaseData?.database}}</span></div><div class="slds-grid slds-grid--vertical-align-center"><system-label label="LBL_CHARSET" class="slds-m-right--x-small slds-text-title--caps"></system-label> <span>{{databaseData?.charset}}</span></div><div class="slds-grid slds-grid--vertical-align-center"><system-label label="LBL_COLLATION" class="slds-m-right--x-small slds-text-title--caps"></system-label> <span>{{databaseData?.collation}}</span></div></div><div class="slds-grid slds-grid--vertical-align-end"><div class="slds-form-element slds-m-right--x-small"><label class="slds-form-element__label"><system-label label="LBL_CONVERT_TO_CHARSET"></system-label></label><div class="slds-form-element__control"><div class="slds-select_container"><select [(ngModel)]="convertToCharset" class="slds-select"><option value="utf8mb4">UTF8 Multibyte 4</option><option value="utf8">utf8</option></select></div></div></div><button (click)="convertDatabase()" [disabled]="!convertToCharset" class="slds-button slds-button--brand" style="margin-bottom: 1px;"><system-label label="LBL_CONVERT_DATABASE"></system-label></button></div></div><div class="slds-grid slds-grid--vertical-align-center slds-border--bottom slds-p-around--x-small"><input type="text" [(ngModel)]="listFilterTerm" system-placeholder="LBL_SEARCH" class="slds-input slds-m-right--x-small"><system-utility-icon icon="filterList" size="x-small"></system-utility-icon></div><div class="slds-scrollable--y slds-grow" style="min-height: 0"><table class="slds-table slds-table_bordered slds-table_fixed-layout slds-table--header-fixed" role="grid"><thead><tr class="slds-line-height_reset"><th class="slds-cell-shrink"><system-checkbox [indeterminate]="selectedTables.length > 0 && selectedTables.length < filteredTables.length" [ngModel]="selectedTables.length == filteredTables.length" (ngModelChange)="toggleSelectAll($event)"></system-checkbox></th><th scope="col"><div class="slds-truncate"><system-label label="LBL_NAME"></system-label></div></th><th scope="col"><div class="slds-truncate"><system-label label="LBL_CHARSET"></system-label></div></th><th scope="col"><div class="slds-truncate"><system-label label="LBL_COLLATION"></system-label></div></th></tr></thead><tbody><tr *ngFor="let table of filteredTables" class="slds-hint-parent"><td class="slds-text-align_right" role="gridcell"><system-checkbox [(ngModel)]="table.selected" (ngModelChange)="selectTable($event, table.table_name)"></system-checkbox></td><td><div class="slds-truncate">{{table.table_name}}</div></td><td><div class="slds-truncate">{{table.character_set_name}}</div></td><td><div class="slds-truncate">{{table.collation_name}}</div></td></tr></tbody><tbody *ngIf="tables.length === 0"><tr class="slds-hint-parent"><td><system-stencil></system-stencil></td><td><system-stencil></system-stencil></td><td><system-stencil></system-stencil></td><td><system-stencil></system-stencil></td></tr><tr class="slds-hint-parent"><td><system-stencil></system-stencil></td><td><system-stencil></system-stencil></td><td><system-stencil></system-stencil></td><td><system-stencil></system-stencil></td></tr><tr class="slds-hint-parent"><td><system-stencil></system-stencil></td><td><system-stencil></system-stencil></td><td><system-stencil></system-stencil></td><td><system-stencil></system-stencil></td></tr></tbody></table></div></div></system-modal-content><system-modal-footer><button (click)="close()" class="slds-button slds-button--neutral"><system-label label="LBL_CANCEL"></system-label></button> <button (click)="convertTables()" [disabled]="selectedTables.length == 0 || !convertToCharset" class="slds-button slds-button--brand"><system-label label="LBL_CONVERT_TABLES"></system-label></button></system-modal-footer></system-modal>'}),__metadata("design:paramtypes",[services_1.backend,services_1.toast,services_1.language])],AdministrationDictRepairConvertDBCharsetModal)}();exports.AdministrationDictRepairConvertDBCharsetModal=AdministrationDictRepairConvertDBCharsetModal;var AdministrationConfigEditor=function(){function AdministrationConfigEditor(e,s,t,i){this.metadata=e,this.language=s,this.backend=t,this.modal=i,this.componentconfig={},this.configvalues={},this.loading=!0}return AdministrationConfigEditor.prototype.ngOnInit=function(){var t=this;this.modal.openModal("SystemLoadingModal").subscribe(function(s){t.backend.getRequest("configuration/configurator/editor/"+t.componentconfig.category).subscribe(function(e){t.configvalues=e,t.loading=!1,s.instance.self.destroy()})})},Object.defineProperty(AdministrationConfigEditor.prototype,"items",{get:function(){for(var e=[],s=0,t=this.componentconfig.items;s<t.length;s++){var i=t[s];!0!==i.hidden&&e.push(i)}return e},enumerable:!1,configurable:!0}),AdministrationConfigEditor.prototype.save=function(){var t=this;this.loading=!0,this.modal.openModal("SystemLoadingModal").subscribe(function(s){s.instance.messagelabel="LBL_SAVING_DATA",t.backend.postRequest("configuration/configurator/editor/"+t.componentconfig.category,[],{config:t.configvalues}).subscribe(function(e){t.loading=!1,s.instance.self.destroy()})})},__decorate([core_1.Component({selector:"administration-configeditor",template:'<div class="slds-grid slds-grid--align-spread slds-p-around--medium"><h2 class="slds-text-heading--medium">editor</h2><button class="slds-button slds-button--neutral" (click)="save()"><system-label label="LBL_SAVE"></system-label></button></div><table class="slds-table slds-table--bordered slds-table--cell-buffer"><thead><tr class="slds-text-title--caps"><th scope="col"><system-label label="LBL_NAME"></system-label></th><th scope="col"><system-label label="LBL_VALUE"></system-label></th></tr></thead><tbody><tr style="vertical-align: middle" class="slds-align-top" *ngFor="let item of items"><td>{{item.name}}</td><td><ng-container [ngSwitch]="item.type"><system-checkbox *ngSwitchCase="\'bool\'" [(ngModel)]="configvalues[item.name]"></system-checkbox><div *ngSwitchDefault class="slds-form-element__control"><input type="text" class="slds-input" [disabled]="loading" [(ngModel)]="configvalues[item.name]"></div></ng-container></td></tr></tbody></table>'}),__metadata("design:paramtypes",[services_1.metadata,services_1.language,services_1.backend,services_1.modal])],AdministrationConfigEditor)}();exports.AdministrationConfigEditor=AdministrationConfigEditor;var AdministrationJobMethods=function(){function AdministrationJobMethods(e,s,t,i){this.model=e,this.view=s,this.cdRef=t,this.backend=i,this._methods=[],this.availableClasses=[],this._class="",this._method="",this.classExists=!1}return AdministrationJobMethods.prototype.setClassname=function(e){this.className=e,this._class=e.name,""!=this._class?this.validateNamespace():(this._method="",this._methods=[],this.classExists=!1),this.joinValue()},Object.defineProperty(AdministrationJobMethods.prototype,"methodName",{get:function(){return this._method},set:function(e){this._method=e,this.joinValue()},enumerable:!1,configurable:!0}),AdministrationJobMethods.prototype.ngOnInit=function(){this.loadAvailableClasses(),this.subscribeToFieldChanges(),this.subscribeToView()},AdministrationJobMethods.prototype.subscribeToView=function(){var e=this;this.view.mode$.subscribe(function(){return e.cdRef.detectChanges()})},AdministrationJobMethods.prototype.loadAvailableClasses=function(){var s=this;this.backend.getRequest("module/SchedulerJobTasks/classes").subscribe(function(e){s.availableClasses=e.map(function(e){return{id:e,name:e}}).sort()})},AdministrationJobMethods.prototype.subscribeToFieldChanges=function(){var e=this;this.model.observeFieldChanges("method").subscribe(function(){return e.splitValue()})},AdministrationJobMethods.prototype.validateNamespace=function(){var s=this;this.backend.getRequest("system/checkclass/"+btoa(this._class)).subscribe(function(e){s.classExists=e.classexists,s._methods=e.methods,s.cdRef.detectChanges()})},AdministrationJobMethods.prototype.splitValue=function(){var e;this._value&&(e=this._value.split("->"),this._class=e[0],this.className={id:this._class,name:this._class},this._method=e[1],this.validateNamespace())},AdministrationJobMethods.prototype.joinValue=function(){""!=this._class?this._value=this._class+"->"+this._method:this._value="",this.model.setField("method",this._value)},__decorate([core_1.Component({selector:"administration-job-methods",template:'<system-section titlelabel="LBL_METHOD"><div *ngIf="!view.isEditMode()" class="slds-p-around--xx-small"><div><system-stencil *ngIf="model.isLoading"></system-stencil><div *ngIf="!model.isLoading" class="slds-has-divider--bottom slds-p-vertical--x-small"><div class="slds-form-element__label slds-truncate"><system-label label="LBL_METHOD"></system-label></div><div class="slds-grid slds-grid--vertical-align-center slds-grid--align-spread"><div class="slds-truncate slds-grow">{{model.data.method}}</div><button style="float: right" class="slds-button slds-button--icon slds-m-left--xx-small" (click)="view.setEditMode()"><system-button-icon [icon]="\'edit\'"></system-button-icon></button></div></div></div><div><system-stencil *ngIf="model.isLoading"></system-stencil><div *ngIf="!model.isLoading" class="slds-has-divider--bottom slds-p-vertical--x-small"><div class="slds-form-element__label slds-truncate"><system-label label="LBL_PARAMS"></system-label></div><div class="slds-grid slds-grid--vertical-align-center slds-grid--align-spread"><div class="slds-truncate slds-grow">{{model.data.method_params}}</div><button style="float: right" class="slds-button slds-button--icon slds-m-left--xx-small" (click)="view.setEditMode()"><system-button-icon [icon]="\'edit\'"></system-button-icon></button></div></div></div></div><div *ngIf="view.isEditMode()"><div class="slds-grid slds-p-around--xx-small"><div class="slds-form-element slds-p-horizontal--xx-small slds-size--1-of-1"><label class="slds-form-element__label"><abbr class="slds-required ng-star-inserted">*</abbr> <system-label label="LBL_METHOD"></system-label></label><div class="slds-grid slds-grid--vertical-align-center slds-gutters_direct-xx-small"><system-select [selectList]="availableClasses" [(ngModel)]="className" (ngModelChange)="setClassname($event)" class="slds-grow"></system-select><div class="slds-col slds-size--1-of-3 slds-select_container"><select class="slds-select" [disabled]="!classExists || _methods.length == 0" [(ngModel)]="methodName"><option *ngFor="let o of _methods" [value]="o">{{o}}</option></select></div></div></div></div><div class="slds-grid slds-p-around--xx-small"><div class="slds-form-element slds-p-horizontal--xx-small slds-size--1-of-1"><label class="slds-form-element__label"><system-label label="LBL_PARAMS"></system-label></label><div class="slds-form-element__control"><textarea [(ngModel)]="model.data.method_params" class="slds-textarea"></textarea></div></div></div></div></system-section>',changeDetection:core_1.ChangeDetectionStrategy.OnPush}),__metadata("design:paramtypes",[services_1.model,services_1.view,core_1.ChangeDetectorRef,services_1.backend])],AdministrationJobMethods)}();exports.AdministrationJobMethods=AdministrationJobMethods;var AdministrationJobLog=function(){function AdministrationJobLog(e,s,t,i,l,a,o,n){this.model=e,this.language=s,this.metadata=t,this.broadcast=i,this.elementRef=l,this.modal=a,this.userpreferences=o,this.backend=n,this.jobLogs=[],this.isLoading=!1,this.isReloading=!1,this.subscription=new rxjs_1.Subscription,this.totalLimit=10,this.expanded=!0}return AdministrationJobLog.prototype.ngOnInit=function(){this.getData(),this.subscribeToJobActions()},AdministrationJobLog.prototype.ngOnDestroy=function(){this.subscription.unsubscribe()},AdministrationJobLog.prototype.openMessageInModal=function(e,s){s="failed"==s?"error":"success";this.modal.info(e,this.language.getLabel("LBL_MESSAGE"),s)},AdministrationJobLog.prototype.trackByFn=function(e,s){return s.id},AdministrationJobLog.prototype.subscribeToJobActions=function(){var s=this;this.subscription=this.broadcast.message$.subscribe(function(e){"job.run"==e.messagetype&&s.reloadData()})},AdministrationJobLog.prototype.getData=function(){var s=this;this.totalLimit=10,this.isLoading=!0,this.backend.getRequest("module/"+this.model.module+"/"+this.model.id+"/log",{offset:0,limit:10}).subscribe(function(e){s.jobLogs=s.mapList(e.list),s.sortList(),s.totalLines=e.count,s.isLoading=!1},function(e){return s.isLoading=!1})},AdministrationJobLog.prototype.getMoreData=function(){var s=this,e={sort:{sortfield:"executed_on",sortdirection:"DESC"},offset:this.jobLogs.length,limit:10,getcount:!0};this.totalLimit+=10,this.isLoading=!0,this.backend.getRequest("module/"+this.model.module+"/"+this.model.id+"/log",e).subscribe(function(e){s.jobLogs=__spreadArray(__spreadArray([],s.jobLogs),s.mapList(e.list)),s.sortList(),s.totalLines=e.count,s.isLoading=!1},function(e){return s.isLoading=!1})},AdministrationJobLog.prototype.reloadData=function(){var e,s=this;this.isLoading||(this.jobLogs=[],e={offset:0,limit:this.totalLimit},this.isLoading=this.isReloading=!0,this.backend.getRequest("module/"+this.model.module+"/"+this.model.id+"/log",e).subscribe(function(e){s.jobLogs=s.mapList(e.list),s.sortList(),s.totalLines=e.count,s.isLoading=s.isReloading=!1},function(e){return s.isLoading=s.isReloading=!1}))},AdministrationJobLog.prototype.mapList=function(e){var s=this;return e.map(function(e){return e.executed_on=moment(moment.utc(e.executed_on)).tz(s.userpreferences.toUse.timezone).format(s.userpreferences.getDateFormat()+" "+s.userpreferences.getTimeFormat()),e.resolutionClass="slds-text-color_"+("failed"==e.resolution?"error":"success"),e})},AdministrationJobLog.prototype.sortList=function(){this.jobLogs.sort(function(e,s){return e.executed_on<s.executed_on?1:e.executed_on>s.executed_on?-1:0})},AdministrationJobLog.prototype.toggleExpand=function(e){e.stopPropagation(),this.expanded=!this.expanded},__decorate([core_1.Component({selector:"administration-job-log",template:'<div class="slds-card slds-card_boundary slds-m-bottom--medium"><div class="slds-card__header slds-grid slds-grid--vertical-align-center"><header class="slds-media slds-media--center slds-has-flexi-truncate"><system-icon icon="recent" size="small"></system-icon><div class="slds-media__body slds-truncate slds-grid slds-grid--vertical-align-center"><h2><a href="javascript:void(0);" class="slds-text-link--reset"><span class="slds-text-heading--small"><system-label label="LBL_LOG_ENTRIES"></system-label> ({{jobLogs.length}} <system-label label="LBL_OF"></system-label> {{totalLines}})</span></a></h2><system-utility-icon class="slds-m-horizontal--xx-small" icon="up" size="x-small" (click)="toggleExpand($event)" [@animateicon]="expanded ? \'open\' : \'closed\'"></system-utility-icon></div></header><button (click)="reloadData()" [disabled]="!expanded" class="slds-button slds-button--icon"><system-button-icon class="slds-p-horizontal--xxx-small" icon="refresh"></system-button-icon></button></div><div @displaycard *ngIf="expanded"><div class="slds-card__body slds-size--1-of-1 slds-scrollable--y" style="max-height: 350px"><table class="slds-table slds-table--bordered slds-table--cell-buffer slds-table--fixed-layout" role="grid"><thead><tr class="slds-line-height_reset"><th scope="col"><div class="slds-truncate"><system-label [label]="model.module == \'SchedulerJobs\' ? \'LBL_TASK\' : \'LBL_SCHEDULERJOB\'"></system-label></div></th><th scope="col"><div class="slds-truncate"><system-label label="LBL_EXECUTE_TIME"></system-label></div></th><th scope="col"><div class="slds-truncate"><system-label label="LBL_RESOLUTION"></system-label></div></th><th scope="col"><div class="slds-truncate"><system-label label="LBL_MESSAGE"></system-label></div></th><th class="slds-cell-shrink" scope="col"></th></tr></thead><tbody><tr *ngFor="let log of jobLogs; trackBy: trackByFn" [system-model-provider]="{module: log.rel_module, id: log.rel_id, data: null}" class="slds-hint-parent" [ngStyle]="{\'opacity\':isReLoading?0.33:1}"><td [system-model-popover]="!!log.rel_id" [enablelink]="!!log.rel_id"><div class="slds-truncate">{{log.name}}</div></td><td><div class="slds-truncate">{{log.executed_on}}</div></td><td><div class="slds-truncate" [ngClass]="log.resolutionClass">{{log.resolution}}</div></td><td><div class="slds-truncate" [title]="log.message">{{log.message}}</div></td><td class="slds-cell-shrink"><button (click)="openMessageInModal(log.message, log.resolution)" class="slds-button slds-button--icon"><system-button-icon icon="info"></system-button-icon></button></td></tr></tbody></table><div *ngIf="!isLoading && !isReloading && jobLogs.length == 0" class="slds-align_absolute-center slds-p-around--medium"><system-label label="LBL_NO_ENTRIES"></system-label></div><div *ngIf="isLoading || isReloading" class="slds-align_absolute-center slds-p-around--medium"><system-spinner></system-spinner></div></div></div><footer class="slds-card__footer slds-p-around--xx-small"><div class="slds-grid slds-grid--align-center" style="min-height: 32px"><button *ngIf="expanded" [disabled]="isLoading || jobLogs.length == totalLines" (click)="getMoreData()" class="slds-button"><system-label label="LBL_MORE"></system-label></button></div></footer></div>',animations:[animations_1.trigger("animateicon",[animations_1.state("open",animations_1.style({transform:"scale(1, 1)"})),animations_1.state("closed",animations_1.style({transform:"scale(1, -1)"})),animations_1.transition("open => closed",[animations_1.animate(".5s")]),animations_1.transition("closed => open",[animations_1.animate(".5s")])]),animations_1.trigger("displaycard",[animations_1.transition(":enter",[animations_1.style({opacity:0,height:"0px",overflow:"hidden"}),animations_1.animate(".5s",animations_1.style({height:"*",opacity:1})),animations_1.style({overflow:"unset"})]),animations_1.transition(":leave",[animations_1.style({overflow:"hidden"}),animations_1.animate(".5s",animations_1.style({height:"0px",opacity:0}))])])]}),__metadata("design:paramtypes",[services_1.model,services_1.language,services_1.metadata,services_1.broadcast,core_1.ElementRef,services_1.modal,services_1.userpreferences,services_1.backend])],AdministrationJobLog)}();exports.AdministrationJobLog=AdministrationJobLog;var AdministrationJobRunButton=function(){function AdministrationJobRunButton(e,s,t,i,l,a,o){this.model=e,this.language=s,this.metadata=t,this.broadcast=i,this.toast=l,this.modal=a,this.backend=o}return AdministrationJobRunButton.prototype.execute=function(){var t=this;this.modal.openModal("SystemLoadingModal",!1).subscribe(function(s){t.backend.postRequest("module/SchedulerJobs/"+t.model.id+"/run").subscribe(function(e){s.instance.self.destroy(),t.model.getData(),e?t.toast.sendToast(t.language.getLabel("MSG_SUCCESSFULLY_EXECUTED"),"success"):t.toast.sendToast(t.language.getLabel("ERR_FAILED_TO_EXECUTE"),"error"),t.broadcast.broadcastMessage("job.run")},function(e){s.instance.self.destroy(),t.toast.sendToast(t.language.getLabel("ERR_FAILED_TO_EXECUTE"),"error"),t.broadcast.broadcastMessage("job.run")})})},__decorate([core_1.Component({selector:"administration-job-run-button",template:'<span><system-label label="LBL_RUN_NOW"></system-label></span>'}),__metadata("design:paramtypes",[services_1.model,services_1.language,services_1.metadata,services_1.broadcast,services_1.toast,services_1.modal,services_1.backend])],AdministrationJobRunButton)}();exports.AdministrationJobRunButton=AdministrationJobRunButton;var AdministrationJobScheduleButton=function(){function AdministrationJobScheduleButton(e,s,t,i,l,a,o){this.model=e,this.language=s,this.metadata=t,this.broadcast=i,this.toast=l,this.modal=a,this.backend=o}return AdministrationJobScheduleButton.prototype.execute=function(){var t=this;this.modal.openModal("SystemLoadingModal",!1).subscribe(function(s){t.backend.postRequest("module/SchedulerJobs/"+t.model.id+"/schedule").subscribe(function(e){s.instance.self.destroy(),t.model.getData(),e?t.toast.sendToast(t.language.getLabel("MSG_SUCCESSFULLY_EXECUTED"),"success"):t.toast.sendToast(t.language.getLabel("ERR_FAILED_TO_EXECUTE"),"error"),t.broadcast.broadcastMessage("job.run")},function(e){s.instance.self.destroy(),t.toast.sendToast(t.language.getLabel("ERR_FAILED_TO_EXECUTE"),"error"),t.broadcast.broadcastMessage("job.run")})})},__decorate([core_1.Component({selector:"administration-job-schedule-button",template:'<span><system-label label="LBL_SCHEDULE_NOW"></system-label></span>'}),__metadata("design:paramtypes",[services_1.model,services_1.language,services_1.metadata,services_1.broadcast,services_1.toast,services_1.modal,services_1.backend])],AdministrationJobScheduleButton)}();exports.AdministrationJobScheduleButton=AdministrationJobScheduleButton;var AdministrationJobKillButton=function(){function AdministrationJobKillButton(e,s,t,i){this.model=e,this.toast=s,this.language=t,this.backend=i}return Object.defineProperty(AdministrationJobKillButton.prototype,"disabled",{get:function(){return!this.model.data.process_id},enumerable:!1,configurable:!0}),AdministrationJobKillButton.prototype.execute=function(){var t=this;this.backend.postRequest("module/SchedulerJobs/"+this.model.id+"/kill").subscribe(function(e){var s=e?"success":"error";t.toast.sendToast(t.language.getLabel(e?"MSG_SUCCESSFULLY_EXECUTED":"ERR_FAILED_TO_EXECUTE"),s)})},__decorate([core_1.Component({selector:"administration-job-kill-button",template:'<span><system-label label="LBL_KILL"></system-label></span>'}),__metadata("design:paramtypes",[services_1.model,services_1.toast,services_1.language,services_1.backend])],AdministrationJobKillButton)}();exports.AdministrationJobKillButton=AdministrationJobKillButton;var AdministrationJobTaskRunButton=function(){function AdministrationJobTaskRunButton(e,s,t,i,l,a,o){this.model=e,this.language=s,this.metadata=t,this.broadcast=i,this.toast=l,this.modal=a,this.backend=o}return AdministrationJobTaskRunButton.prototype.execute=function(){var t=this;this.modal.openModal("SystemLoadingModal",!1).subscribe(function(s){t.backend.postRequest("module/SchedulerJobTasks/"+t.model.id+"/run").subscribe(function(e){s.instance.self.destroy(),e?t.toast.sendToast(t.language.getLabel("MSG_SUCCESSFULLY_EXECUTED"),"success"):t.toast.sendToast(t.language.getLabel("ERR_FAILED_TO_EXECUTE"),"error"),t.broadcast.broadcastMessage("job.run")},function(e){s.instance.self.destroy(),t.toast.sendToast(t.language.getLabel("ERR_FAILED_TO_EXECUTE"),"error"),t.broadcast.broadcastMessage("job.run")})})},__decorate([core_1.Component({selector:"administration-job-task-run-button",template:'<span><system-label label="LBL_RUN_NOW"></system-label></span>'}),__metadata("design:paramtypes",[services_1.model,services_1.language,services_1.metadata,services_1.broadcast,services_1.toast,services_1.modal,services_1.backend])],AdministrationJobTaskRunButton)}();exports.AdministrationJobTaskRunButton=AdministrationJobTaskRunButton;var AdministrationJobRunningList=function(){function AdministrationJobRunningList(e,s,t,i,l){this.metadata=e,this.toast=s,this.modal=t,this.language=i,this.backend=l,this.hasBoxClass=!1,this.runningJobs={list:[],total:0,isLoading:!1}}return AdministrationJobRunningList.prototype.ngOnInit=function(){this.reloadList()},AdministrationJobRunningList.prototype.reloadList=function(){var s=this;this.runningJobs.list=[],this.runningJobs.total=0,this.runningJobs.hasError=!1;var e=this.metadata.getComponentConfig("AdministrationJobRunningList","SchedulerJobs");if(!e.moduleFilter)return this.runningJobs.hasError=!0,console.error("Mssing module filter for component AdministrationJobRunningList");this.runningJobs.isLoading=!0;e={modulefilter:e.moduleFilter,start:0,limit:20};this.backend.getList("SchedulerJobs",[{sortfield:"last_run_date",sortdirection:"DESC"}],e).subscribe(function(e){s.runningJobs.list=e.list,s.runningJobs.total=e.totalcount,s.runningJobs.isLoading=!1},function(e){s.runningJobs.hasError=!0,s.runningJobs.isLoading=!1})},AdministrationJobRunningList.prototype.loadMore=function(){var s=this;if(this.runningJobs.isLoading||this.runningJobs.list.length>=this.runningJobs.total)return!1;var e=this.metadata.getComponentConfig("AdministrationJobRunningList","SchedulerJobs");if(!e.moduleFilter)return this.runningJobs.hasError=!0,console.error("Mssing module filter for component AdministrationJobRunningList");this.runningJobs.isLoading=!0;e={modulefilter:e.moduleFilter,start:this.runningJobs.list.length,limit:20};this.backend.getList("SchedulerJobs",[{sortfield:"last_run_date",sortdirection:"DESC"}],e).subscribe(function(e){s.runningJobs.list=e.list,s.runningJobs.total=e.totalcount,s.runningJobs.isLoading=!1},function(e){s.runningJobs.hasError=!0,s.runningJobs.isLoading=!1})},AdministrationJobRunningList.prototype.killJob=function(s){var i=this;this.modal.confirm("MSG_CONFIRM_KILL",this.language.getLabel("LBL_KILL")).subscribe(function(e){e&&i.backend.postRequest("module/SchedulerJobs/"+s.id+"/kill").subscribe(function(e){var s=e?"MSG_SUCCESSFULLY_EXECUTED":"ERR_FAILED_TO_EXECUTE",t=e?"success":"error";e&&i.reloadList(),i.toast.sendToast(i.language.getLabel(s),t)})})},AdministrationJobRunningList.prototype.trackByFn=function(e,s){return s.id},__decorate([core_1.Input(),__metadata("design:type",Object)],AdministrationJobRunningList.prototype,"hasBoxClass",void 0),__decorate([core_1.Component({selector:"administration-job-running-list",template:'<div [ngStyle]="!hasBoxClass ? {\'border\': 0, \'box-shadow\': \'none\'} : undefined" class="slds-card slds-card_boundary slds-grid slds-grid--vertical slds-grow slds-height_full" style="min-height: 0"><div class="slds-card__header slds-grid slds-grid--vertical-align-center"><header class="slds-media slds-media--center slds-has-flexi-truncate"><system-icon icon="custom6" sprite="custom" divClass="" style="transform: rotate(90deg)" class="slds-m-right--small"></system-icon><div class="slds-media__body slds-truncate slds-grid slds-grid--vertical-align-center"><h2><a href="javascript:void(0);" class="slds-text-link--reset"><span class="slds-text-heading--small"><system-label label="LBL_RUNNING_JOBS"></system-label> ({{runningJobs.list.length}} <system-label label="LBL_OF"></system-label> {{runningJobs.total}})</span></a></h2></div></header><button (click)="reloadList()" class="slds-button slds-button--icon"><system-button-icon class="slds-p-horizontal--xxx-small" icon="refresh"></system-button-icon></button></div><div class="slds-grow slds-grid slds-grid--vertical" style="min-height: 0;"><div class="slds-card__body slds-size--1-of-1 slds-grid slds-grid--vertical slds-grow slds-scrollable--y" style="min-height: 0; flex: initial"><table *ngIf="runningJobs.list.length > 0" class="slds-table slds-table--bordered slds-table--cell-buffer slds-table--fixed-layout slds-table--header-fixed" role="grid"><thead><tr class="slds-line-height_reset"><th scope="col"><div class="slds-truncate"><system-label label="LBL_NAME"></system-label></div></th><th scope="col"><div class="slds-truncate"><system-label label="LBL_RUNNING_SINCE"></system-label></div></th><th scope="col"><div class="slds-truncate"><system-label label="LBL_INTERVAL"></system-label></div></th><th class="slds-cell-shrink" scope="col"></th></tr></thead><tbody [system-view-provider]="{displayLabels: false, editable: false}"><tr *ngFor="let job of runningJobs.list; trackBy: trackByFn" [system-model-provider]="{module: \'SchedulerJobs\', id: job.id, data: job}" class="slds-hint-parent"><td><field-container field="name" [fieldconfig]="{link: true}" [fielddisplayclass]="\'slds-truncate slds-p-horizontal--x-small\'"></field-container></td><td><field-container field="last_run_date" [fielddisplayclass]="\'slds-truncate slds-p-horizontal--x-small\'"></field-container></td><td><field-container field="job_interval" [fieldconfig]="{fieldtype: \'croninterval\'}" [fielddisplayclass]="\'slds-truncate slds-p-horizontal--x-small\'"></field-container></td><td class="slds-cell-shrink"><button (click)="killJob(job)" system-title="LBL_KILL" class="slds-button slds-button--icon"><system-button-icon icon="stop"></system-button-icon></button></td></tr></tbody></table><div *ngIf="!runningJobs.hasError && !runningJobs.isLoading && runningJobs.list.length == 0" class="slds-align_absolute-center slds-height_full slds-has-divider--top-space slds-size--1-of-1"><system-label label="MSG_NO_RECORDS_FOUND" class="slds-p-top--small"></system-label></div><div *ngIf="!runningJobs.isLoading && runningJobs.hasError" class="slds-align_absolute-center slds-height_full slds-has-divider--top-space slds-size--1-of-1"><system-label label="ERR_LOADING_RECORDS" class="slds-p-top--small"></system-label></div><div *ngIf="runningJobs.isLoading" class="slds-align_absolute-center slds-p-bottom--small slds-height_full slds-has-divider--top-space slds-size--1-of-1"><system-spinner class="slds-p-top--small"></system-spinner></div></div></div><footer class="slds-card__footer slds-p-around--xx-small"><div class="slds-grid slds-grid--align-center" style="min-height: 32px"><button [disabled]="runningJobs.hasError || runningJobs.isLoading || runningJobs.list.length == runningJobs.total" (click)="loadMore()" class="slds-button"><system-label label="LBL_MORE"></system-label></button></div></footer></div>'}),__metadata("design:paramtypes",[services_1.metadata,services_1.toast,services_1.modal,services_1.language,services_1.backend])],AdministrationJobRunningList)}();exports.AdministrationJobRunningList=AdministrationJobRunningList;var AdministrationJobFailedList=function(){function AdministrationJobFailedList(e,s,t,i){this.language=e,this.modal=s,this.metadata=t,this.backend=i,this.hasBoxClass=!1,this.failedJobs={list:[],total:0,isLoading:!1}}return AdministrationJobFailedList.prototype.ngOnInit=function(){this.reloadList()},AdministrationJobFailedList.prototype.reloadList=function(){var s=this;this.failedJobs.list=[],this.failedJobs.total=0,this.failedJobs.hasError=!1;var e=this.metadata.getComponentConfig("AdministrationJobFailedList","SchedulerJobs");if(!e.moduleFilter)return this.failedJobs.hasError=!0,console.error("Mssing module filter for component AdministrationJobFailedList");this.failedJobs.isLoading=!0;e={modulefilter:e.moduleFilter,start:0,limit:20};this.backend.getList("SchedulerJobs",[{sortfield:"last_run_date",sortdirection:"DESC"}],e).subscribe(function(e){s.failedJobs.list=e.list,s.failedJobs.total=e.totalcount,s.failedJobs.isLoading=!1},function(e){s.failedJobs.isLoading=!1,s.failedJobs.hasError=!0})},AdministrationJobFailedList.prototype.loadMore=function(){var s=this;if(this.failedJobs.isLoading||this.failedJobs.list.length>=this.failedJobs.total)return!1;var e=this.metadata.getComponentConfig("AdministrationJobFailedList","SchedulerJobs");if(!e.moduleFilter)return this.failedJobs.hasError=!0,console.error("Mssing module filter for component AdministrationJobFailedList");this.failedJobs.isLoading=!0;e={modulefilter:e.moduleFilter,start:this.failedJobs.list.length,limit:20};this.backend.getList("SchedulerJobs",[{sortfield:"last_run_date",sortdirection:"DESC"}],e).subscribe(function(e){s.failedJobs.list=e.list,s.failedJobs.total=e.totalcount,s.failedJobs.isLoading=!1},function(e){s.failedJobs.isLoading=!1,s.failedJobs.hasError=!0})},AdministrationJobFailedList.prototype.openMessageInModal=function(e,s){s="failed"==s?"error":"success";this.modal.info(e,this.language.getLabel("LBL_MESSAGE"),s)},AdministrationJobFailedList.prototype.trackByFn=function(e,s){return s.id},__decorate([core_1.Input(),__metadata("design:type",Object)],AdministrationJobFailedList.prototype,"hasBoxClass",void 0),__decorate([core_1.Component({selector:"administration-job-failed-list",template:'<div [ngStyle]="!hasBoxClass ? {\'border\': 0, \'box-shadow\': \'none\'} : undefined" class="slds-card slds-card_boundary slds-grid slds-grid--vertical slds-grow slds-height_full" style="min-height: 0"><div class="slds-card__header slds-grid slds-grid--vertical-align-center"><header class="slds-media slds-media--center slds-has-flexi-truncate"><system-icon icon="custom82" sprite="custom"></system-icon><div class="slds-media__body slds-truncate slds-grid slds-grid--vertical-align-center"><h2><a href="javascript:void(0);" class="slds-text-link--reset"><span class="slds-text-heading--small"><system-label label="LBL_FAILED_JOBS"></system-label> ({{failedJobs.list.length}} <system-label label="LBL_OF"></system-label> {{failedJobs.total}})</span></a></h2></div></header><button (click)="reloadList()" class="slds-button slds-button--icon"><system-button-icon class="slds-p-horizontal--xxx-small" icon="refresh"></system-button-icon></button></div><div class="slds-grow slds-grid slds-grid--vertical" style="min-height: 0;"><div class="slds-card__body slds-size--1-of-1 slds-grid slds-grid--vertical slds-grow slds-scrollable--y" style="min-height: 0; flex: initial"><table *ngIf="failedJobs.list.length > 0" class="slds-table slds-table--bordered slds-table--cell-buffer slds-table--fixed-layout slds-table--header-fixed" role="grid"><thead><tr class="slds-line-height_reset"><th scope="col"><div class="slds-truncate"><system-label label="LBL_NAME"></system-label></div></th><th scope="col"><div class="slds-truncate"><system-label label="LBL_LAST_RUN"></system-label></div></th><th scope="col"><div class="slds-truncate"><system-label label="LBL_LAST_MESSAGE"></system-label></div></th><th class="slds-cell-shrink" scope="col"></th></tr></thead><tbody [system-view-provider]="{displayLabels: false, editable: false}"><tr *ngFor="let job of failedJobs.list; trackBy: trackByFn" [system-model-provider]="{module: \'SchedulerJobs\', id: job.id, data: job}" class="slds-hint-parent"><td><field-container field="name" [fieldconfig]="{link: true}" [fielddisplayclass]="\'slds-truncate slds-p-horizontal--x-small\'"></field-container></td><td><field-container field="last_run_date" [fielddisplayclass]="\'slds-truncate slds-p-horizontal--x-small\'"></field-container></td><td><field-container field="last_run_message" [fieldconfig]="{truncate: true}" [fielddisplayclass]="\'slds-truncate slds-p-horizontal--x-small\'"></field-container></td><td class="slds-cell-shrink"><button (click)="openMessageInModal(job.last_run_message, job.resolution)" system-title="LBL_LAST_MESSAGE" class="slds-button slds-button--icon"><system-button-icon icon="info"></system-button-icon></button></td></tr></tbody></table><div *ngIf="!failedJobs.hasError && !failedJobs.isLoading && failedJobs.list.length == 0" class="slds-align_absolute-center slds-height_full slds-has-divider--top-space slds-size--1-of-1"><system-label label="MSG_NO_RECORDS_FOUND" class="slds-p-top--small"></system-label></div><div *ngIf="!failedJobs.isLoading && failedJobs.hasError" class="slds-align_absolute-center slds-height_full slds-has-divider--top-space slds-size--1-of-1"><system-label label="ERR_LOADING_RECORDS" class="slds-p-top--small"></system-label></div><div *ngIf="failedJobs.isLoading" class="slds-align_absolute-center slds-p-bottom--small slds-height_full slds-has-divider--top-space slds-size--1-of-1"><system-spinner class="slds-p-top--small"></system-spinner></div></div></div><footer class="slds-card__footer slds-p-around--xx-small"><div class="slds-grid slds-grid--align-center" style="min-height: 32px"><button [disabled]="failedJobs.isLoading || failedJobs.list.length == failedJobs.total" (click)="loadMore()" class="slds-button"><system-label label="LBL_MORE"></system-label></button></div></footer></div>'}),__metadata("design:paramtypes",[services_1.language,services_1.modal,services_1.metadata,services_1.backend])],AdministrationJobFailedList)}();exports.AdministrationJobFailedList=AdministrationJobFailedList;var AdministrationJobCockpit=function(){function AdministrationJobCockpit(e,s){this.model=e,this.modelList=s}return __decorate([core_1.Component({selector:"administration-job-cockpit",template:'<div class="slds-grid slds-height_full"><div class="slds-height_full slds-size--1-of-2 slds-border--right slds-p-around--medium"><div class="slds-p-bottom--small slds-grid slds-grid--vertical" style="max-height: 50%"><administration-job-running-list [hasBoxClass]="true" class="slds-grid slds-grid--vertical slds-grow" style="min-height: 0"></administration-job-running-list></div><div class="slds-p-top--small slds-grid slds-grid--vertical" style="max-height: 50%"><administration-job-failed-list [hasBoxClass]="true" class="slds-grid slds-grid--vertical slds-grow" style="min-height: 0"></administration-job-failed-list></div></div><div class="slds-size--1-of-2 slds-height_full slds-grid slds-grid--vertical"><div style="display: block; width: 100%; min-height: 0;" class="slds-grow slds-is-relative"><object-list class="slds-grow slds-height_full slds-size--1-of-1" style="display: block"></object-list><div @animatepanel *ngIf="modelList.displayAggregates" class="slds-is-absolute slds-panel slds-panel--filters slds-filters__body slds-nowrap slds-scrollable--y" style="width: 320px; height: 100%; top:0; right: 0;z-index: 99;" [system-model-provider]="{module: modelList.module}"><div class="slds-filters__body slds-grid_vertical"><div class="slds-m-vertical--xx-small" *ngFor="let aggregate of modelList.moduleAggregates"><object-listview-aggregate [aggregate]="aggregate"></object-listview-aggregate></div></div></div></div></div></div>'}),__metadata("design:paramtypes",[services_1.model,services_1.modellist])],AdministrationJobCockpit)}();exports.AdministrationJobCockpit=AdministrationJobCockpit;var AdministrationDictionaryManagerItemField=function(){function e(e){this.dictionary=e,this.field="",this.id="",this.inputvalue="",this.editMode=!1}return Object.defineProperty(e.prototype,"fieldvalue",{get:function(){return this.inputvalue},set:function(e){},enumerable:!1,configurable:!0}),e.prototype.isEditMode=function(){return this.editMode},e.prototype.setEditMode=function(){this.editMode=!0},e.prototype.closeEdit=function(){this.editMode=!1},e.prototype.ngAfterViewInit=function(){},e.prototype.ngOnInit=function(){},__decorate([core_1.Input(),__metadata("design:type",String)],e.prototype,"field",void 0),__decorate([core_1.Input(),__metadata("design:type",String)],e.prototype,"id",void 0),__decorate([core_1.Input(),__metadata("design:type",Object)],e.prototype,"inputvalue",void 0),__decorate([core_1.Component({selector:"[administration-dictionarymanager-item-field]",template:'<p *ngIf="!isEditMode()" class="slds-text-body--regular slds-truncate spice-fieldbody"><span>{{fieldvalue}}</span> <button style="float: right" class="slds-button slds-button--icon" (click)="setEditMode()"><svg aria-hidden="true" class="slds-button__icon"><use xlink:href="./vendor/sldassets/icons/utility-sprite/svg/symbols.svg#edit"></use></svg></button></p><div *ngIf="isEditMode()" class="slds-form-element__control"><input class="slds-input" type="text" [(ngModel)]="fieldvalue"></div>'}),__metadata("design:paramtypes",[dictionary])],e)}();exports.AdministrationDictionaryManagerItemField=AdministrationDictionaryManagerItemField;var AdministrationDictionaryManager=function(){function e(e){this.dictionary=e,this.dictionaryitem=""}return e.prototype.ngAfterViewInit=function(){this.dictionary.load(this.dictionaryitem).subscribe(function(e){})},e.prototype.isEditMode=function(){},e.prototype.closeEditMode=function(){},__decorate([core_1.Input(),__metadata("design:type",String)],e.prototype,"dictionaryitem",void 0),__decorate([core_1.Component({selector:"administration-dictionarymanager",template:'<div class="slds-page-header" role="banner"><div class="slds-grid"><div class="slds-col slds-has-flexi-truncate"><div class="slds-media slds-no-space slds-grow"><div class="slds-media__body"><h1 class="slds-page-header__title slds-m-right--small slds-align-middle slds-truncate">Dictionary {{dictionaryitem}}</h1><p class="slds-text-title--caps slds-line-height--reset">{{dictionary.data.length}} Items</p></div></div></div></div></div><table class="slds-table slds-table--bordered slds-table--fixed-layout" role="grid"><thead><tr class="slds-text-title--caps"><th *ngFor="let field of dictionary.getFields()" class="slds-is-sortable slds-is-resizable" scope="col"><a href="javascript:void(0);" class="slds-th__action slds-text-link--reset"><span class="slds-truncate">{{field}}</span></a></th></tr></thead><tbody><tr administration-dictionarymanager-item class="slds-hint-parent" *ngFor="let item of dictionary.data" [item]="item"></tr></tbody></table><footer class="slds-utility-bar_container" role="footer" *ngIf="isEditMode()"><ul class="slds-utility-bar"><li class="slds-utility-bar__item"><button class="slds-button slds-utility-bar__action slds-button--brand">Save</button></li><li class="slds-utility-bar__item"><button class="slds-button slds-utility-bar__action slds-button--brand" (click)="closeEditMode()">Cancel</button></li></ul></footer>',providers:[dictionary]}),__metadata("design:paramtypes",[dictionary])],e)}();exports.AdministrationDictionaryManager=AdministrationDictionaryManager;var AdministrationDictionaryManagerItem=function(){function e(e){this.dictionary=e,this.item={},this.editMode=!1}return e.prototype.isEditMode=function(){return this.editMode},e.prototype.setEditMode=function(){this.editMode=!0},e.prototype.closeEdit=function(){this.editMode=!1},e.prototype.ngAfterViewInit=function(){},e.prototype.ngOnInit=function(){},__decorate([core_1.Input(),__metadata("design:type",Object)],e.prototype,"item",void 0),__decorate([core_1.Component({selector:"[administration-dictionarymanager-item]",template:'<td scope="row" *ngFor="let field of dictionary.getFields()"><div administration-dictionarymanager-item-field [field]="field" [id]="item.id" [inputvalue]="item[field]" class="slds-truncate"></div></td>'}),__metadata("design:paramtypes",[dictionary])],e)}();exports.AdministrationDictionaryManagerItem=AdministrationDictionaryManagerItem;var AdministrationGeneralSettings=function(){function AdministrationGeneralSettings(e,s,t,i,l,a){this.metadata=e,this.language=s,this.backend=t,this.modal=i,this.toast=l,this.currency=a,this.settings={system:{name:"",site_url:"",unique_key:""},advanced:{developerMode:!1,stack_trace_errors:!1,dump_slow_queries:!1,slow_query_time_msec:0,upload_maxsize:0},logger:{level:"",file:{name:"spicecrm",ext:"",maxLogs:10,maxSize:10,suffix:""}}},this.options=[],this.currencies=[],this.loading=!0,this._loglevels=[]}return AdministrationGeneralSettings.prototype.ngOnInit=function(){var t=this;this.modal.openModal("SystemLoadingModal").subscribe(function(s){t.backend.getRequest("configuration/settings").subscribe(function(e){t.settings=e,t._loglevels=t.settings.logger.level.split(","),t.loading=!1,s.instance.self.destroy()})})},AdministrationGeneralSettings.prototype.save=function(){var s=this;this.modal.openModal("SystemLoadingModal").subscribe(function(e){s.backend.postRequest("configuration/settings",{},s.settings).subscribe(function(e){e.status?s.toast.sendToast(s.language.getLabel("LBL_SUCCESS"),"success"):s.toast.sendToast(s.language.getLabel("LBL_ERROR"),"error")}),e.instance.self.destroy()})},Object.defineProperty(AdministrationGeneralSettings.prototype,"loglevels",{get:function(){return this._loglevels},set:function(e){this._loglevels=e,this.settings.logger.level=e.join(",")},enumerable:!1,configurable:!0}),Object.defineProperty(AdministrationGeneralSettings.prototype,"maxSize",{get:function(){var e;return null===(e=this.settings.logger.file.maxSize)||void 0===e?void 0:e.replace("MB","")},set:function(e){this.settings.logger.file.maxSize=e+"MB"},enumerable:!1,configurable:!0}),__decorate([core_1.Component({selector:"administration-general-setting",template:'<div class="slds-p-around--medium slds-theme--shade"><div class="slds-page-header__row"><div class="slds-page-header__col-title"><div class="slds-media"><system-icon icon="settings"></system-icon><div class="slds-media__body"><div class="slds-page-header__name"><div class="slds-page-header__name-title"><h1><span class="slds-page-header__title slds-truncate"><system-label label="LBL_GENERAL_SETTINGS"></system-label></span></h1></div></div><p class="slds-page-header__name-meta"><ng-content></ng-content></p></div></div></div><button class="slds-button slds-button--neutral" (click)="save()"><system-label label="LBL_SAVE"></system-label></button></div></div><div class="slds-theme--default slds-p-around--xx-small"><div class="slds-section slds-is-open"><h3 class="slds-section__title"><button aria-expanded="true" class="slds-button slds-section__title-action"><span class="slds-truncate"><system-label label="LBL_GENERAL_SETTINGS"></system-label></span></button></h3><div class="slds-section__content"><div class="slds-grid slds-m-vertical--xx-small slds-grid--align-spread"><div class="slds-form-element__control slds-size--1-of-1 slds-p-around--x-small"><system-label label="LBL_NAME"></system-label><system-input-text autocomplete="off" [(ngModel)]="settings.system.name"></system-input-text></div></div><div class="slds-grid slds-m-vertical--xx-small slds-grid--align-spread"><div class="slds-form-element__control slds-size--1-of-1 slds-p-around--x-small"><system-label label="LBL_SITE_URL"></system-label><system-input-text autocomplete="off" [(ngModel)]="settings.system.site_url"></system-input-text></div></div><div class="slds-grid slds-m-vertical--xx-small slds-grid--align-spread"><div class="slds-form-element__control slds-size--1-of-1 slds-p-around--x-small"><system-label label="LBL_UNIQUE_KEY"></system-label><system-input-text [disabled]="true" autocomplete="off" [(ngModel)]="settings.system.unique_key"></system-input-text></div></div></div></div><div class="slds-section slds-is-open"><h3 class="slds-section__title"><button aria-expanded="true" class="slds-button slds-section__title-action"><span class="slds-truncate"><system-label label="LBL_ADVANCED_SETTINGS"></system-label></span></button></h3><div class="slds-section__content"><div class="slds-grid slds-m-vertical--xx-small slds-grid--align-spread"><div class="slds-form-element__control slds-size--1-of-6 slds-truncate slds-p-around--x-small"><system-label label="LBL_DEVELOPER_MODE"></system-label><div class="slds-p-vertical--xx-small"><system-checkbox [(ngModel)]="settings.advanced.developerMode"></system-checkbox></div></div><div class="slds-form-element__control slds-size--1-of-6 slds-truncate slds-p-around--x-small"><system-label label="LBL_STACKTRACE"></system-label><div class="slds-p-vertical--xx-small"><system-checkbox [(ngModel)]="settings.advanced.stack_trace_errors"></system-checkbox></div></div><div class="slds-form-element__control slds-size--1-of-6 slds-truncate slds-p-around--x-small"><system-label label="LBL_LOG_SLOW_QUERIES"></system-label><div class="slds-p-vertical--xx-small"><system-checkbox [(ngModel)]="settings.advanced.dump_slow_queries"></system-checkbox></div></div><div class="slds-form-element__control slds-size--1-of-2 slds-p-around--x-small"><system-label label="LBL_SLOW_QUERYTIME_TRESHHOLD"></system-label><system-input-integer [(ngModel)]="settings.advanced.slow_query_time_msec"></system-input-integer></div></div><div class="slds-grid slds-m-vertical--xx-small slds-grid--align-spread"><div class="slds-form-element__control slds-size--1-of-2 slds-p-around--x-small"><system-label label="LBL_MAXIMUM_UPLOAD_SIZE"></system-label><system-input-integer [(ngModel)]="settings.advanced.upload_maxsize"></system-input-integer></div><div class="slds-form-element__control slds-size--1-of-2 slds-p-around--x-small"><system-label label="LBL_EXPORT_LINES"></system-label><system-input-integer [disabled]="true" [(ngModel)]="settings.advanced.maximum_export_lines"></system-input-integer></div></div></div></div><div class="slds-section slds-is-open"><h3 class="slds-section__title"><button aria-expanded="true" class="slds-button slds-section__title-action"><span class="slds-truncate"><system-label label="LBL_LOGGER_SETTINGS"></system-label></span></button></h3><div class="slds-section__content"><div class="slds-grid slds-m-vertical--xx-small"><div class="slds-size--1-of-2"><div><system-label label="LBL_LOGFILE_NAME"></system-label><div class="slds-grid slds-p-around--x-small"><div class="slds-form-element__control slds-size--5-of-6 slds-p-right--x-small"><system-input-text autocomplete="off" [(ngModel)]="settings.logger.file.name"></system-input-text></div><div class="slds-form-element__control slds-size--1-of-6 slds-p-left--x-small"><system-input-text autocomplete="off" [(ngModel)]="settings.logger.file.ext"></system-input-text></div></div></div><div class="slds-grid"><div class="slds-form-element__control slds-size--1-of-2 slds-p-around--x-small"><system-label label="LBL_LOGFILE_MAX_SIZE"></system-label><div class="slds-grid slds-grid--vertical-align-center"><system-input-integer class="slds-grow" autocomplete="off" [(ngModel)]="maxSize"></system-input-integer><div class="slds-p-left--x-small">MB</div></div></div><div class="slds-form-element__control slds-size--1-of-2 slds-p-around--x-small"><system-label label="LBL_LOGFILE_MAX_NUMBER"></system-label><system-input-integer autocomplete="off" [(ngModel)]="settings.logger.file.maxLogs"></system-input-integer></div></div></div><div class="slds-size--1-of-2 slds-grid slds-grid--vertical"><div class="slds-form-element__control slds-size--1-of-1 slds-p-around--x-small"><system-label label="LBL_LOGFILE_LEVEL"></system-label><system-checkbox-group [(ngModel)]="loglevels" class="slds-grid slds-wrap"><system-checkbox-group-checkbox value="debug" class="slds-size--1-of-2 slds-p-vertical--xxx-small"><system-label label="LBL_LOGLEVEL_DEBUG"></system-label></system-checkbox-group-checkbox><system-checkbox-group-checkbox value="info" class="slds-size--1-of-2 slds-p-vertical--xxx-small"><system-label label="LBL_LOGLEVEL_INFO"></system-label></system-checkbox-group-checkbox><system-checkbox-group-checkbox value="error" class="slds-size--1-of-2 slds-p-vertical--xxx-small"><system-label label="LBL_LOGLEVEL_ERROR"></system-label></system-checkbox-group-checkbox><system-checkbox-group-checkbox value="warn" class="slds-size--1-of-2 slds-p-vertical--xxx-small"><system-label label="LBL_LOGLEVEL_WARN"></system-label></system-checkbox-group-checkbox><system-checkbox-group-checkbox value="security" class="slds-size--1-of-2 slds-p-vertical--xxx-small"><system-label label="LBL_LOGLEVEL_SECURITY"></system-label></system-checkbox-group-checkbox><system-checkbox-group-checkbox value="fatal" class="slds-size--1-of-2 slds-p-vertical--xxx-small"><system-label label="LBL_LOGLEVEL_FATAL"></system-label></system-checkbox-group-checkbox></system-checkbox-group></div></div></div></div></div></div>'}),__metadata("design:paramtypes",[services_1.metadata,services_1.language,services_1.backend,services_1.modal,services_1.toast,services_1.currency])],AdministrationGeneralSettings)}();exports.AdministrationGeneralSettings=AdministrationGeneralSettings;var AdministrationLanguages=function(){function e(e,s,t,i,l){this.metadata=e,this.language=s,this.backend=t,this.modal=i,this.toast=l,this.languages=[],this.loading=!0}return e.prototype.ngOnInit=function(){var t=this;this.modal.openModal("SystemLoadingModal").subscribe(function(s){t.backend.getRequest("packages").subscribe(function(e){e.versions?t.languages=e.languages:t.toast.sendToast(t.language.getLabel("LBL_ERROR"),"error"),t.loading=!1,s.instance.self.destroy()})})},__decorate([core_1.Component({selector:"administration-languages",template:'<div class="slds-grid slds-grid--align-spread slds-p-around--medium"><h2 class="slds-text-heading--medium">Languages</h2></div><div class="slds-grid slds-wrap"><div *ngFor="let language of languages" class="slds-size--1-of-2 slds-p-around--xx-small"><div class="slds-card"><div class="slds-card__header slds-grid"><header class="slds-media slds-media_center slds-has-flexi-truncate"><system-icon size="small" icon="custom68" sprite="custom" class="slds-p-right--xx-small"></system-icon><div class="slds-media__body"><h2 class="slds-card__header-title"><div class="slds-card__header-link slds-truncate" [title]="language.language_name">{{language.language_name}}</div></h2></div><div class="slds-no-flex"><system-spinner size="12" *ngIf="loading"></system-spinner><div *ngIf="!loading" class="slds-grid slds-grid_vertical-align-center"></div></div></header></div></div></div></div>'}),__metadata("design:paramtypes",[services_1.metadata,services_1.language,services_1.backend,services_1.modal,services_1.toast])],e)}();exports.AdministrationLanguages=AdministrationLanguages;var AdministrationDefaultPreferences=function(){function AdministrationDefaultPreferences(e,s,t,i,l,a){this.backend=e,this.toast=s,this.language=t,this.configuration=i,this.view=l,this.modal=a,this.preferences={}}return AdministrationDefaultPreferences.prototype.ngOnInit=function(){this.loadPreferences()},AdministrationDefaultPreferences.prototype.loadPreferences=function(){var s=this,t=this.modal.await("LBL_LOADING");this.backend.getRequest("configuration/configurator/editor/default_preferences").subscribe(function(e){s.preferences=e,t.emit(),t.complete()})},AdministrationDefaultPreferences.prototype.save=function(){var s=this,t=this.modal.await("LBL_SAVING_DATA");this.backend.postRequest("configuration/configurator/editor/default_preferences",[],{config:this.preferences}).subscribe(function(e){s.configuration.setData("defaultuserpreferences",s.preferences),s.toast.sendToast(s.language.getLabel("LBL_DATA_SAVED"),"success"),s.view.setViewMode(),t.emit(),t.complete()})},__decorate([core_1.Component({selector:"administration-default-preferences",template:'<div class="slds-page-header"><div class="slds-page-header__row"><div class="slds-page-header__col-title"><div class="slds-grid slds-grid--vertical-align-center"><div><system-icon icon="custom67" sprite="custom" addclasses="slds-page-header__icon"></system-icon></div><div class="slds-media__body"><div class="slds-page-header__name"><div class="slds-page-header__name-title"><h1><span class="slds-page-header__title slds-truncate" system-title="LBL_DEFAULT_PREFERENCES"><system-label label="LBL_DEFAULT_PREFERENCES"></system-label></span></h1></div></div></div></div></div><div class="slds-grid"><ng-container *ngIf="view.isEditMode(); else editButtonContainer"><button class="slds-button slds-button--neutral slds-m-horizontal--xx-small" (click)="view.setViewMode()"><system-label label="LBL_CANCEL"></system-label></button> <button class="slds-button slds-button--brand" (click)="save()"><system-label label="LBL_SAVE"></system-label></button></ng-container><ng-template #editButtonContainer><button class="slds-button slds-button--neutral" (click)="view.setEditMode()"><system-label label="LBL_EDIT"></system-label></button></ng-template></div></div></div><system-preferences-panel [preferences]="preferences" class="spice-display-block slds-p-around--xx-small"></system-preferences-panel><system-collapsable-tab [collapsible]="false" tabtitle="LBL_HOME_PREFERENCES"><div class="slds-grid"><system-preferences-panel-item class="slds-size--1-of-3" itemlabel="LBL_HOME_ASSISTANT"><system-preferences-panel-item-display>{{preferences.home_assistant}}</system-preferences-panel-item-display><system-preferences-panel-item-edit><div class="slds-select_container"><select class="slds-select" [(ngModel)]="preferences.home_assistant"><option></option><option value="visible"><system-label label="LBL_VISIBLE"></system-label></option><option value="hidden"><system-label label="LBL_HIDDEN"></system-label></option></select></div></system-preferences-panel-item-edit></system-preferences-panel-item></div></system-collapsable-tab>',providers:[services_1.view]}),__metadata("design:paramtypes",[services_1.backend,services_1.toast,services_1.language,services_1.configurationService,services_1.view,services_1.modal])],AdministrationDefaultPreferences)}();exports.AdministrationDefaultPreferences=AdministrationDefaultPreferences;var AdministrationUserAccessLogViewer=function(){function AdministrationUserAccessLogViewer(e,s,t){this.backend=e,this.modal=s,this.toast=t,this.limit="250",this.filter="",this.isLoading=!1,this.failedOnly=!1,this.entries=[]}return AdministrationUserAccessLogViewer.prototype.setNow=function(){this.dateEnd=new moment},AdministrationUserAccessLogViewer.prototype.loadData=function(){var e,s=this;this.isLoading||(this.isLoading=!0,e={limit:this.limit},this.filter&&(e.filter=this.filter),this.failedOnly&&(e.failedonly=this.failedOnly),this.dateEnd&&(e.date_end=this.dateEnd.format("YYYY-MM-DD HH:mm:ss")),this.backend.getRequest("admin/useraccesslog",e).subscribe(function(e){s.entries=e,s.isLoading=!1},function(e){s.toast.sendToast("Error loading log data!","error"),s.isLoading=!1}))},AdministrationUserAccessLogViewer.prototype.loadMore=function(){var e,s=this;this.isLoading||(this.isLoading=!0,e={limit:this.limit,date_end:this.entries[this.entries.length-1].date_entered},this.filter&&(e.filter=this.filter),this.failedOnly&&(e.failedonly=this.failedOnly),this.backend.getRequest("admin/useraccesslog",e).subscribe(function(e){s.entries=s.entries.concat(e),s.isLoading=!1},function(e){s.toast.sendToast("Error loading log data!","error"),s.isLoading=!1}))},AdministrationUserAccessLogViewer.prototype.buttonLoad=function(){this.loadData()},__decorate([core_1.Component({template:'<div class="slds-p-around--medium slds-theme--shade"><div class="slds-page-header__row"><div class="slds-page-header__col-title"><div class="slds-media"><system-icon icon="lightning_usage"></system-icon><div class="slds-media__body"><div class="slds-page-header__name"><div class="slds-page-header__name-title"><h1><span class="slds-page-header__title slds-truncate"><system-label label="LBL_USERACCESSLOG"></system-label></span></h1></div></div><p class="slds-page-header__name-meta">{{entries.length}} <system-label label="LBL_RECORDS"></system-label></p></div></div></div><button class="slds-button slds-button--neutral" (click)="loadData()"><system-label label="LBL_LOAD"></system-label></button></div></div><div class="slds-section slds-is-open slds-p-around--xx-small"><div class="slds-grid slds-grid--vertical-align-end slds-gutters_direct-xxx-small"><div class="slds-col slds-size--1-of-2"><label class="slds-form-element__label"><system-label label="LBL_FILTER"></system-label></label><div class="slds-grid slds-grid--vertical-align-center"><div class="slds-grow slds-form-element__control slds-input-has-icon slds-input-has-icon_right"><input class="slds-input" type="text" system-trim-input [(ngModel)]="filter"> <button class="slds-button slds-button_icon slds-input__icon slds-input__icon_right" (click)="filter=\'\'"><system-button-icon icon="clear" addclasses="slds-icon-text-light"></system-button-icon></button></div><system-checkbox [(ngModel)]="failedOnly"><system-label label="LBL_FAILEDONLY"></system-label></system-checkbox></div></div><div class="slds-col slds-size--1-of-4"><label class="slds-form-element__label"><system-label label="LBL_END"></system-label></label><div class="slds-grid slds-grid--vertical-align-center"><system-input-date [(ngModel)]="dateEnd" class="slds-grow"></system-input-date><system-input-time [(ngModel)]="dateEnd" class="slds-grow slds-p-horizontal--xx-small"></system-input-time><system-utility-icon system-title="LBL_NOW" icon="clock" size="x-small" (click)="setNow()"></system-utility-icon></div></div><div class="slds-col slds-size--1-of-4"><label class="slds-form-element__label"><system-label label="LBL_ROWS"></system-label></label><div class="slds-select_container"><select class="slds-select" [(ngModel)]="limit"><option>250</option><option>500</option><option>1000</option></select></div></div></div></div><div system-to-bottom class="slds-border--top"><table class="slds-table slds-table--bordered slds-table--fixed-layout slds-table--col-bordered slds-no-row-hover slds-table_header-fixed"><thead><tr><th style="width: 8rem;"><system-label class="slds-th__action" label="LBL_DATE"></system-label></th><th class="slds-resizable"><system-label class="slds-th__action" label="LBL_USER"></system-label></th><th style="width: 8rem"><system-label class="slds-th__action" label="LBL_IP_ADDRESS"></system-label></th><th style="width: 8rem;"><system-label class="slds-th__action" label="LBL_ACTION"></system-label></th></tr></thead><tbody #tbody><tr *ngFor="let entry of entries" [ngClass]="{\'slds-theme--error\' :entry.action==\'loginfail\'}"><td><system-display-datetime [date]="entry.date_entered"></system-display-datetime></td><td><div class="slds-truncate">{{entry.login_name}}</div></td><td><div class="slds-truncate">{{entry.ipaddress}}</div></td><td class="slds-text-align--center">{{entry.action}}</td></tr></tbody></table><div *ngIf="entries.length == 0" class="slds-height_full slds-align--absolute-center"><system-illustration-no-records><system-label label="LBL_NO_RECORDS_FOUND"></system-label></system-illustration-no-records></div><div *ngIf="entries.length > 0" class="slds-p-around--small slds-align--absolute-center"><button class="slds-button slds-button--neutral" (click)="loadMore()"><system-label label="LBL_LOAD_MORE"></system-label></button></div></div>'}),__metadata("design:paramtypes",[services_1.backend,services_1.modal,services_1.toast])],AdministrationUserAccessLogViewer)}();exports.AdministrationUserAccessLogViewer=AdministrationUserAccessLogViewer;var AdministrationLoginRestriction=function(){function e(e,s){this.backend=e,this.toast=s,this.isLoading=!0,this.restrictions={user:{enabled:!1,number_attempts:0,monitored_period:0,blocking_duration:0,blocking_type:"permanent"},ip:{enabled:!1,number_attempts:0,monitored_period:0}}}return e.prototype.ngOnInit=function(){this.loadConfig()},e.prototype.isDirty=function(){return!_.isEqual(this.restrictions,this.restrictionsBackup)},e.prototype.cancelEditing=function(){this.restrictions=JSON.parse(JSON.stringify(this.restrictionsBackup))},e.prototype.saveConfig=function(){var s=this,e={ip_enabled:this.restrictions.ip.enabled?1:0,ip_number_attempts:this.restrictions.ip.number_attempts,ip_monitored_period:this.restrictions.ip.monitored_period,user_enabled:this.restrictions.user.enabled?1:0,user_number_attempts:this.restrictions.user.number_attempts,user_monitored_period:this.restrictions.user.monitored_period,user_blocking_duration:"time"===this.restrictions.user.blocking_type?this.restrictions.user.blocking_duration:"0"};this.isLoading=!0,this.backend.postRequest("configuration/configurator/editor/login_attempt_restriction",null,{config:e}).pipe(operators_1.take(1)).subscribe(function(e){s.restrictionsBackup=JSON.parse(JSON.stringify(s.restrictions)),s.toast.sendToast("Login Restriction Configuration successfully saved.","success"),s.isLoading=!1})},e.prototype.loadConfig=function(){var s=this;this.isLoading=!0,this.backend.getRequest("configuration/configurator/editor/login_attempt_restriction").pipe(operators_1.take(1)).subscribe(function(e){s.restrictions.ip.enabled="1"===e.ip_enabled||!1,s.restrictions.ip.number_attempts=+e.ip_number_attempts||0,s.restrictions.ip.monitored_period=+e.ip_monitored_period||0,s.restrictions.user.enabled="1"===e.user_enabled||!1,s.restrictions.user.number_attempts=+e.user_number_attempts||0,s.restrictions.user.monitored_period=+e.user_monitored_period||0,s.restrictions.user.blocking_duration=+e.user_blocking_duration||0,s.restrictions.user.blocking_type=s.restrictions.user.blocking_duration?"time":"permanent",s.restrictionsBackup=JSON.parse(JSON.stringify(s.restrictions)),s.isLoading=!1},function(e){s.toast.sendToast("Error loading Login Restriction Config.","error"),s.isLoading=!1})},__decorate([core_1.Component({selector:"administration-login-restriction",template:'<div class="slds-grid" [system-overlay-loading-spinner]="isLoading"><div class="slds-p-around--medium" style="width:100%"><div class="slds-grid slds-grid--align-spread"><div class="slds-text-heading_small"><system-label label="LBL_USER_RESTRICTION"></system-label></div><system-checkbox-toggle [(ngModel)]="restrictions.user.enabled" label="LBL_ACTIVE" class="slds-m-bottom--xx-small spice-display-block"></system-checkbox-toggle></div><div class="slds-grid"><div class="slds-form-element"><label class="slds-form-element__label" for="user-number-attempts"><abbr class="slds-required" title="required">*</abbr><system-label label="LBL_MAX_LOGIN_ATTEMPTS"></system-label></label><div class="slds-form-element__control"><system-input-number [disabled]="!restrictions.user.enabled" [(ngModel)]="restrictions.user.number_attempts" [onlyField]="true" id="user-number-attempts" [precision]="0" [asNumber]="true"></system-input-number></div></div><div class="slds-form-element slds-m-left--medium"><label class="slds-form-element__label" for="user-monitored-period"><abbr class="slds-required" title="required">*</abbr><system-label label="LBL_MONITORED_PERIOD"></system-label> (<system-label label="LBL_MINUTES" length="short" style="display:inline-block"></system-label>)</label><div class="slds-form-element__control"><system-input-number [disabled]="!restrictions.user.enabled" [(ngModel)]="restrictions.user.monitored_period" [onlyField]="true" id="user-monitored-period" [precision]="0" [asNumber]="true"></system-input-number></div></div><fieldset class="slds-form-element slds-m-left--medium"><legend class="slds-form-element__legend slds-form-element__label" style="font-weight:normal"><system-label label="LBL_LOCK_TYPE"></system-label></legend><div class="slds-form-element__control"><span class="slds-radio"><input type="radio" id="user-lock-type-time" value="time" [(ngModel)]="restrictions.user.blocking_type" [disabled]="!restrictions.user.enabled"> <label class="slds-radio__label" for="user-lock-type-time"><span class="slds-radio_faux"></span> <span class="slds-form-element__label"><system-label label="LBL_TIME"></system-label></span></label></span> <span class="slds-radio"><input type="radio" id="user-lock-type-perm" value="permanent" [(ngModel)]="restrictions.user.blocking_type" [disabled]="!restrictions.user.enabled"> <label class="slds-radio__label" for="user-lock-type-perm"><span class="slds-radio_faux"></span> <span class="slds-form-element__label"><system-label label="LBL_PERMANENT"></system-label></span></label></span></div></fieldset><div class="slds-form-element slds-m-left--x-small"><label class="slds-form-element__label" for="user-blocking-duration"><abbr class="slds-required" title="required">*</abbr><system-label label="LBL_BLOCKING_DURATION"></system-label> (<system-label label="LBL_MINUTES" length="short" style="display:inline-block"></system-label>)</label><div class="slds-form-element__control" [ngClass]="{\'slds-has-error\':restrictions.user.blocking_type === \'time\' && restrictions.user.blocking_duration === 0}"><system-input-number [disabled]="!restrictions.user.enabled || restrictions.user.blocking_type === \'permanent\'" [(ngModel)]="restrictions.user.blocking_duration" [onlyField]="true" id="user-blocking-duration" [precision]="0" [asNumber]="true" (ngModelChange)="restrictions.user.blocking_type = ( restrictions.user.blocking_duration === 0 ? \'permanent\':\'time\')"></system-input-number></div></div></div></div><div class="slds-border--left slds-p-around--medium slds-border--right" style="width:100%"><div class="slds-grid slds-grid--align-spread"><div class="slds-text-heading_small"><system-label label="LBL_IP_RESTRICTION"></system-label></div><system-checkbox-toggle [(ngModel)]="restrictions.ip.enabled" label="LBL_ACTIVE" class="slds-m-bottom--xx-small spice-display-block"></system-checkbox-toggle></div><div class="slds-grid"><div class="slds-form-element"><label class="slds-form-element__label" for="ip-number-attempts"><abbr class="slds-required" title="required">*</abbr><system-label label="LBL_MAX_LOGIN_ATTEMPTS"></system-label></label><div class="slds-form-element__control"><system-input-number [disabled]="!restrictions.ip.enabled" [(ngModel)]="restrictions.ip.number_attempts" [onlyField]="true" id="ip-number-attempts" [precision]="0" [asNumber]="true"></system-input-number></div></div><div class="slds-form-element slds-m-left--medium"><label class="slds-form-element__label" for="ip-monitored-period"><abbr class="slds-required" title="required">*</abbr><system-label label="LBL_MONITORED_PERIOD"></system-label> (<system-label label="LBL_MINUTES" length="short" style="display:inline-block"></system-label>)</label><div class="slds-form-element__control"><system-input-number [disabled]="!restrictions.ip.enabled" [(ngModel)]="restrictions.ip.monitored_period" [onlyField]="true" id="ip-monitored-period" [precision]="0" [asNumber]="true"></system-input-number></div></div></div></div><div class="slds-p-around--medium slds-align-bottom" style="white-space:nowrap"><button class="slds-button slds-button--icon slds-button_neutral slds-button--icon-border" [disabled]="isLoading" (click)="cancelEditing()"><system-button-icon icon="close"></system-button-icon></button><button class="slds-button slds-button--icon slds-button_brand slds-button--icon-border slds-m-left--small" [disabled]="isLoading" (click)="saveConfig()"><system-button-icon icon="check"></system-button-icon></button></div></div>'}),__metadata("design:paramtypes",[services_1.backend,services_1.toast])],e)}();exports.AdministrationLoginRestriction=AdministrationLoginRestriction;var AdministrationLoginRestrictionIpAddresses=function(){function e(e,s,t,i,l){this.backend=e,this.modal=s,this.toast=t,this.metadata=i,this.language=l,this.ipAddresses=[],this.isLoading=!1,this.isAltering=!1,this.isAdding=!1,this.newAddress="",this.newDescription="",this.addressError=""}return Object.defineProperty(e.prototype,"isEditing",{get:function(){return this.isAltering||this.isAdding},enumerable:!1,configurable:!0}),e.prototype.ngOnInit=function(){this.altColor="black"===this.color?"white":"black",this.loadIpAddresses()},e.prototype.loadIpAddresses=function(){var s=this;this.isLoading=!0,this.backend.getRequest("authentication/ipAddresses/"+this.color).pipe(operators_1.take(1)).subscribe(function(e){s.ipAddresses=e,s.sortIpAddresses(),s.isLoading=!1},function(e){s.toast.sendToast("Error loading "+s.color+" listed IP Addresses.",e.error.error.message,"error")})},e.prototype.sortIpAddresses=function(){var t=this;this.ipAddresses=this.ipAddresses.sort(function(e,s){return t.compareIpAddresses(e,s)}),this.ipAddresses=this.ipAddresses.sort(function(e,s){return t.compareIpAddresses(e,s)})},e.prototype.compareIpAddresses=function(e,s){return Number(e.address.split(".").map(function(e){return("000"+e).slice(-3)}).join(""))-Number(s.address.split(".").map(function(e){return("000"+e).slice(-3)}).join(""))},e.prototype.deleteIpAddresses=function(){var i=this,l=[],a=[];this.ipAddresses.forEach(function(e,s){e.selected&&l.push(s)}),l.length&&this.modal.confirm("Remove "+l.length+" IP Addresses? This can not be undone.","Remove IP Addresses?",null).pipe(operators_1.take(1)).subscribe(function(e){var t;e?(i.isLoading=!0,t=l.length,l.forEach(function(s){i.backend.deleteRequest("authentication/ipAddress/"+i.ipAddresses[s].address).pipe(operators_1.take(1)).subscribe(function(e){!0===e.success&&a.push(s),--t<=0&&(i._removeFromList(a),i.isLoading=!1)},function(e){return function(){--t<=0&&(i._removeFromList(a),i.isLoading=!1),i.toast.sendToast("Error deleting IP Address "+i.ipAddresses[s].address+".",e.error.error.message,"error")}})})):i.isLoading=!1})},e.prototype.moveIpAddresses=function(){var l=this,a=[],o=[];this.ipAddresses.forEach(function(e,s){e.selected&&a.push(s)}),a.length&&this.modal.confirm("Move "+a.length+" IP Addresses to "+this.altColor+" list?","Move IP Addresses?",null).pipe(operators_1.take(1)).subscribe(function(e){var t="black"===l.color?"white":"black";l.isLoading=l.siblingComponent.isLoading=!0;var i=a.length;a.forEach(function(s){l.backend.putRequest("authentication/ipAddress/"+l.ipAddresses[s].address+"/move/"+t).pipe(operators_1.take(1)).subscribe(function(e){!0===e.success&&(l.siblingComponent.ipAddresses.push(l.ipAddresses[s]),l.ipAddresses[s].selected=!1,o.push(s),l.siblingComponent.sortIpAddresses()),--i<=0&&(l._removeFromList(o),l.isLoading=l.siblingComponent.isLoading=!1)},function(e){return function(){--i<=0&&(l._removeFromList(o),l.isLoading=l.siblingComponent.isLoading=!1),l.toast.sendToast("Error moving IP Address "+l.ipAddresses[s].address+".",e.error.error.message,"error")}})})})},e.prototype._removeFromList=function(e){for(var s=(e=e.sort(function(e,s){return e-s})).length-1;0<=s;s--)this.ipAddresses.splice(e[s],1)},Object.defineProperty(e.prototype,"checkboxesUsed",{get:function(){for(var e=0,s=this.ipAddresses;e<s.length;e++){var t=s[e];if(null!=t&&t.selected)return!0}return!1},enumerable:!1,configurable:!0}),e.prototype.saveNewAddress=function(){var s=this;this.checkAddressInput(),this.addressError||(this.isLoading=!0,this.backend.postRequest("authentication/ipAddress/"+this.newAddress,null,{color:this.color[0],description:this.newDescription}).pipe(operators_1.take(1)).subscribe(function(e){s.isLoading=!1,s.ipAddresses.push(e.data),s.sortIpAddresses(),s.toast.sendToast("IP Address "+s.newAddress+" added ("+s.color+" listed).","success"),s.newAddress="",s.newDescription="",s.isAdding=!1},function(e){s.toast.sendToast("Error saving IP Address.","error",e.error.error.message),s.isLoading=!1,s.isAdding=!1}))},e.prototype.checkAddressInput=function(){this.newAddress.length?(this.newAddress=this.sanitizeIpAddress(this.newAddress),this.checkIpAddress(this.newAddress)?this.ipAddressIsListed(this.newAddress)?this.addressError="Already listed.":this.addressError="":this.addressError="Invalid."):this.addressError="Missing."},e.prototype.sanitizeIpAddress=function(e){var t=(e=e.replace(/\s+/g,"")).split(".");return t.forEach(function(e,s){t[s]=e.replace(/^0+(?!$)/,"")}),t.join(".")},e.prototype.checkIpAddress=function(e){e=e.split(".");return 4===e.length&&!e.some(function(e){return!e.match(/\d+/)||255<parseInt(e,10)})},e.prototype.ipAddressIsListed=function(s){return!0===this.ipAddresses.some(function(e){if(e.address===s)return!0})||!0===this.siblingComponent.ipAddresses.some(function(e){if(e.address===s)return!0})},e.prototype.startAdding=function(){this.isAdding=!0,this.addressError="",this.table.nativeElement.scrollTop=0},e.prototype.cancelNewAddress=function(){this.isAdding=!1,this.newAddress="",this.newDescription=""},__decorate([core_1.Input(),__metadata("design:type",String)],e.prototype,"color",void 0),__decorate([core_1.Input(),__metadata("design:type",e)],e.prototype,"siblingComponent",void 0),__decorate([core_1.ViewChild("table",{static:!0}),__metadata("design:type",core_1.ElementRef)],e.prototype,"table",void 0),__decorate([core_1.Component({selector:"administration-login-restriction-ip-addresses",template:'<div class="slds-grid slds-grid--vertical slds-p-around--medium" [system-overlay-loading-spinner]="isLoading" style="height:100%"><div class="slds-grid slds-grid--align-spread slds-m-bottom--x-small"><div class="slds-text-heading_small slds-col--bump-right"><system-label *ngIf="color===\'white\'" label="LBL_WHITE_LISTED_IPADDRESSES"></system-label> <system-label *ngIf="color===\'black\'" label="LBL_BLACK_LISTED_IPADDRESSES"></system-label></div><ng-container *ngIf="checkboxesUsed"><button class="slds-button slds-button--neutral" (click)="moveIpAddresses()" [disabled]="isEditing" style="padding:0.25rem;line-height:0;font-weight:bold">â{{altColor.toUpperCase()}}</button> <button class="slds-button slds-button--icon" system-title="LBL_DELETE" (click)="deleteIpAddresses()" [disabled]="isEditing"><system-button-icon icon="delete"></system-button-icon></button></ng-container><button class="slds-button slds-button--icon slds-m-left--xx-small" system-title="LBL_ADD" (click)="startAdding()" [disabled]="isEditing"><system-button-icon icon="new"></system-button-icon></button> <button (click)="loadIpAddresses()" system-title="LBL_RELOAD" class="slds-button slds-button--icon slds-m-left--xx-small" [disabled]="isEditing"><system-button-icon icon="refresh"></system-button-icon></button></div><div class="slds-scrollable--y" [ngClass]="{\'slds-grow\':ipAddresses.length!==0}"><table #table class="slds-table slds-table_bordered slds-table--header-fixed" [ngStyle]="{borderBottom:ipAddresses.length===0?\'none\':\'auto\'}"><thead><tr class="slds-text-title--caps"><th></th><th><div class="slds-truncate slds-p-horizontal--x-small"><system-label label="LBL_ADDRESS"></system-label></div></th><th style="width:100%"><div class="slds-truncate slds-p-horizontal--x-small"><system-label label="LBL_DESCRIPTION"></system-label></div></th><th><div class="slds-truncate slds-p-horizontal--x-small"><system-label label="LBL_DATE_ENTERED"></system-label></div></th><th><div class="slds-truncate slds-p-horizontal--x-small"><system-label label="LBL_CREATED_BY"></system-label></div></th></tr></thead><tbody system-multi-select-checkboxes><tr *ngIf="isAdding"><td colspan="2" style="vertical-align:top"><div class="slds-form-element" [ngClass]="{\'slds-has-error\':addressError}"><div class="slds-form-element__control"><input system-autofocus type="text" [(ngModel)]="newAddress" [placeholder]="language.getLabel(\'LBL_IPADDRESS\')" class="slds-input" (change)="checkAddressInput()" style="min-width:8.8rem"></div><div class="slds-form-element__help" id="error-message-unique-id">{{addressError}}</div></div></td><td style="vertical-align:top"><input class="slds-input" [(ngModel)]="newDescription" [placeholder]="language.getLabel(\'LBL_DESCRIPTION\')"></td><td colspan="2" style="vertical-align:top"><button class="slds-button slds-button--icon-border" (click)="cancelNewAddress()"><system-button-icon [icon]="\'close\'" [size]="\'small\'"></system-button-icon></button> <button class="slds-button slds-button--icon-border slds-button--brand" (click)="saveNewAddress()"><system-button-icon [icon]="\'check\'" [size]="\'small\'"></system-button-icon></button></td></tr><tr administration-login-restriction-ip-addresses-row *ngFor="let ipAddress of ipAddresses; let i=index" [ipAddress]="ipAddress" (editing)="isAltering=$event" [otherEditing]="isEditing"></tr></tbody></table></div><div *ngIf="!isAdding && !isLoading && ipAddresses.length === 0" class="slds-grow slds-align--absolute-center"><div class="slds-illustration slds-illustration_small"><div class="slds-text-longform"><h3 class="slds-text-heading_medium"><system-label label="MSG_NO_IP_ADDRESSES_LISTED"></system-label></h3></div></div></div></div>'}),__metadata("design:paramtypes",[services_1.backend,services_1.modal,services_1.toast,services_1.metadata,services_1.language])],e)}();exports.AdministrationLoginRestrictionIpAddresses=AdministrationLoginRestrictionIpAddresses;var AdministrationLoginRestrictionIpAddressesRow=function(){function e(e,s,t){this.backend=e,this.toast=s,this.language=t,this.editing=new core_1.EventEmitter,this.isEditing=!1}return e.prototype.editDescription=function(){this.backup=this.ipAddress.description,this.isEditing=!0,this.editing.emit(!0)},e.prototype.save=function(){var s=this;this.isEditing=!1,this.backend.putRequest("authentication/ipAddress/"+this.ipAddress.address,null,{description:this.ipAddress.description}).pipe(operators_1.take(1)).subscribe(function(e){s.isEditing=!1,s.editing.emit(!1)},function(e){s.ipAddress.description=s.backup,s.isEditing=!1,s.editing.emit(!1),s.toast.sendToast("Error saving Description of IP Address.","error")})},e.prototype.cancel=function(){this.isEditing=!1,this.editing.emit(!1),this.ipAddress.description=this.backup},__decorate([core_1.Input(),__metadata("design:type",Object)],e.prototype,"ipAddress",void 0),__decorate([core_1.Output(),__metadata("design:type",Object)],e.prototype,"editing",void 0),__decorate([core_1.Input(),__metadata("design:type",Boolean)],e.prototype,"otherEditing",void 0),__decorate([core_1.Component({selector:"[administration-login-restriction-ip-addresses-row]",template:'<td class="slds-p-right--none"><system-checkbox [(ngModel)]="ipAddress.selected" [disabled]="otherEditing"></system-checkbox></td><td class="slds-p-right--x-small"><div class="slds-truncate">{{ipAddress.address}}</div></td><td class="slds-p-right--x-small"><div *ngIf="!isEditing" class="slds-grid"><div class="slds-truncate slds-col--bump-right">{{ipAddress.description}}</div><button (click)="editDescription()" system-title="LBL_RELOAD" class="slds-button slds-button--icon slds-m-left--xx-small" [disabled]="otherEditing"><system-button-icon icon="edit"></system-button-icon></button></div><div *ngIf="isEditing" class="slds-grid"><div style="width:100%"><input class="slds-input" [(ngModel)]="ipAddress.description" [placeholder]="language.getLabel(\'LBL_DESCRIPTION\')"></div><button class="slds-button slds-button--icon-border slds-m-left--xx-small" (click)="cancel()"><system-button-icon [icon]="\'close\'" size="small"></system-button-icon></button> <button class="slds-button slds-button--icon-border slds-button--brand" (click)="save()"><system-button-icon [icon]="\'check\'" size="small"></system-button-icon></button></div></td><td class="slds-p-right--x-small"><div class="slds-truncate"><system-display-datetime [date]="ipAddress.date_entered"></system-display-datetime></div></td><td class="slds-p-right--x-small" style="width:100%"><div class="slds-truncate">{{ipAddress.created_by_name}}</div></td>'}),__metadata("design:paramtypes",[services_1.backend,services_1.toast,services_1.language])],e)}();exports.AdministrationLoginRestrictionIpAddressesRow=AdministrationLoginRestrictionIpAddressesRow;var AdministrationPasswordConfig=function(){function e(e,s,t,i){this.backend=e,this.modal=s,this.toast=t,this.language=i,this.isLoading=!0,this.config={minpwdlength:6,oneupper:!0,onelower:!0,onenumber:!0,onespecial:!0,pwdvaliditydays:0}}return e.prototype.configIsDirty=function(){return!_.isEqual(this.config,this.configBackup)},e.prototype.cancel=function(){this.config=JSON.parse(JSON.stringify(this.configBackup))},e.prototype.save=function(){var s=this,e={minpwdlength:this.config.minpwdlength,oneupper:this.config.oneupper?"1":"0",onelower:this.config.onelower?"1":"0",onenumber:this.config.onenumber?"1":"0",onespecial:this.config.onespecial?"1":"0",pwdvaliditydays:this.config.pwdvaliditydays};this.isLoading=!0,this.backend.postRequest("configuration/configurator/editor/passwordsetting",null,{config:e}).pipe(operators_1.take(1)).subscribe(function(e){s.configBackup=JSON.parse(JSON.stringify(s.config)),s.toast.sendToast("Password Configuration successfully saved.","success"),s.isLoading=!1})},e.prototype.ngOnInit=function(){this.loadConfig()},e.prototype.loadConfig=function(){var s=this;this.isLoading=!0,this.backend.getRequest("configuration/configurator/editor/passwordsetting").pipe(operators_1.take(1)).subscribe(function(e){s.config.oneupper=!0===e.oneupper||1===e.oneupper||"1"===e.oneupper||!1,s.config.onelower=!0===e.onelower||1===e.onelower||"1"===e.onelower||!1,s.config.onenumber=!0===e.onenumber||1===e.onenumber||"1"===e.onenumber||!1,s.config.onespecial=!0===e.onespecial||1===e.onespecial||"1"===e.onespecial||!1,s.config.minpwdlength=parseInt(e.minpwdlength,10)||0,s.config.pwdvaliditydays=parseInt(e.pwdvaliditydays,10)||0,s.configBackup=JSON.parse(JSON.stringify(s.config)),s.isLoading=!1})},__decorate([core_1.Component({selector:"administration-password-config",template:'<div class="slds-p-around--medium" [system-overlay-loading-spinner]="isLoading"><div class="slds-grid slds-grid--align-spread"><div class="slds-text-heading_small"><system-label label="LBL_PASSWORD_CONFIGURATION"></system-label></div><div class="slds-p-bottom--x-small" style="white-space:nowrap"><button class="slds-button slds-button--icon slds-button_neutral slds-button--icon-border" [disabled]="isLoading" (click)="cancel()"><system-button-icon icon="close"></system-button-icon></button><button class="slds-button slds-button--icon slds-button_brand slds-button--icon-border slds-m-left--small" [disabled]="isLoading" (click)="save()"><system-button-icon icon="check"></system-button-icon></button></div></div><div class="slds-grid slds-grid--vertical-align-start"><div class="slds-form-element"><label class="slds-form-element__label" for="password-config-minpwdlength"><system-label label="LBL_MIN_LENGTH"></system-label></label><div class="slds-form-element__control"><system-input-number [(ngModel)]="config.minpwdlength" [onlyField]="true" id="password-config-minpwdlength" [precision]="0" [asNumber]="true" size="3"></system-input-number></div></div><div class="slds-form-element slds-p-left--medium"><label class="slds-form-element__label" for="password-config-pwdvaliditydays"><system-label label="LBL_EXPIRATION"></system-label> (<system-label label="LBL_DAYS" style="display:inline-block"></system-label>, 0=<system-label label="LBL_OFF" style="display:inline-block"></system-label>)</label><div class="slds-form-element__control"><system-input-number [(ngModel)]="config.pwdvaliditydays" [onlyField]="true" id="password-config-pwdvaliditydays" [precision]="0" [asNumber]="true" size="4"></system-input-number></div></div><div class="slds-p-left--medium" system-multi-select-checkboxes><div><system-checkbox [(ngModel)]="config.oneupper"><system-label label="LBL_ONE_UPPERCASE"></system-label></system-checkbox></div><div><system-checkbox [(ngModel)]="config.onelower"><system-label label="LBL_ONE_LOWERCASE"></system-label></system-checkbox></div><div><system-checkbox [(ngModel)]="config.onenumber"><system-label label="LBL_ONE_DIGIT"></system-label></system-checkbox></div><div><system-checkbox [(ngModel)]="config.onespecial"><system-label label="LBL_ONE_SPECIALCHAR"></system-label></system-checkbox></div></div></div></div>'}),__metadata("design:paramtypes",[services_1.backend,services_1.modal,services_1.toast,services_1.language])],e)}();exports.AdministrationPasswordConfig=AdministrationPasswordConfig;var AdministrationBlockedUsers=function(){function e(e,s,t,i){this.backend=e,this.modal=s,this.toast=t,this.metadata=i,this.blockedUsers=[],this.isLoading=!1,this.isUnblocking={}}return e.prototype.ngOnInit=function(){this.loadBlockedUsers()},e.prototype.loadBlockedUsers=function(){var s=this;this.isLoading=!0;var e=this.metadata.getComponentConfig("LoginRestriction");e&&e.modulefilter&&e.modulefilter;this.backend.getList("Users",[{sortfield:"user_name",sortdirection:"ASC"}],{modulefilter:"7cf2fab0-b845-5a96-6045-2cef7c7f91d9",limit:-99,source:"db",fields:["id","user_name","login_blocked","login_blocked_until"]}).pipe(operators_1.take(1)).subscribe(function(e){s.blockedUsers=e.list,s.blockedUsers=s.blockedUsers.sort(function(e,s){return e.user_name.localeCompare(s.user_name)}),s.isLoading=!1})},e.prototype.unBlockUser=function(t,s){var i=this;this.isUnblocking[t]=!0,this.backend.postRequest("module/Users/"+t,null,{login_blocked:"0",login_blocked_until:""}).pipe(operators_1.take(1)).subscribe(function(e){i.isUnblocking[t]=!1,"0"===e.login_blocked&&""===e.login_blocked_until&&(i.toast.sendToast("User "+e.user_name+" successfully un-blocked.","success",null),i.blockedUsers.some(function(e,s){if(e.id===t)return i.blockedUsers.splice(s,1),!0}))},function(e){i.isUnblocking[t]=!1,i.toast.sendToast("Error un-blocking User "+s+".","error",e.error.error.message)})},__decorate([core_1.Component({selector:"administration-blocked-users",template:'<div class="slds-grid slds-grid--vertical slds-p-around--medium" [system-overlay-loading-spinner]="isLoading" style="height:100%"><div class="slds-grid slds-grid--align-spread" [ngClass]="{\'slds-border-bottom\':blockedUsers.length === 0}"><div class="slds-text-heading_small slds-m-bottom--x-small"><system-label label="LBL_BLOCKED_USERS"></system-label></div><button (click)="loadBlockedUsers()" system-title="LBL_RELOAD" class="slds-button slds-button--icon slds-m-left--xx-small"><system-button-icon icon="refresh"></system-button-icon></button></div><div class="slds-scrollable--y" [ngClass]="{\'slds-grow\':blockedUsers.length!==0}"><table class="slds-table slds-table_bordered slds-table--header-fixed" [ngStyle]="{borderBottom:blockedUsers.length===0?\'none\':\'auto\'}"><thead><tr class="slds-text-title--caps"><th><div class="slds-truncate slds-p-horizontal--x-small"><system-label label="LBL_USER_NAME"></system-label></div></th><th style="width:100%"><div class="slds-truncate slds-p-horizontal--x-small"><system-label label="LBL_PERMANENT" style="display:inline-block"></system-label>/<system-label label="LBL_UNTIL" style="display:inline-block"></system-label></div></th><th></th></tr></thead><tbody><tr *ngFor="let user of blockedUsers; let i=index"><td class="slds-p-right--x-small"><div class="slds-truncate">{{user.user_name}}</div></td><td class="slds-p-right--x-small"><div class="slds-truncate"><ng-container *ngIf="user.login_blocked">permanent</ng-container><ng-container *ngIf="!user.login_blocked && user.login_blocked_until"><system-display-datetime [date]="user.login_blocked_until"></system-display-datetime></ng-container></div></td><td><button *ngIf="!isUnblocking[user.id]" class="slds-button slds-button--icon" system-title="LBL_DELETE" (click)="unBlockUser(user.id,user.user_name)"><system-button-icon icon="delete"></system-button-icon></button><system-button-icon *ngIf="isUnblocking[user.id]" icon="spinner"></system-button-icon></td></tr></tbody></table></div><div *ngIf="!isLoading && blockedUsers.length === 0" class="slds-grow slds-align--absolute-center"><div class="slds-illustration slds-illustration_small"><div class="slds-text-longform"><h3 class="slds-text-heading_medium"><system-label label="MSG_NO_USERS_BLOCKED"></system-label></h3></div></div></div></div>'}),__metadata("design:paramtypes",[services_1.backend,services_1.modal,services_1.toast,services_1.metadata])],e)}();exports.AdministrationBlockedUsers=AdministrationBlockedUsers;var AdministrationLoginManagement=function(){function AdministrationLoginManagement(e){this.cdref=e}return AdministrationLoginManagement.prototype.ngOnInit=function(){this.cdref.detectChanges()},__decorate([core_1.ViewChild("whiteList"),__metadata("design:type",AdministrationLoginRestrictionIpAddresses)],AdministrationLoginManagement.prototype,"whiteListComponent",void 0),__decorate([core_1.ViewChild("blackList"),__metadata("design:type",AdministrationLoginRestrictionIpAddresses)],AdministrationLoginManagement.prototype,"blackListComponent",void 0),__decorate([core_1.Component({template:'<div class="slds-grid slds-grid_vertical-align-center slds-p-around--small slds-border--bottom"><system-icon icon="custom:custom62"></system-icon><h2 class="slds-text-heading_medium"><system-label label="LBL_LOGIN_MANAGEMENT"></system-label></h2></div><div class="slds-box slds-m-horizontal--medium slds-m-bottom--medium slds-m-top--medium" style="padding:0"><administration-login-restriction></administration-login-restriction></div><div system-to-bottom><div style="height:50%" class="slds-p-bottom--medium slds-p-horizontal--medium"><div class="slds-box slds-grid" style="height:100%;padding:0"><div class="slds-size--1-of-2" style="height:100%"><administration-login-restriction-ip-addresses #whiteList color="white" [siblingComponent]="blackListComponent" style="display:block;height:100%"></administration-login-restriction-ip-addresses></div><div class="slds-size--1-of-2 slds-border--left" style="height:100%"><administration-login-restriction-ip-addresses #blackList color="black" [siblingComponent]="whiteListComponent" style="display:block;height:100%"></administration-login-restriction-ip-addresses></div></div></div><div style="height:50%" class="slds-p-bottom--medium"><div class="slds-grid slds-m-horizontal--medium slds-grid--vertical-align-start" style="height:100%"><div class="slds-size--1-of-2"><administration-password-config class="slds-box slds-m-right--x-small" style="padding:0;display:block"></administration-password-config></div><div class="slds-size--1-of-2" style="height:100%"><administration-blocked-users class="slds-box slds-m-left--x-small" style="padding:0;display:block;height:100%"></administration-blocked-users></div></div></div></div>'}),__metadata("design:paramtypes",[core_1.ChangeDetectorRef])],AdministrationLoginManagement)}();exports.AdministrationLoginManagement=AdministrationLoginManagement;var AdministrationGDPRRetentionManager=function(){function AdministrationGDPRRetentionManager(e,s,t,i,l,a){this.toast=e,this.modal=s,this.modelutilities=t,this.backend=i,this.router=l,this.injector=a,this.policies=[],this.isloading=!1,this.initialized=!1,this.initializeResults()}return AdministrationGDPRRetentionManager.prototype.ngOnInit=function(){this.loadPolicies()},AdministrationGDPRRetentionManager.prototype.selectPolicyByIndex=function(e){this.isloading||this.selectedPolicyIndex==e||(this.selectedPolicyIndex=e,this.initializeResults())},Object.defineProperty(AdministrationGDPRRetentionManager.prototype,"selectedPolicy",{get:function(){return 0<=this.selectedPolicyIndex?this.policies[this.selectedPolicyIndex]:void 0},enumerable:!1,configurable:!0}),AdministrationGDPRRetentionManager.prototype.initializeResults=function(){this.results={list:[],module:"",total:0}},AdministrationGDPRRetentionManager.prototype.loadPolicies=function(){var s=this;this.backend.getRequest("admin/gdprmanager/retentionpolicies").subscribe(function(e){s.policies=e,s.initialized=!0})},AdministrationGDPRRetentionManager.prototype.toggleStatus=function(e){e.id&&(e.active=!e.active,this.backend.postRequest("admin/gdprmanager/retentionpolicies/"+e.id+"/activate/"+(e.active?1:0)))},AdministrationGDPRRetentionManager.prototype.save=function(){var e=this,s=this.modelutilities.generateGuid(),t=this.modal.await("LBL_SAVING");this.backend.postRequest("admin/gdprmanager/retentionpolicies/"+(this.selectedPolicy.id||s),{},this.selectedPolicy).subscribe(function(){e.selectedPolicy.id||(e.selectedPolicy.id=s),t.emit(!0)},function(){t.emit(!0)})},AdministrationGDPRRetentionManager.prototype.getResults=function(){var s=this;this.isloading=!0,this.results.list=[],this.backend.getRequest("admin/gdprmanager/retentionpolicies/"+this.selectedPolicy.id+"/results").subscribe(function(e){s.results=e,s.isloading=!1},function(){s.isloading=!1})},AdministrationGDPRRetentionManager.prototype.loadmore=function(){var s=this;!this.isloading&&this.results.total>this.results.list.length&&(this.isloading=!0,this.backend.getRequest("admin/gdprmanager/retentionpolicies/"+this.selectedPolicy.id+"/results",{start:this.results.list.length}).subscribe(function(e){s.results.list=s.results.list.concat(e.list),s.isloading=!1},function(){s.isloading=!1}))},AdministrationGDPRRetentionManager.prototype.openRecord=function(e,s){s.preventDefault(),s.stopPropagation(),this.router.navigate(["module/"+this.results.module+"/"+e])},AdministrationGDPRRetentionManager.prototype.deleteByIndex=function(t){var i=this;this.modal.confirm("LBL_DELETE_RECORD","LBL_DELETE_RECORD").subscribe(function(e){var s;e&&(i.selectedPolicy.id?(s=i.modal.await("LBL_DELETING"),i.backend.deleteRequest("admin/gdprmanager/retentionpolicies/"+i.selectedPolicy.id).subscribe(function(e){i.deletePolicy(t),s.emit(!0)},function(){s.emit(!0)})):i.deletePolicy(t))})},AdministrationGDPRRetentionManager.prototype.deletePolicy=function(e){this.selectedPolicyIndex==e&&(this.selectedPolicyIndex=void 0),this.policies.splice(e,1)},AdministrationGDPRRetentionManager.prototype.addPolicy=function(){var s=this;this.modal.input("LBL_POLICY_NAME","LBL_POLICY_NAME").subscribe(function(e){e&&(s.policies.push({id:"",name:e,deleted:!1,retention_type:"I",active:!1,description:""}),s.selectedPolicyIndex=s.policies.length-1)})},__decorate([core_1.Component({selector:"[administration-gdpr-retention-manager]",template:'<div class="slds-grid slds-grid_vertical-align-center slds-p-around--small slds-border--bottom"><system-icon icon="apex_plugin"></system-icon><h2 class="slds-text-heading_medium"><system-label label="LBL_GDPR_RETENTION_MANAGER"></system-label></h2></div><div class="slds-theme--default slds-grid" [system-overlay-loading-spinner]="!initialized"><div class="slds-size--1-of-3 slds-border--right" system-to-bottom><div *ngFor="let policy of policies; let i = index" class="slds-grid slds-grid--align-spread slds-grid_vertical-align-center slds-p-around--small slds-border--bottom" [ngClass]="{\'slds-theme--shade\': i == selectedPolicyIndex}" (click)="selectPolicyByIndex(i)"><div [ngSwitch]="policy.active" (dblclick)="toggleStatus(policy)"><system-utility-icon *ngSwitchCase="1" icon="success" colorclass="slds-icon-text-success" size="x-small"></system-utility-icon><system-utility-icon *ngSwitchCase="0" icon="clear" [colorclass]="policy.id ? \'slds-icon-text-warning\' : \'\'" size="x-small"></system-utility-icon></div><div class="slds-grow slds-p-left--x-small slds-truncate slds-text-link--reset">{{policy.name}}</div><button class="slds-button slds-button--icon" [disabled]="isloading" (click)="deleteByIndex(i)"><system-button-icon icon="delete"></system-button-icon></button></div><div class="slds-p-around--x-small slds-text-align--center"><button class="slds-button slds-button--icon" *ngIf="initialized" [disabled]="isloading" (click)="addPolicy()"><system-button-icon icon="new"></system-button-icon></button></div></div><div class="slds-size--2-of-3"><ng-container *ngIf="selectedPolicyIndex >= 0; else selectpolicy"><div class="slds-grid_vertical slds-p-around--x-small"><div class="slds-grid slds-grid_vertical-align-center slds-p-right--xx-small"><div class="slds-size--3-of-4 slds-form-element"><label class="slds-form-element__label"><system-label label="LBL_NAME"></system-label></label><div class="slds-form-element__control"><system-input-text [(ngModel)]="selectedPolicy.name"></system-input-text></div></div><div class="slds-size--1-of-4 slds-form-element slds-p-left--xx-small"><label class="slds-form-element__label"><system-label label="LBL_TYPE"></system-label></label><div class="slds-form-element__control"><div class="slds-select_container"><select class="slds-select" [(ngModel)]="selectedPolicy.retention_type"><option value="I"><system-label label="LBL_SET_INACTIVE"></system-label></option><option value="D"><system-label label="LBL_MARK_DELETED"></system-label></option><option value="P"><system-label label="LBL_PURGE"></system-label></option></select></div></div></div></div><div class="slds-form-element"><label class="slds-form-element__label"><system-label label="LBL_MODULE_FILTER"></system-label></label><div class="slds-form-element__control"><system-input-module-filter [(ngModel)]="selectedPolicy.sysmodulefilter_id"></system-input-module-filter></div></div><div class="slds-form-element"><label class="slds-form-element__label"><system-label label="LBL_DELETE_RELATED"></system-label></label><div class="slds-form-element__control"><system-input-text [(ngModel)]="selectedPolicy.delete_related"></system-input-text></div></div><div class="slds-form-element"><label class="slds-form-element__label"><system-label label="LBL_DESCRIPTION"></system-label></label><div class="slds-form-element__control"><textarea [(ngModel)]="selectedPolicy.description" class="slds-textarea"></textarea></div></div><div class="slds-grid slds-p-vertical--x-small slds-grid_vertical-align-center"><div><system-label label="LBL_TOTAL"></system-label> {{results.total}}</div><button [disabled]="!selectedPolicy.id" class="slds-col--bump-left slds-button slds-button_neutral" (click)="getResults()"><system-label label="LBL_TEST"></system-label></button> <button [disabled]="isloading" class="slds-button slds-button_brand" (click)="save()"><system-label label="LBL_SAVE"></system-label></button></div></div><div *ngIf="selectedPolicy.id" (system-to-bottom)="loadmore()"><table class="slds-table slds-table--fixed-layout slds-max-medium-table--stacked-horizontal slds-table--header-fixed" role="grid"><thead><tr class="slds-text-title--caps"><th><system-label class="slds-th__action" label="LBL_ID"></system-label></th><th><system-label class="slds-th__action" label="LBL_SUMMARY"></system-label></th></tr></thead><tbody *ngIf="results"><tr *ngFor="let listItem of results.list" class="slds-hint-parent"><td><a href="#" (click)="openRecord(listItem.id, $event)" class="slds-text-link_reset">{{listItem.id}}</a></td><td>{{listItem.name}}</td></tr></tbody><tbody system-table-stencils columns="2" [rows]="20" *ngIf="isloading"></tbody></table><div *ngIf="!isloading && results.total == 0" class="slds-height_full slds-align--absolute-center"><system-illustration-no-records><system-label label="LBL_NO_RECORDS"></system-label></system-illustration-no-records></div></div></ng-container><ng-template #selectpolicy><div system-to-bottom-noscroll class="slds-align--absolute-center"><system-label label="LBL_SELECT_POLICY"></system-label></div></ng-template></div></div>'}),__metadata("design:paramtypes",[services_1.toast,services_1.modal,services_1.modelutilities,services_1.backend,router_1.Router,core_1.Injector])],AdministrationGDPRRetentionManager)}();exports.AdministrationGDPRRetentionManager=AdministrationGDPRRetentionManager;var AdminComponentsModule=function(){function AdminComponentsModule(){}return __decorate([core_1.NgModule({imports:[common_1.CommonModule,forms_1.FormsModule,systemcomponents_1.SystemComponents,directives_1.DirectivesModule,drag_drop_1.DragDropModule,objectcomponents_1.ObjectComponents,objectfields_1.ObjectFields],declarations:[AdministrationAPIInspector,AdministrationApiInspectorMethods,AdministrationApiInspectorMethodParameters,AdministrationAPIInspectorDetails,AdministrationapiinspectorMethodResponses,AdministrationApiInspectorMethodTest,AdministrationGDPRRetentionManager,AdministrationMain,AdministrationMenu,AdministrationMenuRouteItem,AdministrationConfigurator,AdministrationConfiguratorItem,AdministrationConfiguratorItemRole,AdministrationQuotaManager,AdministrationQuotaManagerField,AdministrationFTSStatus,AdministrationFTSManager,AdministrationFTSManagerModuleAdd,AdministrationFTSManagerFields,AdministrationFTSManagerFieldsList,AdministrationFTSManagerDetails,AdministrationFTSManagerFieldsAdd,AdministrationFTSStats,AdministrationDictionaryManager,AdministrationDictionaryManagerItem,AdministrationDictionaryManagerItemField,AdministrationSysTrashcanManager,AdministrationSysTrashcanRecover,AdministrationDictRepair,AdministrationDictRepairItem,AdministrationDictRepairLanguage,AdministrationDictRepairModal,AdministrationDictRepairACLRoles,AdministrationDictRepairCache,AdministrationDictRepairDbColumns,AdministrationDictRepairDbColumnsModal,AdministrationConfigEditor,AdministrationJobMethods,AdministrationJobLog,AdministrationJobRunButton,AdministrationJobScheduleButton,AdministrationJobKillButton,AdministrationJobTaskRunButton,AdministrationJobRunningList,AdministrationJobFailedList,AdministrationJobCockpit,AdministrationSystemStats,AdministrationSystemVersions,AdministrationFtsManagerIndexModal,AdministrationHomeScreen,AdministrationHomeScreenCard,AdministrationHomeScreenCardItem,AdministrationGeneralSettings,AdministrationLanguages,AdministrationDefaultPreferences,AdministrationUserAccessLogViewer,AdministrationDictRepairConvertDBCharset,AdministrationDictRepairConvertDBCharsetModal,AdministrationLoginRestriction,AdministrationLoginRestrictionIpAddresses,AdministrationLoginRestrictionIpAddressesRow,AdministrationPasswordConfig,AdministrationBlockedUsers,AdministrationLoginManagement],entryComponents:[AdministrationMain,AdministrationMenu,AdministrationConfigurator,AdministrationQuotaManager,AdministrationQuotaManagerField,AdministrationFTSManager,AdministrationDictionaryManager,AdministrationDictionaryManagerItem,AdministrationDictionaryManagerItemField,AdministrationDefaultPreferences,AdministrationJobRunningList,AdministrationJobFailedList,AdministrationLoginRestriction,AdministrationLoginRestrictionIpAddresses,AdministrationLoginRestrictionIpAddressesRow,AdministrationPasswordConfig,AdministrationBlockedUsers,AdministrationLoginManagement],exports:[]})],AdminComponentsModule)}();exports.AdminComponentsModule=AdminComponentsModule;