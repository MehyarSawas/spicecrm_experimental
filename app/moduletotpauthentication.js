/*!
 * 
 *                     aacService
 *
 *                     release: 2022.01.001
 *
 *                     date: 2022-04-13 22:38:49
 *
 *                     build: 2022.01.001.1649882329485
 *
 */
"use strict";(self.webpackChunkcore=self.webpackChunkcore||[]).push([["src_include_totpauthentication_moduletotpauthentication_ts"],{8127:(t,e,n)=>{n.r(e),n.d(e,{ModuleTOTPAuthentication:()=>y});var s=n(9808),i=n(2382),a=n(9769),o=n(1549),l=n(1706),c=n(4518),d=n(6472),r=n(4893),u=n(5329),T=n(5710),h=n(4044),g=n(4505),m=n(3463);let b=(()=>{class TOTPAuthenticationGenerateButton{constructor(t,e,n,s,i){this.language=t,this.model=e,this.modal=n,this.backend=s,this.injector=i}execute(){let t=this.modal.await(this.language.getLabel("MSG_TOTP_STATUSCHECK"));this.backend.getRequest("authentication/totp").subscribe((e=>{t.emit(!0),e.active?this.modal.confirm(this.language.getLabel("MSG_TOTP_DELETE",null,"long"),this.language.getLabel("MSG_TOTP_DELETE")).subscribe((e=>{e&&(t=this.modal.await(this.language.getLabel("MSG_TOTP_DELETING")),this.backend.deleteRequest("authentication/totp").subscribe((e=>{t.emit(!0),this.generateTOTP()}),(()=>{t.emit(!0)})))})):this.generateTOTP()}),(()=>{t.emit(!0)}))}generateTOTP(){this.modal.openModal("TOTPAuthenticationGenerateModal",!0,this.injector)}}return TOTPAuthenticationGenerateButton.ɵfac=function(t){return new(t||TOTPAuthenticationGenerateButton)(r.Y36(u.d),r.Y36(T.o),r.Y36(h.o),r.Y36(g.y),r.Y36(r.zs3))},TOTPAuthenticationGenerateButton.ɵcmp=r.Xpm({type:TOTPAuthenticationGenerateButton,selectors:[["totp-authenticatio-generate-button"]],decls:1,vars:0,consts:[["label","LBL_TOTP_AUTHENTICATOR"]],template:function(t,e){1&t&&r._UZ(0,"system-label",0)},directives:[m._],encapsulation:2}),TOTPAuthenticationGenerateButton})();var p=n(4154),O=n(3278),A=n(9621),_=n(1916),M=n(3499),P=n(5767);function f(t,e){if(1&t&&r._UZ(0,"img",18),2&t){const t=r.oxw(2);r.Q6J("src",t.QRCode,r.LSH)}}function C(t,e){if(1&t){const t=r.EpF();r.TgZ(0,"system-modal",1)(1,"system-modal-header",2),r.NdJ("close",(function(){r.CHM(t);return r.oxw().close()})),r._UZ(2,"system-label",3),r.qZA(),r.TgZ(3,"system-modal-content")(4,"div",4)(5,"div",5),r._UZ(6,"system-label",6),r.qZA(),r.TgZ(7,"div",7)(8,"div",8),r._uU(9),r.qZA(),r.YNc(10,f,1,1,"img",9),r.TgZ(11,"div",8),r._uU(12),r.qZA()()()(),r.TgZ(13,"system-modal-footer")(14,"div",10)(15,"div",11),r._UZ(16,"system-label",12),r.TgZ(17,"input",13),r.NdJ("ngModelChange",(function(e){r.CHM(t);return r.oxw().code=e})),r.qZA()(),r.TgZ(18,"div",4)(19,"button",14),r.NdJ("click",(function(){r.CHM(t);return r.oxw().close()})),r._UZ(20,"system-label",15),r.qZA(),r.TgZ(21,"button",16),r.NdJ("click",(function(){r.CHM(t);return r.oxw().save()})),r._UZ(22,"system-label",17),r.qZA()()()()()}if(2&t){const t=r.oxw();r.xp6(9),r.Oqu(t.name),r.xp6(1),r.Q6J("ngIf",t.QRCode),r.xp6(2),r.Oqu(t.secret),r.xp6(5),r.Q6J("ngModel",t.code),r.xp6(4),r.Q6J("disabled",6!=t.code.length)}}let v=(()=>{class TOTPAuthenticationGenerateModal{constructor(t,e,n,s,i,a){this.language=t,this.metadata=e,this.modal=n,this.model=s,this.backend=i,this.toast=a,this.code=""}ngOnInit(){let t=this.modal.await(this.language.getLabel("MSG_TOTP_GENERATING_CODE"));this.backend.getRequest("authentication/totp/generate").subscribe((e=>{t.emit(!0),e.secret?(this.QRCode="data:image/png;base64,"+e.qrcode,this.secret=e.secret,this.name=e.name):(this.toast.sendToast("Error generating Code","error"),this.close())}),(()=>{this.toast.sendToast("Error generating Code","error"),this.close(),t.emit(!0)}))}close(){this.self.destroy()}save(){this.backend.putRequest(`authentication/totp/validate/${this.code}`).subscribe((t=>{t.validated?this.close():this.toast.sendToast("Error validating your code","warning","the code you entered is not valid, please try again",!0),this.code=""}),(()=>{this.toast.sendToast("Error validating your code","error","there as an internal error validating your request",!0),this.code=""}))}}return TOTPAuthenticationGenerateModal.ɵfac=function(t){return new(t||TOTPAuthenticationGenerateModal)(r.Y36(u.d),r.Y36(p.Pu),r.Y36(h.o),r.Y36(T.o),r.Y36(g.y),r.Y36(O.A))},TOTPAuthenticationGenerateModal.ɵcmp=r.Xpm({type:TOTPAuthenticationGenerateModal,selectors:[["totp-authentication-generate-modal"]],decls:1,vars:1,consts:[["size","small",4,"ngIf"],["size","small"],[3,"close"],["label","LBL_TOTP_AUTHENTICATOR"],[1,"slds-grid"],[1,"slds-size--1-of-2"],["label","MSG_AUTHENTICATOR_INSTRUCTIONS","length","long"],[1,"slds-size--1-of-2","slds-align--absolute-center","slds-grid","slds-grid--vertical"],[1,"slds-p-vertical--small"],["style","width: 200px; height: 200px;",3,"src",4,"ngIf"],[1,"slds-grid","slds-grid--vertical-align-center","slds-grid--align-spread"],[1,"slds-grid","slds-grid--vertical-align-center"],["label","LBL_CODE"],["maxlength","6",1,"slds-m-left--x-small","slds-input",2,"width","6rem",3,"ngModel","ngModelChange"],[1,"slds-button","slds-button--neutral",3,"click"],["label","LBL_CANCEL"],[1,"slds-button","slds-button--brand",3,"disabled","click"],["label","LBL_SAVE"],[2,"width","200px","height","200px",3,"src"]],template:function(t,e){1&t&&r.YNc(0,C,23,5,"system-modal",0),2&t&&r.Q6J("ngIf",e.secret)},directives:[s.O5,A.j,_.y,m._,M.x,P.p,i.Fj,i.nD,i.JJ,i.On],encapsulation:2}),TOTPAuthenticationGenerateModal})(),y=(()=>{class ModuleTOTPAuthentication{}return ModuleTOTPAuthentication.ɵfac=function(t){return new(t||ModuleTOTPAuthentication)},ModuleTOTPAuthentication.ɵmod=r.oAB({type:ModuleTOTPAuthentication}),ModuleTOTPAuthentication.ɵinj=r.cJS({imports:[[s.ez,i.u5,o.ObjectFields,l.GlobalComponents,c.ObjectComponents,d.SystemComponents,a.o]]}),ModuleTOTPAuthentication})();("undefined"==typeof ngJitMode||ngJitMode)&&r.kYT(y,{declarations:[b,v],imports:[s.ez,i.u5,o.ObjectFields,l.GlobalComponents,c.ObjectComponents,d.SystemComponents,a.o]})}}]);