/*!
 * 
 *                     aacService
 *
 *                     release: 2022.01.001
 *
 *                     date: 2022-04-13 22:38:49
 *
 *                     build: 2022.01.001.1649882329485
 *
 */
"use strict";(self.webpackChunkcore=self.webpackChunkcore||[]).push([["src_modules_spiceimports_modulespiceimports_ts"],{9678:(t,e,s)=>{s.r(e),s.d(e,{ModuleSpiceImports:()=>Y});var i=s(9808),o=s(2382),l=s(1549),c=s(1706),r=s(4518),n=s(6472),a=s(4893),d=s(4505);let p=(()=>{class spiceimportsservice{constructor(t){this.backend=t,this.isloading=!1,this.isloadingLogs=!1,this.canLoadMore=!0,this.activeimportdata=void 0,this.loadLimit=25,this.activeimportdata$=new a.vpe,this.items=[],this.activeItemLogs=void 0}get activeImportData(){return this.activeimportdata}set activeImportData(t){this.activeimportdata=t,this.activeimportdata$.emit(t)}getItemLogs(){this.activeItemLogs=void 0,this.isloadingLogs=!0,this.backend.getRequest(`module/SpiceImports/${this.activeImportData.id}/logs`).subscribe((t=>{t.map((t=>t.data=t.data.split('";"'))),this.activeItemLogs=t,this.isloadingLogs=!1}))}loadData(){this.isloading=!0,this.backend.getRequest("module/SpiceImports",{orderby:"date_entered DESC",limit:this.loadLimit,offset:0,fields:"*"}).subscribe((t=>{this.parseItemsStatus(t.list),this.items=t.list,this.isloading=!1}))}loadMoreData(){if(this.isloading||!this.canLoadMore)return!1;this.isloading=!0,this.backend.getRequest("module/SpiceImports",{orderby:"date_entered DESC",limit:this.loadLimit,offset:this.items.length,fields:"*"}).subscribe((t=>{this.parseItemsStatus(t.list),this.items=this.items.concat(t.list),t.list.length<this.loadLimit&&(this.canLoadMore=!1),this.isloading=!1}))}deleteImport(){this.items.every((t=>{let e=this.items.indexOf(t);return t.id==this.activeImportData.id&&this.items.splice(e,1),!0}))}parseItemsStatus(t){t.map((t=>{let e=JSON.parse(t.data);switch(t.status){case"c":"new"==e.importAction?t.status="LBL_IMPORTED":t.status="LBL_UPDATED";break;case"e":"new"==e.importAction?t.status="LBL_IMPORTED":t.status="LBL_UPDATE_FAILED";break;default:t.status="LBL_SCHEDULED"}return t}))}}return spiceimportsservice.ɵfac=function(t){return new(t||spiceimportsservice)(a.LFG(d.y))},spiceimportsservice.ɵprov=a.Yz7({token:spiceimportsservice,factory:spiceimportsservice.ɵfac}),spiceimportsservice})();var m=s(5329),g=s(3463),u=s(4561);const v=function(t){return{"slds-theme_shade":t}};let h=(()=>{class SpiceImportsListItem{constructor(t,e){this.language=t,this.spiceimportsservice=e,this.item=void 0}}return SpiceImportsListItem.ɵfac=function(t){return new(t||SpiceImportsListItem)(a.Y36(m.d),a.Y36(p))},SpiceImportsListItem.ɵcmp=a.Xpm({type:SpiceImportsListItem,selectors:[["spice-imports-list-item"]],inputs:{item:"item"},decls:15,vars:13,consts:[[1,"slds-p-around--medium","slds-border--bottom","slds-border--right","slds-grid",2,"cursor","pointer",3,"ngClass","click"],[1,"slds-icon_container","slds-col","slds-size--1-of-12",3,"title"],["size","medium",3,"module"],[1,"slds-col","slds-size--11-of-12"],[1,"slds-grid","slds-grid--align-spread"],[1,"slds-text-title_caps"],[1,"slds-col--bump-left","slds-truncate"],[1,"slds-truncate"]],template:function(t,e){1&t&&(a.TgZ(0,"div",0),a.NdJ("click",(function(){return e.spiceimportsservice.activeImportData={id:e.item.id,name:e.item.name}})),a.TgZ(1,"div",1),a._UZ(2,"system-icon",2),a.qZA(),a.TgZ(3,"div",3)(4,"div",4)(5,"div",5),a._uU(6),a.qZA(),a.TgZ(7,"div",6),a._uU(8),a.ALo(9,"slice"),a.qZA()(),a.TgZ(10,"div",4)(11,"div",7),a._uU(12),a.qZA(),a.TgZ(13,"div",6),a._uU(14),a.qZA()()()()),2&t&&(a.Q6J("ngClass",a.VKq(11,v,(null==e.spiceimportsservice.activeImportData?null:e.spiceimportsservice.activeImportData.id)==e.item.id)),a.xp6(1),a.s9C("title",e.item.model),a.xp6(1),a.Q6J("module",e.item.module),a.xp6(4),a.Oqu(e.item.name),a.xp6(2),a.Oqu(a.Dn7(9,7,e.item.date_entered,0,16)),a.xp6(4),a.Oqu(e.language.getLabel(e.item.status)),a.xp6(2),a.Oqu(e.item.created_by_name))},directives:[i.mk,u.f],pipes:[i.OU],encapsulation:2}),SpiceImportsListItem})();var f=s(4664);const b=["listcontainer"];function I(t,e){1&t&&(a.TgZ(0,"div",5)(1,"span"),a._UZ(2,"system-label",6),a.qZA()())}function L(t,e){if(1&t&&a._UZ(0,"spice-imports-list-item",7),2&t){const t=e.$implicit;a.Q6J("item",t)}}function _(t,e){1&t&&a._UZ(0,"system-spinner")}let S=(()=>{class SpiceImportsList{constructor(t,e){this.language=t,this.spiceimportsservice=e}listStyle(){return{height:"calc(100vh - "+this.listcontainer.element.nativeElement.getBoundingClientRect().top+"px)"}}get items(){return this.spiceimportsservice.items}onScroll(t){let e=this.listcontainer.element.nativeElement;e.scrollTop+e.clientHeight+50>e.scrollHeight&&this.spiceimportsservice.loadMoreData()}}return SpiceImportsList.ɵfac=function(t){return new(t||SpiceImportsList)(a.Y36(m.d),a.Y36(p))},SpiceImportsList.ɵcmp=a.Xpm({type:SpiceImportsList,selectors:[["spice-imports-list"]],viewQuery:function(t,e){if(1&t&&a.Gf(b,7,a.s_b),2&t){let t;a.iGM(t=a.CRH())&&(e.listcontainer=t.first)}},decls:5,vars:4,consts:[[1,"slds-scrollable--y",3,"ngStyle","scroll"],["listcontainer",""],["class","slds-text-align_center slds-p-vertical--medium",4,"ngIf"],[3,"item",4,"ngFor","ngForOf"],[4,"ngIf"],[1,"slds-text-align_center","slds-p-vertical--medium"],["label","LBL_NO_ENTRIES"],[3,"item"]],template:function(t,e){1&t&&(a.TgZ(0,"div",0,1),a.NdJ("scroll",(function(t){return e.onScroll(t)})),a.YNc(2,I,3,0,"div",2),a.YNc(3,L,1,1,"spice-imports-list-item",3),a.YNc(4,_,1,0,"system-spinner",4),a.qZA()),2&t&&(a.Q6J("ngStyle",e.listStyle()),a.xp6(2),a.Q6J("ngIf",!e.spiceimportsservice.isloading&&0==(null==e.items?null:e.items.length)),a.xp6(1),a.Q6J("ngForOf",e.items),a.xp6(1),a.Q6J("ngIf",e.spiceimportsservice.isloading))},directives:[i.PC,i.O5,g._,i.sg,h,f.W],encapsulation:2}),SpiceImportsList})();var Z=s(4044),x=s(3278),T=s(2656);const y=["logscontainer"];function E(t,e){if(1&t){const t=a.EpF();a.TgZ(0,"button",9),a.NdJ("click",(function(){a.CHM(t);return a.oxw().delete()})),a._UZ(1,"system-label",10),a.qZA()}}function D(t,e){1&t&&(a.TgZ(0,"div",11),a._UZ(1,"system-label",12),a.qZA())}function q(t,e){1&t&&(a.TgZ(0,"div",11),a._UZ(1,"system-label",13),a.qZA())}function O(t,e){1&t&&a._UZ(0,"system-spinner")}function A(t,e){if(1&t&&(a.TgZ(0,"div",19)(1,"button",20),a._UZ(2,"system-button-icon",21),a.qZA()()),2&t){const t=a.oxw().$implicit,e=a.oxw();a.xp6(2),a.Q6J("icon",e.getButtonicon(t.id))}}function N(t,e){if(1&t&&(a.TgZ(0,"tr")(1,"td",23),a._uU(2),a.qZA(),a.TgZ(3,"td",23),a._uU(4),a.qZA()()),2&t){const t=e.$implicit,s=e.index,i=a.oxw(3);a.xp6(2),a.Oqu(i.itemHeader[s]),a.xp6(2),a.Oqu(t)}}function C(t,e){if(1&t&&(a.TgZ(0,"table",22)(1,"tbody"),a.YNc(2,N,5,2,"tr",8),a.qZA()()),2&t){const t=a.oxw().$implicit;a.xp6(2),a.Q6J("ngForOf",t.data)}}function J(t,e){if(1&t){const t=a.EpF();a.TgZ(0,"div")(1,"div",14),a.NdJ("click",(function(){const e=a.CHM(t).$implicit;return a.oxw().toggleOpen(e.id)})),a.TgZ(2,"div",15),a._uU(3),a.qZA(),a.TgZ(4,"div",16),a._uU(5),a.qZA(),a.YNc(6,A,3,1,"div",17),a.qZA(),a.YNc(7,C,3,1,"table",18),a.qZA()}if(2&t){const t=e.$implicit,s=a.oxw();a.xp6(3),a.hij(" ",t.msg," "),a.xp6(1),a.Q6J("hidden",s.opened&&t.id==s.activeLogId&&s.itemHeader),a.xp6(1),a.hij(" ",t.data.join(" , ")," "),a.xp6(1),a.Q6J("ngIf",s.itemHeader),a.xp6(1),a.Q6J("ngIf",s.opened&&t.id==s.activeLogId&&s.itemHeader)}}let U=(()=>{class Spiceimportslogs{constructor(t,e,s,i,o){this.language=t,this.modal=e,this.backend=s,this.toast=i,this.spiceimportsservice=o,this.itemHeader=void 0,this.activeLogId=void 0,this.activelogname=void 0,this.opened=!1,this.spiceimportsservice.activeimportdata$.subscribe((t=>{t&&(this.activeLogName=t.name,this.spiceimportsservice.getItemLogs(),this.setItemHeader(t.id)),this.opened=!1}))}get itemLogs(){return this.spiceimportsservice.activeItemLogs}get activeLogName(){return this.activelogname}set activeLogName(t){this.activelogname=t}getButtonicon(t){return this.opened&&this.activeLogId==t?"chevronup":"chevrondown"}setItemHeader(t){this.spiceimportsservice.items.some((e=>{let s=JSON.parse(e.data);return e.id==t&&(this.itemHeader=s.fileHeader),!0}))}mainStyle(){return{height:"calc(100vh - "+this.logscontainer.element.nativeElement.getBoundingClientRect().top+"px)",overflow:"auto"}}toggleOpen(t){this.opened&&t!=this.activeLogId||(this.opened=!this.opened),this.activeLogId=t}delete(){this.modal.confirm(this.language.getLabel("MSG_DELETE_RECORD","","long"),this.language.getLabel("MSG_DELETE_RECORD")).subscribe((t=>{t&&this.backend.deleteRequest(`module/SpiceImports/${this.spiceimportsservice.activeImportData.id}`).subscribe((t=>{t?(this.toast.sendToast(this.language.getLabel("MSG_SUCCESSFULLY_DELETED"),"success"),this.spiceimportsservice.deleteImport(),this.resetData()):this.toast.sendToast(this.language.getLabel("ERR_CANT_DELETE"),"error")}))}))}resetData(){this.spiceimportsservice.activeImportData=void 0,this.spiceimportsservice.activeItemLogs=void 0,this.activeLogName=void 0}}return Spiceimportslogs.ɵfac=function(t){return new(t||Spiceimportslogs)(a.Y36(m.d),a.Y36(Z.o),a.Y36(d.y),a.Y36(x.A),a.Y36(p))},Spiceimportslogs.ɵcmp=a.Xpm({type:Spiceimportslogs,selectors:[["spice-imports-logs"]],viewQuery:function(t,e){if(1&t&&a.Gf(y,7,a.s_b),2&t){let t;a.iGM(t=a.CRH())&&(e.logscontainer=t.first)}},decls:11,vars:7,consts:[[1,"slds-grid","slds-page-header","slds-p-horizontal--none","slds-p-vertical--xx-small","slds-grid--vertical-align-center",2,"border-radius","0","border-left","0","height","50px"],[1,"slds-text-title_caps","slds-p-left--small"],[1,"slds-p-around_xx-small","slds-col--bump-left"],["class","slds-button slds-button--brand",3,"click",4,"ngIf"],[1,"slds-scrollable--y",3,"ngStyle"],["logscontainer",""],["class","slds-align_absolute-center slds-m-around--xx-large slds-text-heading--medium",4,"ngIf"],[4,"ngIf"],[4,"ngFor","ngForOf"],[1,"slds-button","slds-button--brand",3,"click"],["label","LBL_DELETE"],[1,"slds-align_absolute-center","slds-m-around--xx-large","slds-text-heading--medium"],["label","MSG_NO_LOGS_FOUND"],["label","LBL_MAKE_SELECTION"],[1,"slds-p-left--small","slds-border--bottom","slds-border--right","slds-grid",2,"cursor","pointer",3,"click"],[1,"slds-p-vertical--small","slds-col","slds-size--2-of-12","slds-border--right"],[1,"slds-p-around--small","slds-col","slds-size--9-of-12","slds-truncate",3,"hidden"],["class","slds-p-around--small slds-size--1-of-12 slds-col_bump-left",4,"ngIf"],["class","slds-table slds-table--bordered slds-table--cell-buffer",4,"ngIf"],[1,"slds-p-around--small","slds-size--1-of-12","slds-col_bump-left"],[1,"slds-button","slds-button_icon"],[3,"icon"],[1,"slds-table","slds-table--bordered","slds-table--cell-buffer"],[1,"slds-truncate"]],template:function(t,e){1&t&&(a.TgZ(0,"div",0)(1,"div",1),a._uU(2),a.qZA(),a.TgZ(3,"div",2),a.YNc(4,E,2,0,"button",3),a.qZA()(),a.TgZ(5,"div",4,5),a.YNc(7,D,2,0,"div",6),a.YNc(8,q,2,0,"div",6),a.YNc(9,O,1,0,"system-spinner",7),a.YNc(10,J,8,5,"div",8),a.qZA()),2&t&&(a.xp6(2),a.Oqu(e.activeLogName),a.xp6(2),a.Q6J("ngIf",e.activeLogName),a.xp6(1),a.Q6J("ngStyle",e.mainStyle()),a.xp6(2),a.Q6J("ngIf",!e.spiceimportsservice.isloadingLogs&&e.spiceimportsservice.activeImportData&&(null==e.itemLogs?null:e.itemLogs.length)<=0),a.xp6(1),a.Q6J("ngIf",!e.spiceimportsservice.isloadingLogs&&!e.spiceimportsservice.activeImportData),a.xp6(1),a.Q6J("ngIf",e.spiceimportsservice.isloadingLogs),a.xp6(1),a.Q6J("ngForOf",e.itemLogs))},directives:[i.O5,g._,i.PC,f.W,i.sg,T.J],encapsulation:2}),Spiceimportslogs})(),M=(()=>{class SpiceImports{constructor(t,e){this.language=t,this.spiceimportsservice=e}ngOnInit(){this.spiceimportsservice.loadData()}}return SpiceImports.ɵfac=function(t){return new(t||SpiceImports)(a.Y36(m.d),a.Y36(p))},SpiceImports.ɵcmp=a.Xpm({type:SpiceImports,selectors:[["ng-component"]],features:[a._Bn([p])],decls:5,vars:0,consts:[[1,"slds-grid"],[1,"slds-size--1-of-2"],[1,"slds-scrollable"],[1,"slds-size--1-of-2","slds-theme--shade"]],template:function(t,e){1&t&&(a.TgZ(0,"div",0)(1,"spice-imports-list",1),a._UZ(2,"div",2),a.qZA(),a.TgZ(3,"spice-imports-logs",3),a._UZ(4,"div",2),a.qZA()())},directives:[S,U],encapsulation:2}),SpiceImports})(),Y=(()=>{class ModuleSpiceImports{}return ModuleSpiceImports.ɵfac=function(t){return new(t||ModuleSpiceImports)},ModuleSpiceImports.ɵmod=a.oAB({type:ModuleSpiceImports}),ModuleSpiceImports.ɵinj=a.cJS({providers:[p],imports:[[i.ez,o.u5,l.ObjectFields,c.GlobalComponents,r.ObjectComponents,n.SystemComponents]]}),ModuleSpiceImports})();("undefined"==typeof ngJitMode||ngJitMode)&&a.kYT(Y,{declarations:[M,S,h,U],imports:[i.ez,o.u5,l.ObjectFields,c.GlobalComponents,r.ObjectComponents,n.SystemComponents]})}}]);